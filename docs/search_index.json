[["index.html", "Structurally Guided Sampling Overview", " Structurally Guided Sampling Tristan Goodbody 2021-07-26 Overview This document is description of the structurally guided sampling project being undertaken by the IRSS Lab at the UBC Faculty fo Forestry. Herein we provide details related to: Literature review about SGS Describe package fundamentals Overview of stratification algorithms Overview of sampling algorithms Overview of calculate algorithms "],["SGS.html", "Structurally Guided Sampling Review Stratification approaches", " Structurally Guided Sampling Review (McRoberts, Gobakken, and Næsset 2012) outline the essence of structurally guided sampling: Stratified estimation is a statistical technique that can be used to increase the precision of estimates without increasing sample sizes. The essence of stratified estimation is to aggregate observations of the response variable into groups or strata that are more homogeneous than the population as a whole. The population mean and its variance are estimated as weighted means ofwithin-strata means and variances where the weights are based on strata sizes. If the stratification is accomplished prior to sampling and the within-stratum variances are known or can be easily estimated, then greater precision may be achieved by selecting within-strata sampling intensities to be proportional to within-strata variances (Cochran, 1977). Following literature review I present a number of implementations that have been used to guide the stratification of ALS-derived structural variables for locating representative sample plots. Studies including (Leiterer et al. 2015) and (Kane et al. 2010) suggest that the information in the ALS data may be condensed to a few metrics. Many of the studies reviewed seem to adopt this by selecting a low number of metrics which they use to stratify the landscape and consequently sample within.(Fedrigo et al. 2018) further outlined: Lidar metrics may be useful for forest stand classification if they differentiate classes of interest (Wulder et al., 2008). The separation of the data into vertical layers allows metrics to be derived for specific forest strata, which may increase the discrimination of multi-strata stand types. The selection of breaks that define these strata can be based on field knowledge or identified statistically from lidar profiles (Lefsky et al., 1999; Zhang et al., 2011). An additional note of interest is that a great deal of research in the field of digital soil mapping can be applied to structurally guided sampling. Studies including (Carré, McBratney, and Minasny 2007), (Ma et al. 2020), and (Malone, Minansy, and Brungard 2019) were invlauable for understanding how to use auxillary variables to determine effective sampling protocols - especially in the context of Lahin Hypercube Sampling. Stratification approaches (Hawbaker et al. 2009) Used ALS mean and SD to stratify. First they separated forest types then 10 strata were derived suing mean height. Within each stratum, 3 additional sub-strata were created using SD. This produced a total of 30 stratifications where one coniferous forest and two deciduous forest locations randomly selected. They compared samples taken from strata with a random sample finding that: &gt;Prediction errors from models constructed using a random sample were up to 68% larger than those from the models built with a stratified sample. The stratified sample included a greater range of variability than the random sample. (Dalponte et al. 2011) They analyzed 2 aspects of ground reference data collection. The positioning error of the ground plots The optimal number of training plots. They had a large collection of samples &gt;700 and systematically analyzed how the reduction of sample numbers influenced accuracy of attribute estimates. They tested the effect of error in estimate related to distance the center point of the plot was moved. The decrease was at a minimum when the displacement was less than 5 m, while it was considerable over 10 m. They did random downsampling of the sample plot number and stratified downsampling of the sample plot number. They used the methods from (Hawbaker et al. 2009) and (Maltamo et al. 2011) for stratified downsampling. Comparing the results obtained with the proposed stratified sampling method and the other three methods considered (see Table 3), one can see that the proposed stratified sampling method was the one that provided the best results for both sets. The new protocol allowed us to obtain promising results for the considered dataset: using only 53 training plots, instead of 534 in the original dataset, we obtained the same results for the validation set. (Maltamo et al. 2011) Used divided P90 into 12 even parts. A near equal number of sample plots were systematically chosen within each of these 12 parts according to the range of VEG (ratio of vegetation points and ground points). To representatively sample the 12 parts and to cover the extremes, selection intensity was higher in the p90 range range with the lowest number of previously established plots. The use of ALS data as a priori information provided the most accurate results. They also provide the an important statement: One should keep in mind that in real world applications ,some given ALS variables will have to be used for selection of plots regardless of which and how many biophysical properties the inventory aims at estimating. Thus, some ALS variables will work better for certain biophysical properties than for others. An appropriate way of choosing suitable ALS variables could be to select them according to the relative importance of the biophysical properties to be estimated.for volume and number of stems. plots. REduced total sample size incrementally. (Junttila et al. 2013) Used a number of approaches including a space filling design, which attempts to sample uniformly across a feature space. The Maximin design attempts to cover a feature space as uniformly as possible given a fixed number of sample points. It maximizes the minimum distance between plots. The results indicate that choosing the plots in a way that ensures ample coverage of both spatial and feature space variability improves the performance of the corresponding models, and that adequate coverage of the variability in the feature space is the most important condition that should be met by the set of plots collected. (Valbuena et al. 2013) Used the Cover metric to privde a idea of the density of each forest area. The justified that cover influenced the relation between other metrics and the forest response and, therefore, it was included in all the models computed. (Grafström and Ringvall 2013) Presents the (Grafström and Lisic 2019) package. and does comparisons between Simple random sampling (SRS) and: Local pivotal method with x and y coordinates (LPM-xy) to make sure the sample is well spread geographically. The Euclidean distance is used without standardization because the spatial coordinates are on the same scale. Local pivotal method (LPM) XY and four selected ALS variables as auxiliary variables. The samples are well spread geographically and well spread in the four ALS variables. The distance function (eq. (3)) is used. Cube method (CM) The samples are balanced on the four ALS variables. The x and y coordinates are not used for this method, because it does not make sense to balance on geographical coordinates. Local cube method (LCM) The samples are balanced on the four ALS variables and the x and y coordinates are used to make sure the sample is well spread geographically. The Euclidean distance is used in the geographical space. They found that spreading the sample well in geographical space is important. Spreading the sample well in all auxiliary variables (LPM) and using the HT estimator was in all cases a more efficient strategy than SRS followed by a calibration estimator. Spreading the sample well is more efficient than balancing (or SRS followed by calibration) if the relationship between the target and the auxiliary variables is nonlinear, which is why it performs better (see Tables 2 and 3). The final order of the designs combined with the calibration estimator was (from best to worst) LCM, LPM, LPM-xy, CM, and SRS. We get the best results when using the information both in the design and the estimator. Hence, we can conclude that using auxiliary information in the design is very important. \" All three designs, LCM, LPM, and CM, had very good design effects. The reduction of the variance of the HT estimator was for the main target variable volume up to 75% compared with SRS. (Grafström, Saarela, and Ene 2014) Continuation of previous study highlighting value of sampling methods. A possible drawback of the LPM compared with more simple methods such as systematic random sampling is that sample se- lection is computationally intensive for large populations. This is a problem because the population size (number of pixels) tends to be rather large in forest applications with auxiliary data from, e.g., airborne LiDAR, making it practically impossible to apply the LPM as it is. To deal with this problem, we introduce a new rapid suboptimal implementation ofthe LPM that can be applied to large populations. With the LPM, there is no stratification or other difficult design choices; we only need to define distance. Modelling is not really necessary, which means no complicated formulas. Yet this is a very competitive strategy in many cases. It has the advantage of being intuitive and simple, which should not be underrated. It also allows us to keep the traditional design-based approach, while still taking advantage of powerful auxiliary information. With the LPM, there is no stratification or other difficult design choices; we only need to define distance. Modelling is not really necessary, which means no complicated formulas. Yet this is a very competitive strategy in many cases. It has the advantage of being intuitive and simple, which should not be underrated. It also allows us to keep the traditional design-based approach, while still taking advantage of powerful auxiliary information. (Niemi and Vauhkonen 2016) Used ALS textural CHM metrics (HIST,PATCH,GLCM,LBP) for pre-stratification of the inventory area. They tested the strength of the relationship between metrics and central attributes of forest growing stock (Vol,BA,Diam). It was found that the dispersion of the clusters derived in an unsupervised mode could be used as an indicator for prioritizing the plots to be measured as the sample to form the reference data for the wall-to-wall models. (Valbuena et al. 2017) Used a rule based method to stratify forest areas using Lmoments including Lcv and Lskew. (McRoberts, Chen, and Walters 2017) Modeling inventory attributes with ALS metrics. BA was considered as an integrator of all the response variables and was used as the basis for constructing strata using a lonear model. Predictions of BA were then scaled by the largest BA prediction,multiplied by 100, then assigned 1 of 100 potential strata. Strata were then aggregated these into 4,6,8 strata with approximately equal proportion of study area. Stratifications that are most effective with respect to minimizing variances are based on variables that are closely related to the response variable or variables of interest. When multiple response variables are to be estimated simultaneously, the same stratification must be used for all response variables to ensure compatibility. Results showed they were able to: &gt;Reduce sampling intensity by up to 35% without losing accuracy in the estimators. Relative to the simple random sampling estimators that used no stratification, use of four strata decreased SEs by 29.0%38.1%, depending on the response variable; relative to four strata, use of six strata reduced SEs by 2.3%7.3%; and relative to six strata, use of eight strata reduced SEs by no more than 4% and for two response variables actually increased SEs. From an operational perspective, the results of the study suggest that multivariate, airborne laser scanning-assisted inventories could be fairly easily implemented, subject to availability of the airborne laser scanning data. (Malone, Minansy, and Brungard 2019) They provide an indepth description of how to implement and improve the outputs of Latin Hypercube sampling, providing a coded example of how to incorporate already acquired samples accross the landscape. They specify a method to boostrap sample size followed by the application of multiple methods to determine the optimal sample number to use based on auxillary data. (Papa et al. 2020) Compared simple random sampling to stratified sampling within strata groups. Used hierarchical cluster analysis for formation of strata. Clusters were used for sub-sampling. The number of clusters was established by the Elbow method. Clusters were validated with an ANOVA post-hoc Tukey test. Varying size of metric cells (1, 0.5, 0.25 ha) were tested. The stratified sampling was simulated by using weighting distributed by strata, so that each segment was the same sample size, whereas no weighting was used for the simulation in the case of the simple random sampling. For each level of sampling size (number of plots in the inventory), 1000 iterations were performed, and their mean and standard deviation were summarized in order to produce a graph of relative uncertainty (standard error/global mean) as a function of sample intensity (proportion of total area sampled, in %). (Ma et al. 2020) They compare latin hypercube sampling and feature space coverage sampling for predicting soil classes. They detail specific functions to use for latin hypercube sampling and feature space coverage sampling. Sampling pools of varying sizes are compared to simple random sampling in a number of modeling approaches. Final results indicated that: 1)In both study areas the median overall accuracy with FSCS washigher than those with CLHS and SRS over all sample sizes and crossall three prediction methods. The median overall accuracy with CLHS was only marginally larger than with SRS. 2)There was a significant negative correlation betweenMSSSDandoverall accuracy, whereas no such correlation was found betweenO1 + O3and overall accuracy.The coefficient of variation in overall accuracy among samples se-lected using FSCS was smaller than these using CLHS and SRS at thesame sample sizes. 3)With CLHS the variation in overall accuracy among samples waslarge, so that there is a serious risk that a particular sample mightlead to a low overall accuracy. 4)FSCS-RF is the most accurate combination of sampling and predic-tion for both study areas Results indicated that feature space coverage sampling could be a viable method for locating samples. pre { max-height: 500px; overflow-y: auto; } pre[class] { max-height: 500px; } References "],["fund.html", "sgsR fundamentals Algorithm structure Example data Additional example data", " sgsR fundamentals To install the package from the github please run the following install.packages(&quot;devtools&quot;) devtools::install_github(&quot;https://github.com/tgoodbody/sgsR&quot;, build_vignettes = FALSE) Algorithm structure sgsR has been scripted primarily using the terra package for raster processing and the sf package for vector manipulation. There are 3 primary function verbs that the package uses: calculate_* - The calculate verb implies that these functions are performing calculations to be used in consequent processing. The use of predefined sample analysis algorithms (calculate_coobs, calculate_ahels) are also included. strat_* - The stratify verb implies that these functions are applying stratification algorithms to an input metrics raster (mraster) and output a stratified raster (sraster) sample_* - The sample verb implies that these functions are extracting samples from srasters produced from strat_* functions. A few algorithms (e.g. sample_srs, sample_balanced, sample_grid) are able to take mrasters as inputs as they are not dependent on stratified inputs for sampling. Package Documentation I do not go into detail about the intricacies of each function in this vignette. Please see the documentation for functions e.g. ?sgsR::strat_kmeans for all details about how use and intended application of each function. Example data Worked examples of all functions are provided below using data internal to the package. To load internal mraster and road access data we use the following code. Raster data library(sgsR) library(terra) #--- Load mraster and access files ---# r &lt;- system.file(&quot;extdata&quot;, &quot;wall_metrics_small.tif&quot;, package = &quot;sgsR&quot;) #--- load the mraster using the terra package ---# mraster &lt;- terra::rast(r) Road access data a &lt;- system.file(&quot;extdata&quot;, &quot;roads.shp&quot;, package = &quot;sgsR&quot;) #--- load the access vector using the sf package ---# access &lt;- sf::st_read(a) ## Reading layer `roads&#39; from data source ## `C:\\Users\\tgood.stu\\Documents\\R\\win-library\\4.0\\sgsR\\extdata\\roads.shp&#39; ## using driver `ESRI Shapefile&#39; ## Simple feature collection with 167 features and 36 fields ## Geometry type: MULTILINESTRING ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438560 ymax: 5343240 ## Projected CRS: UTM_Zone_17_Northern_Hemisphere terra::plot(mraster[[1]]) terra::plot(access, add = TRUE, col = &quot;black&quot;) From the plot we see the first band (zmax) of the mraster with the access vector overlaid. For the purposes of this tutorial I am also going to show how to produce a basic sraster and existing sample data that we will used in examples below. Additional example data To make the sraster we will use the strat_kmeans function where the input mraster will be stratified using a kmeans algorithm. After the sraster is produced we apply the sample_srs algorithm which randomly samples points within our sraster to produce an existing sample dataset. More detail and examples about these functions will be given below: #--- apply kmeans algorithm to metrics raster ---# sraster &lt;- strat_kmeans(mraster = mraster, nStrata = 4, # algorithm will produce 4 strata plot = TRUE) # algorithm will plot output #--- apply kmeans algorithm to metrics raster ---# existing &lt;- sample_srs(raster = mraster, # use sraster as input for sampling nSamp = 200, # request 200 samples be taken mindist = 100, # define that samples must be 100 m apart plot = TRUE) # algorithm will plot output We now have mraster, access, sraster and existing datasets generated. Expect to see these data used in the following examples. pre { max-height: 500px; overflow-y: auto; } pre[class] { max-height: 500px; } ## Reading layer `roads&#39; from data source ## `C:\\Users\\tgood.stu\\Documents\\R\\win-library\\4.0\\sgsR\\extdata\\roads.shp&#39; ## using driver `ESRI Shapefile&#39; ## Simple feature collection with 167 features and 36 fields ## Geometry type: MULTILINESTRING ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438560 ymax: 5343240 ## Projected CRS: UTM_Zone_17_Northern_Hemisphere "],["strat.html", "strat_* functions strat_kmeans strat_pcomp strat_breaks strat_quantiles strat_osb", " strat_* functions Fundamental to many structurally guided sampling approaches is the use of stratification methods that allow for more effective and representative sampling protocols. Below I define the stratification methods that are included thus far in sgsR and provide some worked examples for each. A total of 5 strat functions currently exist in the package: strat_kmeans - kmeans stratification strat_pcomp- principal component stratification strat_breaks - user-defined break stratification strat_quantiles - quantile stratification strat_osb - optimum sample boundary stratification strat_kmeans We provide a preliminary example of the strat_kmeans algorithm to prepare our input data but here are a few more. #--- perform stratification using k-means ---# kmeans &lt;- strat_kmeans(mraster = mraster, # input nStrata = 5) # algorithm will produce 4 strata Plot Notice that nothing plotted Thats because plot = FALSE is the default for all functions in sgsR. See examples below where plot = TRUE. kmeans &lt;- strat_kmeans(mraster = mraster, # input nStrata = 10, # algorithm will produce 10 strata iter = 1000, # set minimum number of interations to determine kmeans centers algorithm = &quot;MacQueen&quot;, # use MacQueen algorithm plot = TRUE, # plot output details = TRUE) # output details - kmeans stratification data and output sraster kmeans &lt;- strat_kmeans(mraster = mraster, # input nStrata = 5, # algorithm will produce 4 strata center = FALSE, # do not center data scale = FALSE, # do not scale data plot = TRUE, # plot output filename = tempfile(fileext = &quot;.tif&quot;), # write output sraster to file overwrite = TRUE) # overwrite file on disc if it exists strat_pcomp The strat_pcomp algorithm calculates principal components on the input mraster then divides data into equal sized strata. Strata can be defined by using the primary (PC1) only, or primary &amp; secondary (PC2) principal components. If nStata2 is defined, PC2 is used and the total number of strata will be \\[nStrata * nStrata2\\]. strat_pcomp(mraster = mraster, # input nStrata = 5, # 5 strata with primary PC only plot = TRUE) ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 5 strat_pcomp(mraster = mraster, # input nStrata = 4, # 4 strata with primary nStrata2 = 4, # 4 strata with secondary PC - will produce 16 output strata plot = TRUE, # plot details = TRUE) # produce output details ## $details ## Standard deviations (1, .., p=13): ## [1] 2.93647150 1.26882709 1.15691535 0.86852611 0.53076565 0.42304219 0.35679023 ## [8] 0.21988261 0.14290118 0.09666573 0.07179753 0.05016994 0.02570635 ## ## Rotation (n x k) = (13 x 13): ## PC1 PC2 PC3 PC4 PC5 PC6 ## zmax 0.3359531 0.01817295 -0.085980156 0.04883369 -0.16446975 0.134888577 ## zmean 0.2692352 -0.14320556 0.484261417 0.08715503 0.10021008 0.208524587 ## zsd 0.2525172 0.46307645 0.056280928 -0.35189237 -0.05790180 -0.047159024 ## pzabove2 0.2575694 -0.38512031 -0.153689213 0.33477151 -0.20262484 -0.504470621 ## zq20 0.2957809 -0.25072438 -0.163557453 0.28595035 -0.26718846 -0.008654979 ## zq50 0.3271212 0.02248762 -0.100221327 0.07934796 -0.16569646 0.420247325 ## zq70 0.3296060 0.11882609 -0.062083857 -0.02690735 -0.12986291 0.271021251 ## zq90 0.3192555 0.21122345 0.009465806 -0.18799597 -0.09477864 -0.264930469 ## zq95 0.3091490 0.21445676 0.055153306 -0.23449020 -0.07471056 -0.451270472 ## l_1 -0.1885162 0.18294540 0.614448790 0.27802959 -0.27135857 -0.287232900 ## l_2 0.2327722 -0.43278499 0.060836142 -0.34982009 0.57978716 -0.188355371 ## t_3 0.1690462 0.45853939 -0.166263397 0.60467076 0.59765870 -0.091199035 ## t_4 0.2561467 -0.13145011 0.527861021 0.09849843 0.14573821 0.177036168 ## PC7 PC8 PC9 PC10 PC11 ## zmax -0.15339832 0.0308922302 -1.886049e-02 0.0560186614 -0.1278804649 ## zmean 0.28510651 -0.0021690322 2.826642e-02 0.0270039439 0.0675442390 ## zsd -0.05015151 0.1340537231 3.445926e-01 -0.0513256272 0.6681251318 ## pzabove2 0.11141535 0.5392526124 -2.020873e-02 0.0120286554 0.2179924264 ## zq20 -0.08550919 -0.6885132239 3.627060e-01 -0.1271545992 0.1378591128 ## zq50 -0.29668394 0.0329045573 -5.353496e-01 0.4057583148 0.2063460374 ## zq70 -0.22963234 0.3370366252 1.490613e-01 -0.5945209546 -0.4103363124 ## zq90 0.08153534 -0.0006831206 3.087370e-01 0.5970060214 -0.4980350813 ## zq95 0.21011887 -0.3114508486 -5.847183e-01 -0.3194796103 -0.0758389467 ## l_1 -0.56400277 -0.0188834161 -2.142108e-02 0.0060754571 -0.0313981609 ## l_2 -0.50772612 -0.0466621166 2.094108e-02 0.0009527472 0.0201177308 ## t_3 -0.03067072 -0.0310296725 7.516919e-05 -0.0011560670 0.0009191501 ## t_4 0.32336804 0.0324261270 3.474720e-02 -0.0238296876 -0.0055552525 ## PC12 PC13 ## zmax -0.0052115172 0.8873685582 ## zmean -0.7236917619 -0.0162558333 ## zsd 0.0295065391 0.0098559868 ## pzabove2 -0.0004334086 -0.0531021769 ## zq20 0.0390001016 -0.1416169733 ## zq50 0.0609622299 -0.2923086818 ## zq70 -0.0257022931 -0.2670379822 ## zq90 -0.0047718481 -0.1800345902 ## zq95 -0.0171556239 -0.0045593830 ## l_1 -0.0077753523 0.0029767582 ## l_2 -0.0003045197 -0.0008875782 ## t_3 -0.0216941448 -0.0022824635 ## t_4 0.6845626123 0.0117767342 ## ## $raster ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 16 ## ## $plot strat_pcomp(mraster = mraster, # input nStrata = 3, # 3 strata with primary PC nStrata2 = 3, # 4 strata with secondary PC - will produce 9 output strata filename = tempfile(fileext = &quot;.tif&quot;)) # write output sraster to file ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 9 strat_breaks The strat_breaks function stratifies data based on user-defined breaks in covariates. A single metric can be defined or an additional metric2 can be supplied. breaks and breaks2 correspond to the user-defined breaks for metric and metric2` respectively. #--- create vector breaks ---# br.max &lt;- c(3, 5, 11, 18) #zmax breaks br.sd &lt;- c(1, 2, 5) #zsd breaks Once the breaks have been created we can input them into the function. strat_breaks(mraster = mraster, # input metric = &quot;zmax&quot;, # covariate of interest - can be numeric index of mraster or character string breaks = br.max, # breaks for primary covariate plot = TRUE, # plot details = TRUE) # output details ## $details ## $details$breaks ## [1] 3 5 11 18 ## ## $details$breaks2 ## NULL ## ## ## $raster ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 5 ## ## $plot strat_breaks(mraster = mraster, # input metric = 1, # primary covariate of interest - can be numeric index of mraster or character string metric2 = &quot;zsd&quot;, # secondary covariate of interest - can be numeric index of mraster or character string breaks = br.max, # breaks for primary covariate breaks2 = br.sd, # breaks for secondary covariate plot = TRUE) # plot ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 16 strat_quantiles The strat_quantiles function stratifies data into the user-defined number of quantiles. A single metric can be defined or an additional metric2 can be supplied. nQuant and nQuant2 correspond to the desired number of quantiles for metric and metric2respectively. IfnQuant` is defined, the total number of strata will be \\[nStrata = nQuant * nQuant2\\] strat_quantiles(mraster = mraster, # input metric = 4, # primary covariate of interest - can be numeric index of mraster or character string nQuant = 10, # number of quantiles for primary covariate plot = TRUE) # plot ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 10 strat_quantiles(mraster = mraster, # input metric = &quot;zsd&quot;, # primary covariate of interest - can be numeric index of mraster or character string metric2 = &quot;zq95&quot;, # secondary covariate of interest - can be numeric index of mraster or character string nQuant = 3, # number of quantiles for primary covariate nQuant2 = 4, # number of quantiles for secondary covariate plot = TRUE) # plot ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 12 strat_quantiles(mraster = mraster, # input metric = 1, # primary covariate of interest - can be numeric index of mraster or character string metric2 = &quot;zsd&quot;, # secondary covariate of interest - can be numeric index of mraster or character string nQuant = 2, # number of quantiles for primary covariate nQuant2 = 2, # number of quantiles for secondary covariate filename = tempfile(fileext = &quot;.tif&quot;)) # write output sraster to file ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 4 strat_osb The strat_osb algorithm implements the optimum sample boundaries algorithm implmented in the FortifyR package. For further details about the algorithms used check out their package and also consult ?sgsR::strat_osb for references. The basics of this algorithm are to provide the number of desired strata nStrata and samples nSamp. The algorithm then analyzes the data for the optimal locations to establish breaks in the covariate, which are used as stratum boundaries. This function can take a bit longer to run so please be patient! For the purpses of this vignette i have used a limited number of strata and samples to ensure they run and render quickly. #--- perform optimum sample boundary stratification ---# strat_osb(mraster = mraster, # input metric = &quot;zsd&quot;, # covariate of interest - can be numeric index of mraster or character string nSamp = 50, # number of desired samples nStrata = 3, # number of desired strata plot = TRUE) # plot strat_osb(mraster = mraster, # input metric = 4, # covariate of interest - can be numeric index of mraster or character string nSamp = 25, # number of desired samples nStrata = 3, # number of desired strata plot = TRUE, # plot details = TRUE) # produce output details strat_osb(mraster = mraster, # input metric = &quot;zmax&quot;, # covariate of interest - can be numeric index of mraster or character string nSamp = 50, # number of desired samples nStrata = 3, # number of desired strata subset = 0.75, # used a subset of covariate data to determine optimum breaks filename = tempfile(fileext = &quot;.tif&quot;)) # write output sraster to file pre { max-height: 500px; overflow-y: auto; } pre[class] { max-height: 500px; } ## Reading layer `roads&#39; from data source ## `C:\\Users\\tgood.stu\\Documents\\R\\win-library\\4.0\\sgsR\\extdata\\roads.shp&#39; ## using driver `ESRI Shapefile&#39; ## Simple feature collection with 167 features and 36 fields ## Geometry type: MULTILINESTRING ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438560 ymax: 5343240 ## Projected CRS: UTM_Zone_17_Northern_Hemisphere "],["sample.html", "sample_* functions Access sample_srs sample_grid sample_strat sample_clhs sample_balanced", " sample_* functions A total of 5 sample functions currently exist in the package: sample_srs - simple random sampling sample_grid- sample principal components on input mraster sample_strat - sample the number of samples needed for represntative sample within a sraster sample_clhs - appy the adapted Hypercube Evaluation of a Legacy Sample (ahels) algorithm to existing samples sample_balanced - apply count of observations algorithm to existing samples Access A feature of the sample_* functions that may be of interest is the ability to define access. Users can supply a road access network (must be lines) as access aswell as define buffers around access where samples should be excluded and included. Important additional parameter when access is provided are: buff_inner - An inner buffer that defines the distance from access where samples cannot be takes (i.e. if you do not want samples within 50 m of your access layer set buff_inner = 50). buff_outer - Maximum distance samples can be located from access (i.e. if you dont want samples more than 200 meters from a road set buff_inner = 200) sample_srs We provided a very simple example of using the sample_srs function when we were preparing our input data. We provide some addition examples below. Input raster Notice that the input for sample_srs is raster. This means that an sraster or an mraster can be supplied. #--- perform simple random sampling ---# sample_srs(raster = sraster, # input sraster nSamp = 200, # number of desired samples plot = TRUE) # plot ## Simple feature collection with 200 features and 0 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431130 ymin: 5337710 xmax: 438550 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## geometry ## 1 POINT (436550 5340070) ## 2 POINT (435470 5338230) ## 3 POINT (436630 5339490) ## 4 POINT (432670 5339310) ## 5 POINT (433950 5341710) ## 6 POINT (437730 5341290) ## 7 POINT (434110 5343170) ## 8 POINT (434050 5340350) ## 9 POINT (437410 5341870) ## 10 POINT (432790 5340910) sample_srs(raster = mraster, # input mraster nSamp = 200, # number of desired samples access = access, # define access road network mindist = 200, # minimum distance samples must be apart from one another buff_inner = 50, # inner buffer - no samples within this distance from road buff_outer = 200, # outer buffer - no samples further than this distance from road plot = TRUE) # plot ## Simple feature collection with 200 features and 0 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431250 ymin: 5337710 xmax: 438530 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## geometry ## 1 POINT (435870 5339950) ## 2 POINT (432550 5340690) ## 3 POINT (433570 5341270) ## 4 POINT (435850 5339010) ## 5 POINT (437230 5337750) ## 6 POINT (434610 5342290) ## 7 POINT (431950 5337770) ## 8 POINT (433410 5343030) ## 9 POINT (432710 5339430) ## 10 POINT (435250 5341950) sample_srs(raster = sraster, # input nSamp = 200, # number of desired samples access = access, # define access road network buff_inner = 50, # inner buffer - no samples within this distance from road buff_outer = 200, # outer buffer - no samples further than this distance from road plot = TRUE, # plot filename = tempfile(fileext = &quot;.shp&quot;)) # write output samples to file ## Writing layer `file4b0054073f24&#39; to data source ## `C:\\Users\\tgood.stu\\AppData\\Local\\Temp\\RtmpovDJyg\\file4b0054073f24.shp&#39; using driver `ESRI Shapefile&#39; ## Writing 200 features with 0 fields and geometry type Point. ## Simple feature collection with 200 features and 0 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431150 ymin: 5337750 xmax: 438530 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## geometry ## 1 POINT (437670 5343230) ## 2 POINT (436130 5342550) ## 3 POINT (438050 5340130) ## 4 POINT (434470 5337950) ## 5 POINT (437590 5342210) ## 6 POINT (433910 5340610) ## 7 POINT (437750 5338190) ## 8 POINT (436210 5340350) ## 9 POINT (437950 5339310) ## 10 POINT (438190 5338130) sample_grid The sample_grid function applies regular grid sampling across an area where the gridsize parameter defined distance between samples. #--- perform grid sampling ---# sample_grid(raster = sraster, # input sraster gridsize = 200, # grid distance plot = TRUE) ## Simple feature collection with 953 features and 1 field ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438500 ymax: 5343100 ## CRS: NA ## First 10 features: ## strata geometry ## 1 2 POINT (431100 5337700) ## 2 2 POINT (431300 5337700) ## 3 2 POINT (431500 5337700) ## 4 2 POINT (431700 5337700) ## 5 2 POINT (431900 5337700) ## 6 2 POINT (432100 5337700) ## 7 1 POINT (432300 5337700) ## 8 1 POINT (432500 5337700) ## 9 3 POINT (432700 5337700) ## 10 3 POINT (432900 5337700) sample_grid(raster = sraster, # input sraster gridsize = 100, # grid distance access = access, # define access road network buff_inner = 50, # inner buffer - no samples within this distance from road buff_outer = 200) # outer buffer - no samples further than this distance from road ## Simple feature collection with 1542 features and 1 field ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438500 ymax: 5343200 ## CRS: NA ## First 10 features: ## strata geometry ## 7 2 POINT (431700 5337700) ## 8 2 POINT (431800 5337700) ## 10 3 POINT (432000 5337700) ## 11 2 POINT (432100 5337700) ## 29 1 POINT (433900 5337700) ## 30 1 POINT (434000 5337700) ## 32 1 POINT (434200 5337700) ## 33 2 POINT (434300 5337700) ## 38 2 POINT (434800 5337700) ## 40 1 POINT (435000 5337700) sample_grid(raster = mraster, # input mraster gridsize = 200, # grid distance access = access, # define access road network buff_inner = 100, # inner buffer - no samples within this distance from road buff_outer = 400, # outer buffer - no samples further than this distance from road filename = tempfile(fileext = &quot;.shp&quot;), # write output samples to file plot = TRUE) # plot ## Writing layer `file4b001a0ff9f&#39; to data source ## `C:\\Users\\tgood.stu\\AppData\\Local\\Temp\\RtmpovDJyg\\file4b001a0ff9f.shp&#39; using driver `ESRI Shapefile&#39; ## Writing 506 features with 13 fields and geometry type Point. ## Simple feature collection with 506 features and 13 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438500 ymax: 5343100 ## CRS: NA ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 l_2 t_3 t_4 ## 3 10.54 91.1 3.60 5.330000 7.96 11.219999 12.40 15.26 18.52 5.7 52.9 0.3 86.8 ## 4 12.76 97.9 2.87 9.179999 10.38 12.759999 14.19 17.47 19.78 0.3 59.9 0.8 95.2 ## 6 14.99 95.5 3.47 9.620000 12.89 15.910000 17.03 18.92 19.71 1.1 22.9 0.5 89.9 ## 7 6.30 78.2 3.09 2.050000 2.88 6.440000 8.47 11.10 11.91 23.8 11.7 0.0 76.3 ## 14 6.01 26.9 2.92 1.810000 2.78 6.180000 7.96 10.37 12.31 7.8 2.2 0.0 26.3 ## 15 6.99 88.8 2.72 3.690000 4.77 6.760000 7.92 12.45 14.42 18.2 11.4 0.0 86.1 ## 17 8.82 82.8 3.31 4.580000 5.97 8.809999 10.66 14.34 15.75 8.1 26.8 0.0 76.2 ## 18 6.76 67.0 2.97 2.400000 3.74 7.020000 8.75 11.30 12.49 16.2 9.3 0.0 61.3 ## 19 7.83 87.8 1.85 5.380000 6.46 8.090000 8.90 10.38 11.09 5.5 7.6 0.0 76.9 ## 22 14.36 95.6 3.85 7.990000 12.67 15.469999 16.64 18.35 18.92 3.3 25.5 0.0 91.8 ## geometry ## 3 POINT (431500 5337700) ## 4 POINT (431700 5337700) ## 6 POINT (432100 5337700) ## 7 POINT (432300 5337700) ## 14 POINT (433700 5337700) ## 15 POINT (433900 5337700) ## 17 POINT (434300 5337700) ## 18 POINT (434500 5337700) ## 19 POINT (434700 5337700) ## 22 POINT (435300 5337700) sample_strat The sample_strat function contains a hierarchical sampling algorithm originally developped my Martin Queinnec. The algorithm uses a moving window (wrow and wcol parameters) to filter the input sraster for locations where stratum pixels are grouped rather than disperesed individually accross the landscape. The sampling is performed in 2 stages: Rule 1 - Sample within grouped stratum pixels Rule 2 - If no more samples exist to satisfy desired sampling count, individual stratum pixels are sampled. The rule applied to a select a particular sample is defined in the rule attribute of output samples. We give a few examples below: #--- perform stratified sampling random sampling ---# sample_strat(sraster = sraster, # input sraster nSamp = 200, # desired sample number plot = TRUE) # plot ## Simple feature collection with 200 features and 3 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431130 ymin: 5337730 xmax: 438510 ymax: 5343190 ## Projected CRS: UTM Zone 17, Northern Hemisphere ## First 10 features: ## strata type rule geometry ## x 1 new rule1 POINT (437730 5340870) ## x1 1 new rule1 POINT (437730 5340870) ## x2 1 new rule1 POINT (436930 5339710) ## x3 1 new rule1 POINT (432490 5342750) ## x4 1 new rule1 POINT (437170 5339650) ## x5 1 new rule1 POINT (436410 5338110) ## x6 1 new rule1 POINT (434310 5340830) ## x7 1 new rule1 POINT (435950 5342790) ## x8 1 new rule1 POINT (436350 5342370) ## x9 1 new rule1 POINT (437250 5339690) In some cases, a user may wish to included an existing sample dataset within the algorithm. In order to adjust the total number of samples needed per stratum, we can use the utility function extract_strata. This function takes an input sraster and the existing sample dataset and extracts the stratum for each sample. These samples can then be input into the sample_strat function which adjusts total requred sample per class based on representation in existing. #--- extract strata values to existing samples ---# e.sr &lt;- extract_strata(sraster = sraster, # input sraster existing = existing) # existing samples to add strata value to e.sr ## Simple feature collection with 200 features and 1 field ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431270 ymin: 5337750 xmax: 438530 ymax: 5343230 ## Projected CRS: UTM Zone 17, Northern Hemisphere ## First 10 features: ## strata geometry ## 1 2 POINT (438530 5338570) ## 2 2 POINT (434850 5338310) ## 3 1 POINT (435270 5340490) ## 4 3 POINT (436150 5341230) ## 5 2 POINT (431850 5342430) ## 6 2 POINT (433350 5342390) ## 7 3 POINT (436590 5341950) ## 8 1 POINT (434790 5340210) ## 9 4 POINT (435750 5338710) ## 10 1 POINT (438050 5340930) Existing strata Notice that e.sr now has an attribute named strata. If that parameter is not there, sample_strat will give an error. sample_strat(sraster = sraster, # input sraster nSamp = 200, # desired sample number access = access, # define access road network existing = e.sr, # existing samples with strata values mindist = 200, # minimum distance samples must be apart from one another buff_inner = 50, # inner buffer - no samples within this distance from road buff_outer = 200, # outer buffer - no samples further than this distance from road plot = TRUE) # plot ## Simple feature collection with 400 features and 3 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431130 ymin: 5337730 xmax: 438530 ymax: 5343230 ## Projected CRS: UTM Zone 17, Northern Hemisphere ## First 10 features: ## strata type rule geometry ## 3 1 existing existing POINT (435270 5340490) ## 8 1 existing existing POINT (434790 5340210) ## 10 1 existing existing POINT (438050 5340930) ## 12 1 existing existing POINT (431950 5341710) ## 16 1 existing existing POINT (433610 5343170) ## 20 1 existing existing POINT (435990 5342970) ## 22 1 existing existing POINT (432090 5340190) ## 24 1 existing existing POINT (436090 5337790) ## 25 1 existing existing POINT (437030 5338010) ## 27 1 existing existing POINT (432290 5341850) Notice that the sample outputs have type and rule attributes which outline whether samples are existing or new and whether rule1 or rule2 were used to select individual samples. include parameter The include parameter determines whether existing samples should be included in the total of samples defined by nSamp. By defaults include = FALSE. sample_strat(sraster = sraster, # input nSamp = 200, # desired sample number access = access, # define access road network existing = e.sr, # existing samples with strata values include = TRUE, # include existing plots in nSamp total buff_inner = 50, # inner buffer - no samples within this distance from road buff_outer = 200, # outer buffer - no samples further than this distance from road filename = tempfile(fileext = &quot;.shp&quot;), # write output samples to file plot = TRUE) # plot ## Writing layer `file4b004f55746d&#39; to data source ## `C:\\Users\\tgood.stu\\AppData\\Local\\Temp\\RtmpovDJyg\\file4b004f55746d.shp&#39; using driver `ESRI Shapefile&#39; ## Writing 110 features with 3 fields and geometry type Point. ## Simple feature collection with 110 features and 3 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431190 ymin: 5337750 xmax: 438510 ymax: 5343230 ## Projected CRS: UTM Zone 17, Northern Hemisphere ## First 10 features: ## strata type rule geometry ## 3 1 existing existing POINT (435270 5340490) ## 8 1 existing existing POINT (434790 5340210) ## 10 1 existing existing POINT (438050 5340930) ## 12 1 existing existing POINT (431950 5341710) ## 16 1 existing existing POINT (433610 5343170) ## 20 1 existing existing POINT (435990 5342970) ## 22 1 existing existing POINT (432090 5340190) ## 24 1 existing existing POINT (436090 5337790) ## 25 1 existing existing POINT (437030 5338010) ## 27 1 existing existing POINT (432290 5341850) sample_clhs The sample_clhs functions implements conditioned latin hypercube (clhs) sampling functionality. A number of other functions in the sgsR package help to provide guidance on clhs sampling including calculate_lhsPop and calculate_lhsOpt. Be sure to check out those functions for better understanding of how many samples should be taken. Syntax for the function is similar to others shown above, though parameters like iter, which define the number of interations within the Metropolis-Hastings process are important to consider. In these examples we use a low iter value because it takes less time to run, but default values within the clhs package are 10,000. sample_clhs(mraster = mraster, # input nSamp = 200, # desired sample number plot = TRUE, # plot iter = 100) # number of iterations ## | | | 0% | |= | 1% | |== | 2% | |== | 3% | |=== | 4% | |==== | 5% | |===== | 6% | |===== | 7% | |====== | 8% | |======= | 9% | |======== | 10% | |========= | 11% | |========= | 12% | |========== | 13% | |=========== | 14% | |============ | 15% | |============ | 16% | |============= | 17% | |============== | 18% | |=============== | 19% | |================ | 20% | |================ | 21% | |================= | 22% | |================== | 23% | |=================== | 24% | |=================== | 25% | |==================== | 26% | |===================== | 27% | |====================== | 28% | |======================= | 29% | |======================= | 30% | |======================== | 31% | |========================= | 32% | |========================== | 33% | |========================== | 34% | |=========================== | 35% | |============================ | 36% | |============================= | 37% | |============================== | 38% | |============================== | 39% | |=============================== | 40% | |================================ | 41% | |================================= | 42% | |================================= | 43% | |================================== | 44% | |=================================== | 45% | |==================================== | 46% | |===================================== | 47% | |===================================== | 48% | |====================================== | 49% | |======================================= | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 54% | |========================================== | 55% | |=========================================== | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 59% | |============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 63% | |================================================= | 64% | |================================================== | 65% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 68% | |===================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 72% | |======================================================== | 73% | |========================================================= | 74% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 78% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 83% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 86% | |=================================================================== | 87% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 91% | |======================================================================= | 92% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 95% | |========================================================================== | 96% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 99% | |=============================================================================| 100% ## Simple feature collection with 200 features and 14 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431130 ymin: 5337730 xmax: 438450 ymax: 5343150 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 l_2 t_3 t_4 ## 10031 4.01 43.5 2.98 1.78 2.20 2.940000 3.57 11.19 14.29 34.2 3.5 0.0 43.4 ## 8168 2.94 44.3 1.02 1.68 1.97 2.840000 3.41 4.76 5.77 42.3 0.0 0.0 44.3 ## 79535 8.51 91.2 4.34 3.08 4.85 8.099999 9.99 17.22 20.31 15.6 19.0 1.2 88.3 ## 78103 1.70 0.4 0.42 1.35 1.39 1.550000 1.74 2.77 2.93 0.4 0.0 0.0 0.4 ## 30083 13.95 90.5 4.38 8.32 12.18 14.660000 15.93 20.21 23.55 3.0 38.7 4.6 84.6 ## 55901 15.15 84.9 5.52 4.59 11.87 17.109999 18.39 20.64 21.65 5.6 7.5 8.0 75.8 ## 29030 13.11 80.8 6.43 2.51 5.03 14.639999 17.37 22.11 24.59 11.7 19.7 7.5 76.9 ## 66129 9.25 95.4 4.53 2.99 4.06 9.630000 12.17 15.97 18.34 21.8 35.1 0.3 93.8 ## 9154 10.66 41.8 4.50 3.31 6.97 10.980000 13.29 17.36 18.43 3.1 16.4 0.0 38.2 ## 86649 10.66 86.4 3.79 4.90 7.61 11.080000 12.98 16.23 17.70 6.8 39.9 0.0 79.1 ## type geometry ## 10031 new POINT (437730 5342650) ## 8168 new POINT (434950 5342750) ## 79535 new POINT (434030 5338350) ## 78103 new POINT (438350 5338450) ## 30083 new POINT (436210 5341490) ## 55901 new POINT (436290 5339970) ## 29030 new POINT (435790 5341550) ## 66129 new POINT (433950 5339330) ## 9154 new POINT (433090 5342690) ## 86649 new POINT (433710 5337950) sample_clhs(mraster = mraster, # input nSamp = 400, # desired sample number existing = existing, # existing samples iter = 100, # number of iterations details = TRUE) # clhs details ## | | | 0% | |= | 1% | |== | 2% | |== | 3% | |=== | 4% | |==== | 5% | |===== | 6% | |===== | 7% | |====== | 8% | |======= | 9% | |======== | 10% | |========= | 11% | |========= | 12% | |========== | 13% | |=========== | 14% | |============ | 15% | |============ | 16% | |============= | 17% | |============== | 18% | |=============== | 19% | |================ | 20% | |================ | 21% | |================= | 22% | |================== | 23% | |=================== | 24% | |=================== | 25% | |==================== | 26% | |===================== | 27% | |====================== | 28% | |======================= | 29% | |======================= | 30% | |======================== | 31% | |========================= | 32% | |========================== | 33% | |========================== | 34% | |=========================== | 35% | |============================ | 36% | |============================= | 37% | |============================== | 38% | |============================== | 39% | |=============================== | 40% | |================================ | 41% | |================================= | 42% | |================================= | 43% | |================================== | 44% | |=================================== | 45% | |==================================== | 46% | |===================================== | 47% | |===================================== | 48% | |====================================== | 49% | |======================================= | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 54% | |========================================== | 55% | |=========================================== | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 59% | |============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 63% | |================================================= | 64% | |================================================== | 65% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 68% | |===================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 72% | |======================================================== | 73% | |========================================================= | 74% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 78% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 83% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 86% | |=================================================================== | 87% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 91% | |======================================================================= | 92% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 95% | |========================================================================== | 96% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 99% | |=============================================================================| 100% ## $clhs ## [1] 67071 22825 18821 81030 83539 17999 7012 36531 67078 39585 14573 13878 55563 ## [14] 81150 74167 6181 23502 1118 41812 41958 73382 58991 58371 18437 78048 26916 ## [27] 28356 77583 40557 83467 48644 74233 5772 88655 51024 90173 29693 26049 67907 ## [40] 70663 2197 4417 90749 14376 32994 57148 23276 52790 78579 68882 83303 74423 ## [53] 12827 19702 27278 71780 48216 26751 39665 79829 22334 43118 75828 30297 48860 ## [66] 26373 35607 86555 55144 86902 16621 50611 86853 85487 11302 28442 35696 2005 ## [79] 65938 13761 20035 57783 75586 55085 24333 66679 60936 61963 9841 46046 7091 ## [92] 2056 8266 64276 87690 35625 73110 21556 58042 29180 63243 3743 48092 81741 ## [105] 65784 28345 61529 48545 14966 34298 6865 65643 56412 56332 75102 24755 90103 ## [118] 25172 56891 3928 91160 33942 24923 26337 40244 15236 16065 90152 75164 73553 ## [131] 46652 14906 33374 2886 55539 80209 46405 57539 26826 3820 87600 45848 83393 ## [144] 81870 51676 52472 67238 16478 12934 56214 87851 86517 87729 26530 30993 77469 ## [157] 71010 29551 27412 12001 25986 51074 4994 89214 74537 61283 5871 7738 57033 ## [170] 31225 23184 62621 82405 31900 76187 58819 15638 10444 82884 80076 29159 31614 ## [183] 48397 85336 28728 10138 75735 40095 45528 4385 77789 2058 19111 22725 58802 ## [196] 53251 8499 7906 72201 75638 1 2 3 4 5 6 7 8 ## [209] 9 10 11 12 13 14 15 16 17 18 19 20 21 ## [222] 22 23 24 25 26 27 28 29 30 31 32 33 34 ## [235] 35 36 37 38 39 40 41 42 43 44 45 46 47 ## [248] 48 49 50 51 52 53 54 55 56 57 58 59 60 ## [261] 61 62 63 64 65 66 67 68 69 70 71 72 73 ## [274] 74 75 76 77 78 79 80 81 82 83 84 85 86 ## [287] 87 88 89 90 91 92 93 94 95 96 97 98 99 ## [300] 100 101 102 103 104 105 106 107 108 109 110 111 112 ## [313] 113 114 115 116 117 118 119 120 121 122 123 124 125 ## [326] 126 127 128 129 130 131 132 133 134 135 136 137 138 ## [339] 139 140 141 142 143 144 145 146 147 148 149 150 151 ## [352] 152 153 154 155 156 157 158 159 160 161 162 163 164 ## [365] 165 166 167 168 169 170 171 172 173 174 175 176 177 ## [378] 178 179 180 181 182 183 184 185 186 187 188 189 190 ## [391] 191 192 193 194 195 196 197 198 199 200 ## ## $samples ## Simple feature collection with 400 features and 14 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431170 ymin: 5337710 xmax: 438530 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 ## 66871 4.910000 92.1 1.77 2.64 3.35 4.88 5.800000 7.920000 9.76 46.400002 ## 22625 10.660000 94.9 3.82 5.98 7.72 10.25 12.300000 17.320000 19.81 5.400000 ## 18621 9.599999 89.8 3.37 4.50 6.94 10.13 11.849999 13.969999 15.21 6.300000 ## 80830 12.210000 83.5 5.54 4.29 6.88 12.54 16.190001 20.219999 21.24 7.500000 ## 83339 11.490000 94.6 3.29 7.61 9.13 11.62 13.330000 16.359999 17.74 3.700000 ## 17799 2.390000 10.0 0.90 1.44 1.59 2.15 2.680000 4.330000 4.74 9.900001 ## 6812 7.960000 88.7 4.25 2.81 3.89 7.31 10.300000 15.679999 17.42 24.700001 ## 36331 14.520000 77.2 4.17 7.82 12.37 15.70 16.930000 19.059999 20.32 2.700000 ## 66878 6.780000 67.0 3.53 1.99 3.29 6.70 8.599999 12.929999 16.17 16.900000 ## 39385 3.700000 71.9 2.11 1.82 2.17 3.01 3.720000 8.349999 10.63 54.500000 ## l_2 t_3 t_4 type geometry ## 66871 0.8 0.0 91.400002 new POINT (437730 5339290) ## 22625 35.2 0.8 90.599998 new POINT (438210 5341930) ## 18621 43.3 0.0 83.300003 new POINT (437510 5342150) ## 80830 21.8 4.8 77.200005 new POINT (433230 5338270) ## 83339 51.2 0.0 89.300003 new POINT (433850 5338130) ## 17799 0.0 0.0 9.900001 new POINT (435710 5342190) ## 6812 22.4 0.1 86.200005 new POINT (436870 5342830) ## 36331 17.0 1.2 65.700005 new POINT (436270 5341130) ## 66878 10.4 0.0 65.800003 new POINT (437870 5339290) ## 39385 1.6 0.0 71.200005 new POINT (437490 5340950) sample_clhs(mraster = mraster, # input nSamp = 300, # desired sample number iter = 100, # number of iterations existing = existing, # existing samples access = access, # define access road network buff_inner = 100, buff_outer = 300, plot = TRUE) ## | | | 0% | |= | 1% | |== | 2% | |== | 3% | |=== | 4% | |==== | 5% | |===== | 6% | |===== | 7% | |====== | 8% | |======= | 9% | |======== | 10% | |========= | 11% | |========= | 12% | |========== | 13% | |=========== | 14% | |============ | 15% | |============ | 16% | |============= | 17% | |============== | 18% | |=============== | 19% | |================ | 20% | |================ | 21% | |================= | 22% | |================== | 23% | |=================== | 24% | |=================== | 25% | |==================== | 26% | |===================== | 27% | |====================== | 28% | |======================= | 29% | |======================= | 30% | |======================== | 31% | |========================= | 32% | |========================== | 33% | |========================== | 34% | |=========================== | 35% | |============================ | 36% | |============================= | 37% | |============================== | 38% | |============================== | 39% | |=============================== | 40% | |================================ | 41% | |================================= | 42% | |================================= | 43% | |================================== | 44% | |=================================== | 45% | |==================================== | 46% | |===================================== | 47% | |===================================== | 48% | |====================================== | 49% | |======================================= | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 54% | |========================================== | 55% | |=========================================== | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 59% | |============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 63% | |================================================= | 64% | |================================================== | 65% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 68% | |===================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 72% | |======================================================== | 73% | |========================================================= | 74% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 78% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 83% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 86% | |=================================================================== | 87% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 91% | |======================================================================= | 92% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 95% | |========================================================================== | 96% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 99% | |=============================================================================| 100% ## Simple feature collection with 300 features and 14 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431170 ymin: 5337730 xmax: 438530 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 l_2 t_3 ## 36605 4.740000 73.2 2.14 2.00 2.67 4.590000 5.890000 8.32 10.10 36.4 0.8 0.0 ## 28701 6.630000 93.0 2.59 3.24 4.32 6.600000 7.880000 10.93 13.42 22.4 8.7 0.0 ## 12668 2.540000 34.1 1.45 1.45 1.59 2.060000 2.560000 5.84 8.59 29.1 0.2 0.0 ## 29810 9.780000 20.5 5.94 1.53 3.34 9.639999 12.690000 19.92 21.38 2.1 5.8 1.1 ## 3096 6.600000 71.5 3.04 2.61 3.96 6.390000 7.980000 12.33 14.16 18.6 9.8 0.0 ## 13232 11.130000 99.2 2.08 8.71 9.67 11.130000 11.929999 14.70 16.97 0.3 68.7 0.1 ## 2041 9.260000 78.1 4.25 2.56 4.44 10.059999 11.900000 15.45 17.27 12.5 34.1 0.0 ## 1872 12.920000 83.8 6.32 2.23 3.82 15.790000 17.389999 19.61 20.51 12.4 12.2 2.3 ## 19010 9.179999 88.7 2.97 5.39 6.70 9.270000 10.580000 13.70 17.00 5.1 30.4 0.0 ## 32193 7.100000 73.0 2.66 3.30 4.93 7.350000 8.429999 11.13 14.98 12.6 6.0 0.0 ## t_4 type geometry ## 36605 70.1 new POINT (436390 5338090) ## 28701 90.5 new POINT (437790 5339310) ## 12668 34.0 new POINT (433330 5341630) ## 29810 19.9 new POINT (435410 5339130) ## 3096 67.7 new POINT (435290 5342790) ## 13232 97.2 new POINT (434130 5341530) ## 2041 73.9 new POINT (436870 5342890) ## 1872 75.7 new POINT (431430 5342890) ## 19010 83.0 new POINT (437990 5340730) ## 32193 71.5 new POINT (438170 5338710) cost parameter The cost parameter determines defines a covariate to be used to constrain the clhs sampling. This could be any number of variables. An example could be the distance a pixel is from road access (see example below), terrain slope, etc. #--- cost constrained examples ---# #--- calculate distance to access layer for each pixel in mr ---# mr.c &lt;- calculate_distance(raster = mraster, # input access = access, plot = TRUE) # define access road network sample_clhs(mraster = mr.c, # input nSamp = 250, # desired sample number iter = 100, # number of iterations cost = &quot;dist2access&quot;, # cost parameter - name defined in calculate_distance() plot = TRUE) # plot ## | | | 0% | |= | 1% | |== | 2% | |== | 3% | |=== | 4% | |==== | 5% | |===== | 6% | |===== | 7% | |====== | 8% | |======= | 9% | |======== | 10% | |========= | 11% | |========= | 12% | |========== | 13% | |=========== | 14% | |============ | 15% | |============ | 16% | |============= | 17% | |============== | 18% | |=============== | 19% | |================ | 20% | |================ | 21% | |================= | 22% | |================== | 23% | |=================== | 24% | |=================== | 25% | |==================== | 26% | |===================== | 27% | |====================== | 28% | |======================= | 29% | |======================= | 30% | |======================== | 31% | |========================= | 32% | |========================== | 33% | |========================== | 34% | |=========================== | 35% | |============================ | 36% | |============================= | 37% | |============================== | 38% | |============================== | 39% | |=============================== | 40% | |================================ | 41% | |================================= | 42% | |================================= | 43% | |================================== | 44% | |=================================== | 45% | |==================================== | 46% | |===================================== | 47% | |===================================== | 48% | |====================================== | 49% | |======================================= | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 54% | |========================================== | 55% | |=========================================== | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 59% | |============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 63% | |================================================= | 64% | |================================================== | 65% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 68% | |===================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 72% | |======================================================== | 73% | |========================================================= | 74% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 78% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 83% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 86% | |=================================================================== | 87% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 91% | |======================================================================= | 92% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 95% | |========================================================================== | 96% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 99% | |=============================================================================| 100% ## Simple feature collection with 250 features and 15 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337730 xmax: 438550 ymax: 5343210 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 l_2 t_3 t_4 ## 22545 14.83 90.1 6.37 2.53 8.73 17.62 19.00 20.90 24.64 8.900001 10.3 9.5 87.6 ## 87461 14.93 95.9 3.74 8.78 12.91 15.82 17.00 19.59 20.87 2.200000 23.4 3.0 90.8 ## 6436 18.63 87.3 5.38 11.31 14.82 20.62 21.85 23.42 24.06 2.100000 10.3 46.1 77.4 ## 64086 5.09 72.2 2.42 1.95 2.71 4.99 6.35 9.16 10.92 30.600000 1.6 0.0 69.2 ## 17097 7.97 69.9 4.37 2.48 3.77 7.22 10.59 15.84 17.44 17.200001 18.2 0.1 67.4 ## 69248 2.18 12.3 1.02 1.40 1.50 1.84 2.19 4.62 6.31 11.300000 0.0 0.0 12.3 ## 37362 5.86 77.8 4.49 1.98 2.46 3.93 6.68 16.00 18.47 43.500000 9.0 0.1 76.5 ## 84689 11.17 95.4 2.81 7.63 9.40 11.42 12.40 15.66 17.43 2.600000 60.9 0.0 91.1 ## 18973 14.41 81.1 5.34 3.32 11.14 16.33 17.64 19.67 20.48 4.300000 12.2 2.1 70.1 ## 50438 11.38 71.3 4.23 4.40 7.23 12.65 14.18 16.55 17.96 6.000000 32.5 0.0 61.1 ## dist2access type geometry ## 22545 340.00000 new POINT (436590 5341930) ## 87461 228.03509 new POINT (435610 5337910) ## 6436 228.03509 new POINT (436610 5342850) ## 64086 481.66378 new POINT (436630 5339470) ## 17097 140.00000 new POINT (436250 5342230) ## 69248 160.00000 new POINT (438490 5339130) ## 37362 441.81444 new POINT (436770 5341070) ## 84689 742.42845 new POINT (431110 5338050) ## 18973 72.11103 new POINT (437250 5342130) ## 50438 622.89646 new POINT (436910 5340290) sample_clhs(mraster = mr.c, # input nSamp = 250, # desired sample number existing = existing, iter = 100, # number of iterations cost = &quot;dist2access&quot;, # cost parameter - name defined in calculate_distance() plot = TRUE) # plot ## | | | 0% | |= | 1% | |== | 2% | |== | 3% | |=== | 4% | |==== | 5% | |===== | 6% | |===== | 7% | |====== | 8% | |======= | 9% | |======== | 10% | |========= | 11% | |========= | 12% | |========== | 13% | |=========== | 14% | |============ | 15% | |============ | 16% | |============= | 17% | |============== | 18% | |=============== | 19% | |================ | 20% | |================ | 21% | |================= | 22% | |================== | 23% | |=================== | 24% | |=================== | 25% | |==================== | 26% | |===================== | 27% | |====================== | 28% | |======================= | 29% | |======================= | 30% | |======================== | 31% | |========================= | 32% | |========================== | 33% | |========================== | 34% | |=========================== | 35% | |============================ | 36% | |============================= | 37% | |============================== | 38% | |============================== | 39% | |=============================== | 40% | |================================ | 41% | |================================= | 42% | |================================= | 43% | |================================== | 44% | |=================================== | 45% | |==================================== | 46% | |===================================== | 47% | |===================================== | 48% | |====================================== | 49% | |======================================= | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 54% | |========================================== | 55% | |=========================================== | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 59% | |============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 63% | |================================================= | 64% | |================================================== | 65% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 68% | |===================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 72% | |======================================================== | 73% | |========================================================= | 74% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 78% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 83% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 86% | |=================================================================== | 87% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 91% | |======================================================================= | 92% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 95% | |========================================================================== | 96% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 99% | |=============================================================================| 100% ## Simple feature collection with 250 features and 15 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431270 ymin: 5337750 xmax: 438530 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 l_2 t_3 ## 22557 15.330000 86.8 7.92 3.380000 6.50 15.870000 22.16 25.26 26.41 11.2 15.5 30.7 ## 30484 15.400000 92.2 4.31 8.150000 11.98 17.010000 18.02 19.55 20.03 2.5 9.3 1.0 ## 61596 16.840000 96.1 5.24 9.349999 13.96 18.039999 19.92 22.82 23.80 3.4 12.8 27.8 ## 85743 10.440000 98.0 4.59 5.030000 6.31 9.889999 12.80 18.79 23.53 9.0 33.6 3.1 ## 63665 9.059999 86.0 3.93 3.050000 5.02 9.679999 11.52 14.60 16.69 13.4 37.6 0.0 ## 24528 13.130000 97.3 6.97 3.030000 4.49 14.130000 18.03 23.36 26.54 19.7 22.3 14.3 ## 44080 13.660000 93.0 6.61 3.770000 6.34 14.790000 18.16 23.84 26.48 12.1 18.2 11.1 ## 2383 9.389999 76.6 6.42 1.930000 2.54 9.210000 14.45 19.11 20.55 25.6 18.6 1.9 ## 18272 8.990000 90.8 4.08 3.970000 5.24 8.420000 11.27 16.06 18.48 13.5 27.2 0.2 ## 1634 7.330000 41.8 3.45 2.760000 3.95 6.970000 9.69 12.79 13.66 10.9 11.9 0.0 ## t_4 dist2access type geometry ## 22557 84.1 340.00000 new POINT (436830 5341930) ## 30484 85.8 205.91260 new POINT (437170 5341470) ## 61596 92.5 599.33296 new POINT (433770 5339610) ## 85743 96.4 60.00000 new POINT (437630 5338010) ## 63665 83.0 56.56854 new POINT (434810 5339490) ## 24528 96.0 141.42136 new POINT (434210 5341810) ## 44080 90.3 424.26407 new POINT (437770 5340670) ## 2383 73.3 84.85281 new POINT (437250 5343090) ## 18272 87.5 100.00000 new POINT (437850 5342170) ## 1634 40.9 20.00000 new POINT (432110 5343130) sample_balanced The sample_balanced algorithm performs the balanced sampling methodology from the stratifyR and SamplingBigData packagse. These functions can take a bit longer to run so be patient! sample_balanced(mraster = mraster, nSamp = 200, plot = TRUE) ## Simple feature collection with 200 features and 0 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337710 xmax: 438550 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## geometry ## 1 POINT (432010 5343230) ## 2 POINT (434250 5343210) ## 3 POINT (434450 5343190) ## 4 POINT (435770 5343190) ## 5 POINT (437370 5343190) ## 6 POINT (432210 5343130) ## 7 POINT (434610 5343110) ## 8 POINT (432150 5343030) ## 9 POINT (437550 5343030) ## 10 POINT (431770 5343010) sample_balanced(mraster = mraster, nSamp = 100, algorithm = &quot;lcube&quot;, access = access, buff_inner = 50, buff_outer = 200) ## Simple feature collection with 100 features and 0 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431730 ymin: 5337770 xmax: 438550 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## geometry ## 1 POINT (437990 5341270) ## 2 POINT (432990 5339030) ## 3 POINT (438210 5337930) ## 4 POINT (432870 5340290) ## 5 POINT (433070 5342850) ## 6 POINT (435130 5338050) ## 7 POINT (432750 5342030) ## 8 POINT (434410 5340670) ## 9 POINT (436050 5339850) ## 10 POINT (438070 5343230) pre { max-height: 500px; overflow-y: auto; } pre[class] { max-height: 500px; } ## Reading layer `roads&#39; from data source ## `C:\\Users\\tgood.stu\\Documents\\R\\win-library\\4.0\\sgsR\\extdata\\roads.shp&#39; ## using driver `ESRI Shapefile&#39; ## Simple feature collection with 167 features and 36 fields ## Geometry type: MULTILINESTRING ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438560 ymax: 5343240 ## Projected CRS: UTM_Zone_17_Northern_Hemisphere "],["calc.html", "calculate_* functions", " calculate_* functions A total of 7 calculate functions currently exist in the package: calculate_distance - per pixel distance to closes access vector calculate_pcomp- calculate principal components on input mraster calculate_reqSamples - calculate the number of samples needed for represntative sample within a sraster calculate_ahels - appy the adapted Hypercube Evaluation of a Legacy Sample (ahels) algorithm to existing samples calculate_coobs - apply count of observations algorithm to existing samples calculate_lhsPop - calculate population covariate statistics for latin hypercube sampling calculate_lhsOpt - calculate optimal latin hypercube sampling paramters including sample number "],["references.html", "References", " References "]]
