[["index.html", "Structurally Guided Sampling Overview", " Structurally Guided Sampling Tristan Goodbody 2021-07-27 Overview This document is a current summary and explaination of the structurally guided sampling (sgsR) project being undertaken by Dr. Tristan R.H. Goodbody and Dr. Nicholas C. Coops at the IRSS Lab at the UBC Faculty of Forestry. Herein we provide a: Literature review about SGS Describe package fundamentals Overview of stratification algorithms Overview of sampling algorithms Overview of calculate algorithms To install the package from the github please run the following. install.packages(&quot;devtools&quot;) devtools::install_github(&quot;https://github.com/tgoodbody/sgsR&quot;, build_vignettes = FALSE) library(sgsR) "],["SGS.html", "Structurally Guided Sampling Review Stratification approaches", " Structurally Guided Sampling Review (McRoberts, Gobakken, and Næsset 2012) outline the essence of structurally guided sampling: Stratified estimation is a statistical technique that can be used to increase the precision of estimates without increasing sample sizes. The essence of stratified estimation is to aggregate observations of the response variable into groups or strata that are more homogeneous than the population as a whole. The population mean and its variance are estimated as weighted means ofwithin-strata means and variances where the weights are based on strata sizes. If the stratification is accomplished prior to sampling and the within-stratum variances are known or can be easily estimated, then greater precision may be achieved by selecting within-strata sampling intensities to be proportional to within-strata variances (Cochran, 1977). Following literature review I present a number of implementations that have been used to guide the stratification of ALS-derived structural variables for locating representative sample plots. Studies including (Leiterer et al. 2015) and (Kane et al. 2010) suggest that the information in the ALS data may be condensed to a few metrics. Many of the studies reviewed seem to adopt this by selecting a low number of metrics which they use to stratify the landscape and consequently sample within.(Fedrigo et al. 2018) further outlined: Lidar metrics may be useful for forest stand classification if they differentiate classes of interest (Wulder et al., 2008). The separation of the data into vertical layers allows metrics to be derived for specific forest strata, which may increase the discrimination of multi-strata stand types. The selection of breaks that define these strata can be based on field knowledge or identified statistically from lidar profiles (Lefsky et al., 1999; Zhang et al., 2011). An additional note of interest is that a great deal of research in the field of digital soil mapping can be applied to structurally guided sampling. Studies including (Carré, McBratney, and Minasny 2007), (Ma et al. 2020), and (Malone, Minansy, and Brungard 2019) were invlauable for understanding how to use auxillary variables to determine effective sampling protocols - especially in the context of Lahin Hypercube Sampling. Stratification approaches (Hawbaker et al. 2009) Used ALS mean and SD to stratify. First they separated forest types then 10 strata were derived suing mean height. Within each stratum, 3 additional sub-strata were created using SD. This produced a total of 30 stratifications where one coniferous forest and two deciduous forest locations randomly selected. They compared samples taken from strata with a random sample finding that: &gt;Prediction errors from models constructed using a random sample were up to 68% larger than those from the models built with a stratified sample. The stratified sample included a greater range of variability than the random sample. (Dalponte et al. 2011) They analyzed 2 aspects of ground reference data collection. The positioning error of the ground plots The optimal number of training plots. They had a large collection of samples &gt;700 and systematically analyzed how the reduction of sample numbers influenced accuracy of attribute estimates. They tested the effect of error in estimate related to distance the center point of the plot was moved. The decrease was at a minimum when the displacement was less than 5 m, while it was considerable over 10 m. They did random downsampling of the sample plot number and stratified downsampling of the sample plot number. They used the methods from (Hawbaker et al. 2009) and (Maltamo et al. 2011) for stratified downsampling. Comparing the results obtained with the proposed stratified sampling method and the other three methods considered (see Table 3), one can see that the proposed stratified sampling method was the one that provided the best results for both sets. The new protocol allowed us to obtain promising results for the considered dataset: using only 53 training plots, instead of 534 in the original dataset, we obtained the same results for the validation set. (Maltamo et al. 2011) Used divided P90 into 12 even parts. A near equal number of sample plots were systematically chosen within each of these 12 parts according to the range of VEG (ratio of vegetation points and ground points). To representatively sample the 12 parts and to cover the extremes, selection intensity was higher in the p90 range range with the lowest number of previously established plots. The use of ALS data as a priori information provided the most accurate results. They also provide the an important statement: One should keep in mind that in real world applications ,some given ALS variables will have to be used for selection of plots regardless of which and how many biophysical properties the inventory aims at estimating. Thus, some ALS variables will work better for certain biophysical properties than for others. An appropriate way of choosing suitable ALS variables could be to select them according to the relative importance of the biophysical properties to be estimated.for volume and number of stems. plots. REduced total sample size incrementally. (Junttila et al. 2013) Used a number of approaches including a space filling design, which attempts to sample uniformly across a feature space. The Maximin design attempts to cover a feature space as uniformly as possible given a fixed number of sample points. It maximizes the minimum distance between plots. The results indicate that choosing the plots in a way that ensures ample coverage of both spatial and feature space variability improves the performance of the corresponding models, and that adequate coverage of the variability in the feature space is the most important condition that should be met by the set of plots collected. (Valbuena et al. 2013) Used the Cover metric to privde a idea of the density of each forest area. The justified that cover influenced the relation between other metrics and the forest response and, therefore, it was included in all the models computed. (Grafström and Ringvall 2013) Presents the (Grafström and Lisic 2019) package. and does comparisons between Simple random sampling (SRS) and: Local pivotal method with x and y coordinates (LPM-xy) to make sure the sample is well spread geographically. The Euclidean distance is used without standardization because the spatial coordinates are on the same scale. Local pivotal method (LPM) XY and four selected ALS variables as auxiliary variables. The samples are well spread geographically and well spread in the four ALS variables. The distance function (eq. (3)) is used. Cube method (CM) The samples are balanced on the four ALS variables. The x and y coordinates are not used for this method, because it does not make sense to balance on geographical coordinates. Local cube method (LCM) The samples are balanced on the four ALS variables and the x and y coordinates are used to make sure the sample is well spread geographically. The Euclidean distance is used in the geographical space. They found that spreading the sample well in geographical space is important. Spreading the sample well in all auxiliary variables (LPM) and using the HT estimator was in all cases a more efficient strategy than SRS followed by a calibration estimator. Spreading the sample well is more efficient than balancing (or SRS followed by calibration) if the relationship between the target and the auxiliary variables is nonlinear, which is why it performs better (see Tables 2 and 3). The final order of the designs combined with the calibration estimator was (from best to worst) LCM, LPM, LPM-xy, CM, and SRS. We get the best results when using the information both in the design and the estimator. Hence, we can conclude that using auxiliary information in the design is very important. \" All three designs, LCM, LPM, and CM, had very good design effects. The reduction of the variance of the HT estimator was for the main target variable volume up to 75% compared with SRS. (Grafström, Saarela, and Ene 2014) Continuation of previous study highlighting value of sampling methods. A possible drawback of the LPM compared with more simple methods such as systematic random sampling is that sample se- lection is computationally intensive for large populations. This is a problem because the population size (number of pixels) tends to be rather large in forest applications with auxiliary data from, e.g., airborne LiDAR, making it practically impossible to apply the LPM as it is. To deal with this problem, we introduce a new rapid suboptimal implementation ofthe LPM that can be applied to large populations. With the LPM, there is no stratification or other difficult design choices; we only need to define distance. Modelling is not really necessary, which means no complicated formulas. Yet this is a very competitive strategy in many cases. It has the advantage of being intuitive and simple, which should not be underrated. It also allows us to keep the traditional design-based approach, while still taking advantage of powerful auxiliary information. With the LPM, there is no stratification or other difficult design choices; we only need to define distance. Modelling is not really necessary, which means no complicated formulas. Yet this is a very competitive strategy in many cases. It has the advantage of being intuitive and simple, which should not be underrated. It also allows us to keep the traditional design-based approach, while still taking advantage of powerful auxiliary information. (Niemi and Vauhkonen 2016) Used ALS textural CHM metrics (HIST,PATCH,GLCM,LBP) for pre-stratification of the inventory area. They tested the strength of the relationship between metrics and central attributes of forest growing stock (Vol,BA,Diam). It was found that the dispersion of the clusters derived in an unsupervised mode could be used as an indicator for prioritizing the plots to be measured as the sample to form the reference data for the wall-to-wall models. (Valbuena et al. 2017) Used a rule based method to stratify forest areas using Lmoments including Lcv and Lskew. (McRoberts, Chen, and Walters 2017) Modeling inventory attributes with ALS metrics. BA was considered as an integrator of all the response variables and was used as the basis for constructing strata using a lonear model. Predictions of BA were then scaled by the largest BA prediction,multiplied by 100, then assigned 1 of 100 potential strata. Strata were then aggregated these into 4,6,8 strata with approximately equal proportion of study area. Stratifications that are most effective with respect to minimizing variances are based on variables that are closely related to the response variable or variables of interest. When multiple response variables are to be estimated simultaneously, the same stratification must be used for all response variables to ensure compatibility. Results showed they were able to: &gt;Reduce sampling intensity by up to 35% without losing accuracy in the estimators. Relative to the simple random sampling estimators that used no stratification, use of four strata decreased SEs by 29.0%38.1%, depending on the response variable; relative to four strata, use of six strata reduced SEs by 2.3%7.3%; and relative to six strata, use of eight strata reduced SEs by no more than 4% and for two response variables actually increased SEs. From an operational perspective, the results of the study suggest that multivariate, airborne laser scanning-assisted inventories could be fairly easily implemented, subject to availability of the airborne laser scanning data. (Malone, Minansy, and Brungard 2019) They provide an indepth description of how to implement and improve the outputs of Latin Hypercube sampling, providing a coded example of how to incorporate already acquired samples accross the landscape. They specify a method to boostrap sample size followed by the application of multiple methods to determine the optimal sample number to use based on auxillary data. (Papa et al. 2020) Compared simple random sampling to stratified sampling within strata groups. Used hierarchical cluster analysis for formation of strata. Clusters were used for sub-sampling. The number of clusters was established by the Elbow method. Clusters were validated with an ANOVA post-hoc Tukey test. Varying size of metric cells (1, 0.5, 0.25 ha) were tested. The stratified sampling was simulated by using weighting distributed by strata, so that each segment was the same sample size, whereas no weighting was used for the simulation in the case of the simple random sampling. For each level of sampling size (number of plots in the inventory), 1000 iterations were performed, and their mean and standard deviation were summarized in order to produce a graph of relative uncertainty (standard error/global mean) as a function of sample intensity (proportion of total area sampled, in %). (Ma et al. 2020) They compare latin hypercube sampling and feature space coverage sampling for predicting soil classes. They detail specific functions to use for latin hypercube sampling and feature space coverage sampling. Sampling pools of varying sizes are compared to simple random sampling in a number of modeling approaches. Final results indicated that: 1)In both study areas the median overall accuracy with FSCS washigher than those with CLHS and SRS over all sample sizes and crossall three prediction methods. The median overall accuracy with CLHS was only marginally larger than with SRS. 2)There was a significant negative correlation betweenMSSSDandoverall accuracy, whereas no such correlation was found betweenO1 + O3and overall accuracy.The coefficient of variation in overall accuracy among samples se-lected using FSCS was smaller than these using CLHS and SRS at thesame sample sizes. 3)With CLHS the variation in overall accuracy among samples waslarge, so that there is a serious risk that a particular sample mightlead to a low overall accuracy. 4)FSCS-RF is the most accurate combination of sampling and predic-tion for both study areas Results indicated that feature space coverage sampling could be a viable method for locating samples. pre { max-height: 500px; overflow-y: auto; } pre[class] { max-height: 500px; } References "],["fund.html", "sgsR fundamentals Algorithm structure Example data Stratified rasters - sraster", " sgsR fundamentals Algorithm structure sgsR has been scripted primarily using the terra package for raster processing and the sf package for vector manipulation. There are 3 primary function verbs that the package currently uses: strat_* - The stratify verb implies that functions are applying stratification algorithms to an input metrics raster (mraster) and output a stratified raster (sraster) sample_* - The sample verb implies that functions are extracting samples from srasters produced from strat_* functions. A few algorithms (e.g. sample_srs, sample_balanced, sample_grid) are able to take mrasters as inputs as they are not dependent on stratified inputs for sampling. calculate_* - The calculate verb implies that functions are performing calculations to be used in consequent processing. The use of predefined sample analysis algorithms (calculate_ahels, calculate_coobs) are also included. Package Documentation I do not go into detail about the intricacies of each function in this document. Please see the documentation for functions e.g. ?sgsR::strat_kmeans for intended application and use of each function. Example data Worked examples of all functions are provided using data internal to the package. To load internal mraster and road access data we use the following code. Follow along on your own machine to see more outputs and get a better sense of how the package functions. Metrics rasters - mraster library(sgsR) library(terra) library(sf) #--- Load mraster and access files ---# r &lt;- system.file(&quot;extdata&quot;, &quot;wall_metrics_small.tif&quot;, package = &quot;sgsR&quot;) #--- load the mraster using the terra package ---# mraster &lt;- terra::rast(r) Road access data a &lt;- system.file(&quot;extdata&quot;, &quot;roads.shp&quot;, package = &quot;sgsR&quot;) #--- load the access vector using the sf package ---# access &lt;- sf::st_read(a) ## Reading layer `roads&#39; from data source ## `C:\\Users\\tgood.stu\\Documents\\R\\win-library\\4.0\\sgsR\\extdata\\roads.shp&#39; ## using driver `ESRI Shapefile&#39; ## Simple feature collection with 167 features and 36 fields ## Geometry type: MULTILINESTRING ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438560 ymax: 5343240 ## Projected CRS: UTM_Zone_17_Northern_Hemisphere terra::plot(mraster[[1]]) terra::plot(access, add = TRUE, col = &quot;black&quot;) From the plot we see the first band (zmax) of the mraster with the access vector overlaid. Stratified rasters - sraster For the purposes of this tutorial I am also going to show how to produce a basic sraster and existing sample data that we will used in examples below. To make the sraster we will use the strat_kmeans function where the input mraster will be stratified using a kmeans algorithm. #--- apply kmeans algorithm to metrics raster ---# sraster &lt;- strat_kmeans(mraster = mraster, nStrata = 4, # algorithm will produce 4 strata plot = TRUE) # algorithm will plot output After the sraster is produced we apply the sample_srs algorithm which randomly samples points within our sraster to produce an existing sample dataset. #--- set seed ---# set.seed(2021) #--- apply kmeans algorithm to metrics raster ---# existing &lt;- sample_srs(raster = mraster, # use sraster as input for sampling nSamp = 200, # request 200 samples be taken mindist = 100, # define that samples must be 100 m apart plot = TRUE) # algorithm will plot output We now have mraster, access, sraster and existing data sets generated. Expect to see these data used in the all examples in this document. pre { max-height: 500px; overflow-y: auto; } pre[class] { max-height: 500px; } ## Reading layer `roads&#39; from data source ## `C:\\Users\\tgood.stu\\Documents\\R\\win-library\\4.0\\sgsR\\extdata\\roads.shp&#39; ## using driver `ESRI Shapefile&#39; ## Simple feature collection with 167 features and 36 fields ## Geometry type: MULTILINESTRING ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438560 ymax: 5343240 ## Projected CRS: UTM_Zone_17_Northern_Hemisphere "],["strat.html", "strat_* functions strat_kmeans strat_pcomp strat_breaks strat_quantiles strat_osb", " strat_* functions Fundamental to many structurally guided sampling approaches is the use of stratification methods that allow for more effective and representative sampling protocols. Below I define the stratification methods that are included thus far in sgsR and provide some worked examples for each. A total of 5 strat functions currently exist in the package: strat_kmeans - kmeans stratification strat_pcomp- principal component stratification strat_breaks - user-defined break stratification strat_quantiles - quantile stratification strat_osb - optimum sample boundary stratification strat_kmeans We provide a preliminary example of the strat_kmeans algorithm to prepare our sraster input data but here are a few more. #--- perform stratification using k-means ---# strat_kmeans(mraster = mraster, # input nStrata = 5) # algorithm will produce 4 strata ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 5 Plot Notice that nothing plotted Thats because plot = FALSE is the default for all functions in sgsR. See examples below where plot = TRUE. strat_kmeans(mraster = mraster, # input nStrata = 10, # algorithm will produce 10 strata iter = 1000, # set minimum number of interations to determine kmeans centers algorithm = &quot;MacQueen&quot;, # use MacQueen algorithm plot = TRUE, # plot output details = TRUE) # output details - kmeans stratification data and output sraster ## $details ## K-means clustering with 10 clusters of sizes 8460, 8175, 14401, 7390, 9868, 10001, 7523, 3621, 12801, 8955 ## ## Cluster means: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 ## 1 -1.61845760 -2.21644419 -1.63846390 -0.99047251 -1.1864738 -1.50396615 -1.6459599 ## 2 -1.18115418 -0.21578917 -1.08949828 -0.75875943 -0.9150003 -1.13205186 -1.2044319 ## 3 0.26583212 0.56153588 0.07272645 0.21463824 0.2881727 0.27517550 0.2418837 ## 4 1.39721946 0.62354818 0.34114940 1.80773962 1.7801397 1.35336933 1.1818874 ## 5 0.01721191 0.01098153 0.83805005 -0.56628465 -0.5185618 -0.04843908 0.2166482 ## 6 0.79331356 0.77058735 -0.19524776 1.43253552 1.1557104 0.73536980 0.5871320 ## 7 -0.94287627 -1.41892604 -0.28918661 -0.86547692 -0.9795565 -1.00411311 -0.9013863 ## 8 1.76150865 0.69261341 1.83496281 0.75707447 1.2237326 1.80930765 1.9196920 ## 9 -0.52954681 0.28400209 -0.29233160 -0.47235346 -0.5335791 -0.54493965 -0.5043006 ## 10 0.95859014 0.50659987 1.35742129 -0.08826613 0.3952886 1.01793988 1.0976238 ## zq90 zq95 l_1 l_2 t_3 t_4 ## 1 -1.8468352 -1.9020831 -0.1781397 -1.18860515 -0.3617194 -2.20193918 ## 2 -1.2349361 -1.1929623 2.2901169 -1.10283325 -0.3604030 -0.10722060 ## 3 0.2056615 0.2189552 -0.4672981 0.84913943 -0.3165150 0.53656536 ## 4 0.9664822 0.8654981 -0.8835024 0.29909510 0.3395034 0.50972172 ## 5 0.4737554 0.5242885 0.1305378 0.04956952 -0.2194533 0.02085024 ## 6 0.4388289 0.4221690 -0.8717392 1.79501743 -0.2659370 0.72264588 ## 7 -0.6156040 -0.5435200 0.1293558 -0.98909181 -0.3531697 -1.39820377 ## 8 1.7151428 1.5461441 -0.5843340 -0.40512452 4.0847632 0.67617048 ## 9 -0.4021585 -0.3306150 0.6143076 -0.45100988 -0.3565298 0.34255658 ## 10 1.1301770 1.0744401 -0.3625802 0.09744738 0.5930486 0.47607905 ## ## Clustering vector: ## [1] 9 7 5 3 7 9 5 9 3 3 3 4 10 10 8 8 8 4 6 4 4 10 10 10 3 10 5 ## [28] 5 10 5 4 3 5 10 4 5 1 5 10 4 10 4 10 10 4 4 10 4 4 10 4 4 10 4 ## [55] 10 2 2 5 5 3 3 3 3 5 3 1 7 2 2 2 2 2 2 2 2 2 2 2 2 2 2 ## [82] 2 1 2 2 2 2 2 2 2 2 2 9 7 5 9 2 9 2 2 2 2 2 2 2 2 2 1 ## [109] 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 7 1 1 2 2 2 2 ## [136] 2 2 2 2 2 2 1 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 ## [163] 2 2 7 5 5 5 10 8 8 10 5 10 3 5 9 9 5 9 9 9 9 9 9 2 9 9 9 ## [190] 7 9 9 9 9 9 2 9 9 5 6 6 6 6 6 5 6 6 6 6 6 5 10 3 3 5 3 ## [217] 3 3 3 5 3 10 5 5 2 7 7 6 6 6 6 3 3 3 9 2 2 2 2 7 7 3 5 ## [244] 6 3 4 4 8 4 4 6 3 4 6 4 3 6 6 8 6 4 10 3 8 4 8 8 10 5 10 ## [271] 10 8 8 8 10 2 1 1 1 1 1 2 7 5 5 5 7 1 1 1 1 1 1 1 1 1 1 ## [298] 1 1 1 1 7 7 9 9 9 6 6 6 3 6 6 4 6 6 10 5 3 4 5 5 10 5 8 ## [325] 5 3 7 7 7 9 7 5 9 3 4 10 10 4 4 4 4 4 4 6 6 4 10 10 10 10 10 ## [352] 5 10 10 4 3 10 10 5 3 3 3 3 7 1 4 10 4 10 4 10 4 10 10 4 10 10 4 ## [379] 4 5 9 3 3 5 3 3 3 3 3 7 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 ## [406] 2 2 2 2 2 2 2 2 2 2 2 2 9 2 2 9 2 2 2 2 2 7 5 5 5 5 2 ## [433] 7 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 7 2 1 2 2 2 ## [460] 2 1 2 2 2 9 2 2 2 1 1 2 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 ## [487] 2 2 2 9 5 5 5 10 5 10 10 10 10 3 9 9 5 5 5 5 7 7 9 9 7 7 7 ## [514] 5 9 9 9 9 2 9 3 5 5 4 6 3 3 6 6 6 6 6 3 6 6 5 10 5 3 3 ## [541] 9 3 3 6 10 4 10 5 5 9 3 9 9 9 3 3 5 2 3 3 9 2 2 2 7 5 3 ## [568] 7 4 4 5 4 3 6 6 3 4 4 7 6 6 6 3 10 10 8 8 7 5 8 10 10 4 4 ## [595] 10 8 8 10 5 1 1 1 2 2 2 2 2 5 7 1 1 1 1 1 7 1 1 1 1 1 1 ## [622] 1 1 1 7 9 9 9 3 6 6 4 3 6 4 3 6 6 10 10 5 5 3 5 4 5 8 9 ## [649] 3 3 9 5 9 9 9 5 4 4 4 4 4 4 10 4 6 6 6 6 4 10 10 10 3 10 5 ## [676] 5 6 10 10 5 10 10 4 3 3 9 3 5 7 1 1 1 5 10 10 4 10 10 10 10 8 4 ## [703] 8 5 5 4 4 6 3 3 3 3 7 9 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 ## [730] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 5 9 2 2 2 9 9 2 ## [757] 1 1 1 1 1 1 1 7 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 ## [784] 1 2 2 2 2 2 2 2 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 ## [811] 2 7 5 5 5 10 8 8 10 10 10 10 9 9 9 5 5 5 5 7 1 7 9 9 7 7 7 ## [838] 7 2 9 9 9 9 9 3 3 10 4 8 5 6 6 6 6 6 6 3 10 5 3 3 3 3 5 ## [865] 9 9 5 10 10 4 4 10 5 9 9 9 9 2 9 3 2 7 3 9 9 7 1 1 1 1 7 ## [892] 7 3 3 6 3 6 6 6 6 6 6 6 6 6 6 3 10 10 8 8 9 7 8 8 10 10 10 ## [919] 8 8 8 2 2 1 1 1 1 2 2 2 2 1 1 7 1 1 1 7 1 1 1 1 1 1 1 ## [946] 1 1 1 7 9 9 9 5 3 3 6 3 4 4 4 3 3 3 5 5 5 5 5 5 5 5 5 ## [973] 9 3 10 3 9 3 3 5 6 6 4 4 10 10 4 4 4 6 6 6 6 10 10 4 4 10 10 ## [1000] 5 ## [ reached getOption(&quot;max.print&quot;) -- omitted 90195 entries ] ## ## Within cluster sum of squares by cluster: ## [1] 12158.85 17930.08 20050.11 18795.73 21479.44 13944.26 19130.48 25280.81 20918.38 ## [10] 26772.76 ## (between_SS / total_SS = 83.4 %) ## ## Available components: ## ## [1] &quot;cluster&quot; &quot;centers&quot; &quot;totss&quot; &quot;withinss&quot; &quot;tot.withinss&quot; ## [6] &quot;betweenss&quot; &quot;size&quot; &quot;iter&quot; &quot;ifault&quot; ## ## $raster ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 10 strat_kmeans(mraster = mraster, # input nStrata = 5, # algorithm will produce 4 strata center = FALSE, # do not center data scale = FALSE, # do not scale data plot = TRUE, # plot output filename = tempfile(fileext = &quot;.tif&quot;), # write output sraster to file overwrite = TRUE) # overwrite file on disc if it exists ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 5 strat_pcomp The strat_pcomp algorithm calculates principal components on the input mraster then divides data into equal sized strata. Strata can be defined by using the primary (PC1) only (nStrata), or primary &amp; secondary (PC2 - nStata2) principal components. If nStata2 is defined, PC2 is used and the total number of strata will be \\[nStrata * nStrata2\\]. strat_pcomp(mraster = mraster, # input nStrata = 5, # 5 strata with primary PC only plot = TRUE) # plot ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 5 strat_pcomp(mraster = mraster, # input nStrata = 4, # 4 strata with primary nStrata2 = 4, # 4 strata with secondary PC - will produce 16 output strata plot = TRUE, # plot details = TRUE) # produce output details ## $details ## Standard deviations (1, .., p=13): ## [1] 2.93647150 1.26882709 1.15691535 0.86852611 0.53076565 0.42304219 0.35679023 ## [8] 0.21988261 0.14290118 0.09666573 0.07179753 0.05016994 0.02570635 ## ## Rotation (n x k) = (13 x 13): ## PC1 PC2 PC3 PC4 PC5 PC6 ## zmax 0.3359531 0.01817295 -0.085980156 0.04883369 -0.16446975 0.134888577 ## zmean 0.2692352 -0.14320556 0.484261417 0.08715503 0.10021008 0.208524587 ## zsd 0.2525172 0.46307645 0.056280928 -0.35189237 -0.05790180 -0.047159024 ## pzabove2 0.2575694 -0.38512031 -0.153689213 0.33477151 -0.20262484 -0.504470621 ## zq20 0.2957809 -0.25072438 -0.163557453 0.28595035 -0.26718846 -0.008654979 ## zq50 0.3271212 0.02248762 -0.100221327 0.07934796 -0.16569646 0.420247325 ## zq70 0.3296060 0.11882609 -0.062083857 -0.02690735 -0.12986291 0.271021251 ## zq90 0.3192555 0.21122345 0.009465806 -0.18799597 -0.09477864 -0.264930469 ## zq95 0.3091490 0.21445676 0.055153306 -0.23449020 -0.07471056 -0.451270472 ## l_1 -0.1885162 0.18294540 0.614448790 0.27802959 -0.27135857 -0.287232900 ## l_2 0.2327722 -0.43278499 0.060836142 -0.34982009 0.57978716 -0.188355371 ## t_3 0.1690462 0.45853939 -0.166263397 0.60467076 0.59765870 -0.091199035 ## t_4 0.2561467 -0.13145011 0.527861021 0.09849843 0.14573821 0.177036168 ## PC7 PC8 PC9 PC10 PC11 ## zmax -0.15339832 0.0308922302 -1.886049e-02 0.0560186614 -0.1278804649 ## zmean 0.28510651 -0.0021690322 2.826642e-02 0.0270039439 0.0675442390 ## zsd -0.05015151 0.1340537231 3.445926e-01 -0.0513256272 0.6681251318 ## pzabove2 0.11141535 0.5392526124 -2.020873e-02 0.0120286554 0.2179924264 ## zq20 -0.08550919 -0.6885132239 3.627060e-01 -0.1271545992 0.1378591128 ## zq50 -0.29668394 0.0329045573 -5.353496e-01 0.4057583148 0.2063460374 ## zq70 -0.22963234 0.3370366252 1.490613e-01 -0.5945209546 -0.4103363124 ## zq90 0.08153534 -0.0006831206 3.087370e-01 0.5970060214 -0.4980350813 ## zq95 0.21011887 -0.3114508486 -5.847183e-01 -0.3194796103 -0.0758389467 ## l_1 -0.56400277 -0.0188834161 -2.142108e-02 0.0060754571 -0.0313981609 ## l_2 -0.50772612 -0.0466621166 2.094108e-02 0.0009527472 0.0201177308 ## t_3 -0.03067072 -0.0310296725 7.516919e-05 -0.0011560670 0.0009191501 ## t_4 0.32336804 0.0324261270 3.474720e-02 -0.0238296876 -0.0055552525 ## PC12 PC13 ## zmax -0.0052115172 0.8873685582 ## zmean -0.7236917619 -0.0162558333 ## zsd 0.0295065391 0.0098559868 ## pzabove2 -0.0004334086 -0.0531021769 ## zq20 0.0390001016 -0.1416169733 ## zq50 0.0609622299 -0.2923086818 ## zq70 -0.0257022931 -0.2670379822 ## zq90 -0.0047718481 -0.1800345902 ## zq95 -0.0171556239 -0.0045593830 ## l_1 -0.0077753523 0.0029767582 ## l_2 -0.0003045197 -0.0008875782 ## t_3 -0.0216941448 -0.0022824635 ## t_4 0.6845626123 0.0117767342 ## ## $raster ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 16 ## ## $plot strat_pcomp(mraster = mraster, # input nStrata = 3, # 3 strata with primary PC nStrata2 = 3, # 4 strata with secondary PC - will produce 9 output strata filename = tempfile(fileext = &quot;.tif&quot;)) # write output sraster to file ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 9 strat_breaks The strat_breaks function stratifies data based on user-defined breaks in covariates. A single metric can be defined or an additional metric2 can be supplied. breaks and breaks2 correspond to the user-defined breaks for metric and metric2 respectively. #--- define vector breaks ---# br.max &lt;- c(3, 5, 11, 18) #zmax breaks br.sd &lt;- c(1, 2, 5) #zsd breaks Once the breaks have been created we can input them into the function using the breaks and breaks2 parameters. strat_breaks(mraster = mraster, # input metric = &quot;zmax&quot;, # covariate of interest - numeric index or character string breaks = br.max, # breaks for primary covariate plot = TRUE, # plot details = TRUE) # output details ## $details ## $details$breaks ## [1] 3 5 11 18 ## ## $details$breaks2 ## NULL ## ## ## $raster ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 5 ## ## $plot strat_breaks(mraster = mraster, # input metric = 1, # primary covariate of interest - numeric index or character string metric2 = &quot;zsd&quot;, # secondary covariate of interest - numeric index or character string breaks = br.max, # breaks for primary covariate breaks2 = br.sd, # breaks for secondary covariate plot = TRUE) # plot ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 16 strat_quantiles The strat_quantiles function stratifies data into the user-defined number of quantiles (nQuant). A single metric can be defined or an additional metric2 can be supplied. nQuant and nQuant2 correspond to the desired number of quantiles for metric and metric2 respectively. If nQuant2 is defined, the total number of strata will be \\[nStrata = nQuant * nQuant2\\] strat_quantiles(mraster = mraster, # input metric = 4, # primary covariate of interest - numeric index or character string nQuant = 10, # number of quantiles for primary covariate plot = TRUE) # plot ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 10 strat_quantiles(mraster = mraster, # input metric = &quot;zsd&quot;, # primary covariate of interest - numeric index or character string metric2 = &quot;zq95&quot;, # secondary covariate of interest - numeric index or character string nQuant = 3, # number of quantiles for primary covariate nQuant2 = 4, # number of quantiles for secondary covariate plot = TRUE) # plot ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 12 strat_quantiles(mraster = mraster, # input metric = 1, # primary covariate of interest - numeric index or character string metric2 = &quot;zsd&quot;, # secondary covariate of interest - numeric index or character string nQuant = 2, # number of quantiles for primary covariate nQuant2 = 2, # number of quantiles for secondary covariate filename = tempfile(fileext = &quot;.tif&quot;)) # write output sraster to file ## class : SpatRaster ## dimensions : 277, 373, 1 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## source : memory ## name : strata ## min value : 1 ## max value : 4 strat_osb The strat_osb algorithm implements the optimum sample boundaries algorithm implmented in the stratifyR package. For further details about the algorithms used check out their package and also consult ?sgsR::strat_osb for references. The basics of this algorithm are to provide the number of desired strata nStrata and samples nSamp. The algorithm then analyzes the data for the optimal locations to establish breaks in the covariate metric, which are used as stratum boundaries. This function can take a bit longer to run so please be patient! For the purpses of this example I have used a limited number of nStrata and nSamp to ensure they run and render quickly. #--- perform optimum sample boundary stratification ---# strat_osb(mraster = mraster, # input metric = &quot;zsd&quot;, # covariate of interest - numeric index or character string nSamp = 50, # number of desired samples nStrata = 3, # number of desired strata plot = TRUE) # plot strat_osb(mraster = mraster, # input metric = 4, # covariate of interest - numeric index or character string nSamp = 25, # number of desired samples nStrata = 3, # number of desired strata plot = TRUE, # plot details = TRUE) # produce output details strat_osb(mraster = mraster, # input metric = &quot;zmax&quot;, # covariate of interest - numeric index or character string nSamp = 50, # number of desired samples nStrata = 3, # number of desired strata subset = 0.75, # used a subset of covariate data to determine optimum breaks filename = tempfile(fileext = &quot;.tif&quot;)) # write output sraster to file pre { max-height: 500px; overflow-y: auto; } pre[class] { max-height: 500px; } ## Reading layer `roads&#39; from data source ## `C:\\Users\\tgood.stu\\Documents\\R\\win-library\\4.0\\sgsR\\extdata\\roads.shp&#39; ## using driver `ESRI Shapefile&#39; ## Simple feature collection with 167 features and 36 fields ## Geometry type: MULTILINESTRING ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438560 ymax: 5343240 ## Projected CRS: UTM_Zone_17_Northern_Hemisphere "],["sample.html", "sample_* functions Access sample_srs sample_grid sample_strat sample_clhs sample_balanced", " sample_* functions A total of 5 sample functions currently exist in the package: sample_srs - simple random sampling sample_grid- grid sampling sample_strat - stratified sampling within a sraster sample_clhs - Latin hypercube sampling algorithm sample_balanced - Balanced sampling (Grafström and Lisic 2019) Access A feature of the sample_* functions that may be of interest is the ability to define access. Users can supply a road access network (must be sf line objects) and define buffers around access where samples should be excluded and included. Important additional parameters when access is provided are: buff_inner - An inner buffer that defines the distance from access where samples cannot be takes (i.e. if you do not want samples within 50 m of your access layer set buff_inner = 50). buff_outer - Maximum distance samples can be located from access (i.e. if you dont want samples more than 200 meters from a road set buff_inner = 200) sample_srs We provided a very simple example of using the sample_srs function when we were preparing our existing data. We provide some additional examples below. Input raster Notice that the input for sample_srs is raster. This means that either an sraster or an mraster can be supplied. #--- perform simple random sampling ---# sample_srs(raster = sraster, # input sraster nSamp = 200, # number of desired samples plot = TRUE) # plot ## Simple feature collection with 200 features and 0 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337710 xmax: 438410 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## geometry ## 1 POINT (437450 5338550) ## 2 POINT (433670 5341230) ## 3 POINT (433430 5339390) ## 4 POINT (431990 5338590) ## 5 POINT (438370 5341450) ## 6 POINT (432190 5342430) ## 7 POINT (433510 5339250) ## 8 POINT (436250 5342930) ## 9 POINT (436730 5339650) ## 10 POINT (433590 5342070) sample_srs(raster = mraster, # input mraster nSamp = 200, # number of desired samples access = access, # define access road network mindist = 200, # minimum distance samples must be apart from one another buff_inner = 50, # inner buffer - no samples within this distance from road buff_outer = 200, # outer buffer - no samples further than this distance from road plot = TRUE) # plot ## Simple feature collection with 200 features and 0 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337730 xmax: 438510 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## geometry ## 1 POINT (432050 5342810) ## 2 POINT (434270 5338050) ## 3 POINT (437510 5338950) ## 4 POINT (432770 5340250) ## 5 POINT (432870 5340450) ## 6 POINT (433610 5340490) ## 7 POINT (436410 5341550) ## 8 POINT (434110 5338510) ## 9 POINT (433690 5342650) ## 10 POINT (435390 5338550) sample_srs(raster = sraster, # input nSamp = 200, # number of desired samples access = access, # define access road network buff_inner = 50, # inner buffer - no samples within this distance from road buff_outer = 200, # outer buffer - no samples further than this distance from road plot = TRUE, # plot filename = tempfile(fileext = &quot;.shp&quot;)) # write output samples to file ## Writing layer `filedfc47b22fd4&#39; to data source ## `C:\\Users\\tgood.stu\\AppData\\Local\\Temp\\RtmpSecUsn\\filedfc47b22fd4.shp&#39; using driver `ESRI Shapefile&#39; ## Writing 200 features with 0 fields and geometry type Point. ## Simple feature collection with 200 features and 0 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431230 ymin: 5337710 xmax: 438510 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## geometry ## 1 POINT (435330 5338970) ## 2 POINT (433550 5342670) ## 3 POINT (435030 5340430) ## 4 POINT (435910 5342370) ## 5 POINT (434330 5337930) ## 6 POINT (432470 5340870) ## 7 POINT (436430 5338370) ## 8 POINT (436530 5341710) ## 9 POINT (436470 5338170) ## 10 POINT (438510 5339170) sample_grid The sample_grid function applies regular grid sampling across an area where the gridsize parameter defines distance between samples. #--- perform grid sampling ---# sample_grid(raster = sraster, # input sraster gridsize = 200, # grid distance plot = TRUE) # plot ## Simple feature collection with 953 features and 1 field ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438500 ymax: 5343100 ## CRS: NA ## First 10 features: ## strata geometry ## 1 1 POINT (431100 5337700) ## 2 1 POINT (431300 5337700) ## 3 1 POINT (431500 5337700) ## 4 1 POINT (431700 5337700) ## 5 1 POINT (431900 5337700) ## 6 1 POINT (432100 5337700) ## 7 4 POINT (432300 5337700) ## 8 4 POINT (432500 5337700) ## 9 3 POINT (432700 5337700) ## 10 3 POINT (432900 5337700) sample_grid(raster = sraster, # input sraster gridsize = 100, # grid distance access = access, # define access road network buff_inner = 50, # inner buffer - no samples within this distance from road buff_outer = 200) # outer buffer - no samples further than this distance from road ## Simple feature collection with 1542 features and 1 field ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438500 ymax: 5343200 ## CRS: NA ## First 10 features: ## strata geometry ## 7 1 POINT (431700 5337700) ## 8 1 POINT (431800 5337700) ## 10 3 POINT (432000 5337700) ## 11 1 POINT (432100 5337700) ## 29 4 POINT (433900 5337700) ## 30 4 POINT (434000 5337700) ## 32 4 POINT (434200 5337700) ## 33 1 POINT (434300 5337700) ## 38 1 POINT (434800 5337700) ## 40 4 POINT (435000 5337700) sample_grid(raster = mraster, # input mraster gridsize = 200, # grid distance access = access, # define access road network buff_inner = 100, # inner buffer - no samples within this distance from road buff_outer = 400, # outer buffer - no samples further than this distance from road filename = tempfile(fileext = &quot;.shp&quot;), # write output samples to file plot = TRUE) # plot ## Writing layer `filedfc44d63f99&#39; to data source ## `C:\\Users\\tgood.stu\\AppData\\Local\\Temp\\RtmpSecUsn\\filedfc44d63f99.shp&#39; using driver `ESRI Shapefile&#39; ## Writing 506 features with 13 fields and geometry type Point. ## Simple feature collection with 506 features and 13 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438500 ymax: 5343100 ## CRS: NA ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 l_2 t_3 t_4 ## 3 10.54 91.1 3.60 5.330000 7.96 11.219999 12.40 15.26 18.52 5.7 52.9 0.3 86.8 ## 4 12.76 97.9 2.87 9.179999 10.38 12.759999 14.19 17.47 19.78 0.3 59.9 0.8 95.2 ## 6 14.99 95.5 3.47 9.620000 12.89 15.910000 17.03 18.92 19.71 1.1 22.9 0.5 89.9 ## 7 6.30 78.2 3.09 2.050000 2.88 6.440000 8.47 11.10 11.91 23.8 11.7 0.0 76.3 ## 14 6.01 26.9 2.92 1.810000 2.78 6.180000 7.96 10.37 12.31 7.8 2.2 0.0 26.3 ## 15 6.99 88.8 2.72 3.690000 4.77 6.760000 7.92 12.45 14.42 18.2 11.4 0.0 86.1 ## 17 8.82 82.8 3.31 4.580000 5.97 8.809999 10.66 14.34 15.75 8.1 26.8 0.0 76.2 ## 18 6.76 67.0 2.97 2.400000 3.74 7.020000 8.75 11.30 12.49 16.2 9.3 0.0 61.3 ## 19 7.83 87.8 1.85 5.380000 6.46 8.090000 8.90 10.38 11.09 5.5 7.6 0.0 76.9 ## 22 14.36 95.6 3.85 7.990000 12.67 15.469999 16.64 18.35 18.92 3.3 25.5 0.0 91.8 ## geometry ## 3 POINT (431500 5337700) ## 4 POINT (431700 5337700) ## 6 POINT (432100 5337700) ## 7 POINT (432300 5337700) ## 14 POINT (433700 5337700) ## 15 POINT (433900 5337700) ## 17 POINT (434300 5337700) ## 18 POINT (434500 5337700) ## 19 POINT (434700 5337700) ## 22 POINT (435300 5337700) sample_strat The sample_strat function contains a hierarchical sampling algorithm originally developed my Martin Queinnec. The algorithm uses a moving window (wrow and wcol parameters) to filter the input sraster for locations where stratum pixels are spatially grouped rather than dispersed individually across the landscape. The sampling is performed in 2 stages: Rule 1 - Sample within spatially grouped stratum pixels. Rule 2 - If no more samples exist to satisfy desired sampling count, individual stratum pixels are sampled. The rule applied to a select a particular sample is defined in the rule attribute of output samples. We give a few examples below: #--- perform stratified sampling random sampling ---# sample_strat(sraster = sraster, # input sraster nSamp = 200, # desired sample number plot = TRUE) # plot ## Simple feature collection with 200 features and 3 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431130 ymin: 5337770 xmax: 438510 ymax: 5343210 ## Projected CRS: UTM Zone 17, Northern Hemisphere ## First 10 features: ## strata type rule geometry ## x 1 new rule1 POINT (432550 5340370) ## x1 1 new rule1 POINT (432550 5340370) ## x2 1 new rule1 POINT (436510 5341690) ## x3 1 new rule1 POINT (432110 5339970) ## x4 1 new rule1 POINT (434090 5338010) ## x5 1 new rule1 POINT (431470 5341690) ## x6 1 new rule1 POINT (431450 5341010) ## x7 1 new rule1 POINT (431490 5341530) ## x8 1 new rule1 POINT (432470 5341790) ## x9 1 new rule1 POINT (435510 5341150) In some cases, a user may wish to include an existing sample dataset within the algorithm. In order to adjust the total number of samples needed per stratum to reflect those already present in existing, we can use the utility function extract_strata. This function takes an input sraster and the existing sample dataset and extracts the stratum for each sample. These samples can then be input into the sample_strat function which adjusts total required sample per class based on representation in existing. #--- extract strata values to existing samples ---# e.sr &lt;- extract_strata(sraster = sraster, # input sraster existing = existing) # existing samples to add strata value to e.sr ## Simple feature collection with 200 features and 1 field ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337730 xmax: 438490 ymax: 5343230 ## Projected CRS: UTM Zone 17, Northern Hemisphere ## First 10 features: ## strata geometry ## 1 4 POINT (432070 5340130) ## 2 4 POINT (435010 5342150) ## 3 4 POINT (437390 5338370) ## 4 2 POINT (437850 5342890) ## 5 4 POINT (434710 5342370) ## 6 1 POINT (432870 5340230) ## 7 4 POINT (435150 5340150) ## 8 1 POINT (431850 5338570) ## 9 4 POINT (432770 5342710) ## 10 1 POINT (436190 5341450) Existing strata Notice that e.sr now has an attribute named strata. If that parameter is not there, sample_strat will give an error. sample_strat(sraster = sraster, # input sraster nSamp = 200, # desired sample number access = access, # define access road network existing = e.sr, # existing samples with strata values mindist = 200, # minimum distance samples must be apart from one another buff_inner = 50, # inner buffer - no samples within this distance from road buff_outer = 200, # outer buffer - no samples further than this distance from road plot = TRUE) # plot ## Simple feature collection with 400 features and 3 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337730 xmax: 438530 ymax: 5343230 ## Projected CRS: UTM Zone 17, Northern Hemisphere ## First 10 features: ## strata type rule geometry ## 6 1 existing existing POINT (432870 5340230) ## 8 1 existing existing POINT (431850 5338570) ## 10 1 existing existing POINT (436190 5341450) ## 11 1 existing existing POINT (438230 5341170) ## 14 1 existing existing POINT (431170 5339890) ## 15 1 existing existing POINT (434450 5340070) ## 17 1 existing existing POINT (434930 5339010) ## 19 1 existing existing POINT (438470 5338890) ## 23 1 existing existing POINT (435290 5337850) ## 27 1 existing existing POINT (431110 5338050) mindist The mindist parameter defined in the above example specifies the minimum euclidian distance that samples must be apat from one another. Notice that the sample outputs have type and rule attributes which outline whether samples are existing or new and whether rule1 or rule2 were used to select individual samples. sample_strat(sraster = sraster, # input nSamp = 200, # desired sample number access = access, # define access road network existing = e.sr, # existing samples with strata values include = TRUE, # include existing plots in nSamp total buff_inner = 50, # inner buffer - no samples within this distance from road buff_outer = 200, # outer buffer - no samples further than this distance from road filename = tempfile(fileext = &quot;.shp&quot;), # write output samples to file plot = TRUE) # plot ## Writing layer `filedfc58117c53&#39; to data source ## `C:\\Users\\tgood.stu\\AppData\\Local\\Temp\\RtmpSecUsn\\filedfc58117c53.shp&#39; using driver `ESRI Shapefile&#39; ## Writing 113 features with 3 fields and geometry type Point. ## Simple feature collection with 113 features and 3 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337730 xmax: 438490 ymax: 5343230 ## Projected CRS: UTM Zone 17, Northern Hemisphere ## First 10 features: ## strata type rule geometry ## 6 1 existing existing POINT (432870 5340230) ## 8 1 existing existing POINT (431850 5338570) ## 10 1 existing existing POINT (436190 5341450) ## 11 1 existing existing POINT (438230 5341170) ## 14 1 existing existing POINT (431170 5339890) ## 15 1 existing existing POINT (434450 5340070) ## 17 1 existing existing POINT (434930 5339010) ## 19 1 existing existing POINT (438470 5338890) ## 23 1 existing existing POINT (435290 5337850) ## 27 1 existing existing POINT (431110 5338050) include parameter The include parameter determines whether existing samples should be included in the total count of samples defined by nSamp. By defaults include = FALSE. sample_clhs The sample_clhs function implements conditioned latin hypercube (clhs) sampling functionality. A number of other functions in the sgsR package help to provide guidance on clhs sampling including calculate_lhsPop and calculate_lhsOpt. Be sure to check out those functions for better understanding of how to optimize sample numbers. Syntax for this function is similar to others shown above, though parameters like iter, which define the number of iterations within the Metropolis-Hastings process are important to consider. In these examples we use a low iter value because it takes less time to run. Default values for iter within the clhs package are 10,000. sample_clhs(mraster = mraster, # input nSamp = 200, # desired sample number plot = TRUE, # plot iter = 100) # number of iterations ## | | | 0% | |= | 1% | |== | 2% | |== | 3% | |=== | 4% | |==== | 5% | |===== | 6% | |===== | 7% | |====== | 8% | |======= | 9% | |======== | 10% | |========= | 11% | |========= | 12% | |========== | 13% | |=========== | 14% | |============ | 15% | |============ | 16% | |============= | 17% | |============== | 18% | |=============== | 19% | |================ | 20% | |================ | 21% | |================= | 22% | |================== | 23% | |=================== | 24% | |=================== | 25% | |==================== | 26% | |===================== | 27% | |====================== | 28% | |======================= | 29% | |======================= | 30% | |======================== | 31% | |========================= | 32% | |========================== | 33% | |========================== | 34% | |=========================== | 35% | |============================ | 36% | |============================= | 37% | |============================== | 38% | |============================== | 39% | |=============================== | 40% | |================================ | 41% | |================================= | 42% | |================================= | 43% | |================================== | 44% | |=================================== | 45% | |==================================== | 46% | |===================================== | 47% | |===================================== | 48% | |====================================== | 49% | |======================================= | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 54% | |========================================== | 55% | |=========================================== | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 59% | |============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 63% | |================================================= | 64% | |================================================== | 65% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 68% | |===================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 72% | |======================================================== | 73% | |========================================================= | 74% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 78% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 83% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 86% | |=================================================================== | 87% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 91% | |======================================================================= | 92% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 95% | |========================================================================== | 96% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 99% | |=============================================================================| 100% ## Simple feature collection with 200 features and 14 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337710 xmax: 438470 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 l_2 t_3 t_4 ## 77950 8.20 87.2 2.86 4.360000 5.670000 8.24 9.74 12.76 15.06 10.9 21.4 0.0 81.3 ## 50679 5.06 45.6 3.11 1.880000 2.320000 4.13 6.48 10.95 15.48 22.8 2.8 0.0 45.2 ## 26612 14.68 89.2 4.59 7.570000 12.740000 15.79 17.10 20.03 21.22 5.2 21.5 4.4 81.9 ## 6304 10.73 94.7 3.54 5.510000 7.940000 11.28 12.98 15.40 16.51 6.9 52.2 0.0 90.7 ## 6276 11.45 94.4 2.92 7.570000 9.059999 11.61 12.94 15.88 18.71 1.4 53.6 0.3 88.2 ## 81383 5.94 70.8 2.96 2.210000 3.160000 5.55 7.37 11.30 13.54 26.1 8.3 0.0 67.8 ## 80210 13.35 94.8 3.93 6.690000 10.610000 14.43 15.57 18.01 19.05 3.8 36.6 0.0 88.1 ## 86731 11.37 92.0 4.07 5.210000 7.400000 12.15 14.13 16.77 18.14 7.4 40.2 0.1 87.3 ## 45929 4.42 23.3 2.11 1.700000 2.340000 4.32 5.44 8.30 9.75 12.3 0.2 0.0 22.4 ## 46150 15.65 95.7 4.55 8.599999 14.900000 16.88 17.92 19.78 21.27 4.6 8.2 3.5 91.2 ## type geometry ## 77950 new POINT (434490 5338450) ## 50679 new POINT (434530 5340270) ## 26612 new POINT (435810 5341690) ## 6304 new POINT (433970 5342850) ## 6276 new POINT (433410 5342850) ## 81383 new POINT (437890 5338250) ## 80210 new POINT (434530 5338310) ## 86731 new POINT (435530 5337950) ## 45929 new POINT (433710 5340550) ## 46150 new POINT (431590 5340530) sample_clhs(mraster = mraster, # input nSamp = 400, # desired sample number existing = existing, # existing samples iter = 100, # number of iterations details = TRUE) # clhs details ## | | | 0% | |= | 1% | |== | 2% | |== | 3% | |=== | 4% | |==== | 5% | |===== | 6% | |===== | 7% | |====== | 8% | |======= | 9% | |======== | 10% | |========= | 11% | |========= | 12% | |========== | 13% | |=========== | 14% | |============ | 15% | |============ | 16% | |============= | 17% | |============== | 18% | |=============== | 19% | |================ | 20% | |================ | 21% | |================= | 22% | |================== | 23% | |=================== | 24% | |=================== | 25% | |==================== | 26% | |===================== | 27% | |====================== | 28% | |======================= | 29% | |======================= | 30% | |======================== | 31% | |========================= | 32% | |========================== | 33% | |========================== | 34% | |=========================== | 35% | |============================ | 36% | |============================= | 37% | |============================== | 38% | |============================== | 39% | |=============================== | 40% | |================================ | 41% | |================================= | 42% | |================================= | 43% | |================================== | 44% | |=================================== | 45% | |==================================== | 46% | |===================================== | 47% | |===================================== | 48% | |====================================== | 49% | |======================================= | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 54% | |========================================== | 55% | |=========================================== | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 59% | |============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 63% | |================================================= | 64% | |================================================== | 65% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 68% | |===================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 72% | |======================================================== | 73% | |========================================================= | 74% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 78% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 83% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 86% | |=================================================================== | 87% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 91% | |======================================================================= | 92% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 95% | |========================================================================== | 96% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 99% | |=============================================================================| 100% ## $clhs ## [1] 47484 59803 10201 377 34938 73954 17397 37910 41023 90550 37474 28116 38033 ## [14] 83724 34364 53848 13459 32412 40951 87848 770 41675 57370 22141 43873 86222 ## [27] 76473 72763 58706 87497 9959 54147 34361 77865 32027 61445 55401 1567 55968 ## [40] 30922 22073 8962 45042 25384 47683 85041 7151 89563 45384 18441 87984 35492 ## [53] 59047 32889 68234 91012 57225 84013 64147 4193 47556 76516 48947 42187 90520 ## [66] 33481 11332 77631 55931 15506 53537 64266 86795 48379 16247 3269 56634 6187 ## [79] 69586 74961 79086 19438 89223 77685 54573 4852 67461 3040 89645 77504 26314 ## [92] 50211 1813 37448 79358 5973 7850 62956 60683 41723 35170 90811 45791 29938 ## [105] 88347 63505 83271 54320 22577 442 55043 47057 72337 36860 42865 88264 41139 ## [118] 89679 5712 52846 52455 27174 26641 36116 77729 61948 23772 23575 11118 38740 ## [131] 61533 32317 22253 11615 2980 12957 19393 40238 36992 65599 42161 78532 29564 ## [144] 60817 26807 86007 28852 38958 16090 5782 43147 75414 85059 62381 68004 14132 ## [157] 18872 86413 50958 79799 22186 3766 52347 44429 55015 84603 46813 43209 4381 ## [170] 41506 72293 63237 82657 16993 30757 82920 73386 16877 74862 64419 68700 14628 ## [183] 90440 32559 60281 28030 88746 60843 35832 18747 19809 9644 47164 35635 63648 ## [196] 31730 20334 74372 79103 73005 1 2 3 4 5 6 7 8 ## [209] 9 10 11 12 13 14 15 16 17 18 19 20 21 ## [222] 22 23 24 25 26 27 28 29 30 31 32 33 34 ## [235] 35 36 37 38 39 40 41 42 43 44 45 46 47 ## [248] 48 49 50 51 52 53 54 55 56 57 58 59 60 ## [261] 61 62 63 64 65 66 67 68 69 70 71 72 73 ## [274] 74 75 76 77 78 79 80 81 82 83 84 85 86 ## [287] 87 88 89 90 91 92 93 94 95 96 97 98 99 ## [300] 100 101 102 103 104 105 106 107 108 109 110 111 112 ## [313] 113 114 115 116 117 118 119 120 121 122 123 124 125 ## [326] 126 127 128 129 130 131 132 133 134 135 136 137 138 ## [339] 139 140 141 142 143 144 145 146 147 148 149 150 151 ## [352] 152 153 154 155 156 157 158 159 160 161 162 163 164 ## [365] 165 166 167 168 169 170 171 172 173 174 175 176 177 ## [378] 178 179 180 181 182 183 184 185 186 187 188 189 190 ## [391] 191 192 193 194 195 196 197 198 199 200 ## ## $samples ## Simple feature collection with 400 features and 14 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337730 xmax: 438490 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 l_2 ## 47284 9.13 88.8 4.33 3.29 4.990000 9.21 10.990000 17.02 20.23 14.900001 26.2 ## 59603 12.23 98.2 5.01 7.41 8.450000 10.70 13.750000 23.40 24.63 2.100000 32.2 ## 10001 8.27 83.1 4.05 3.01 4.550000 7.83 10.059999 15.72 18.69 16.400000 20.0 ## 177100 7.75 73.2 3.66 3.16 4.510000 7.57 9.460000 14.36 17.99 14.900001 15.6 ## 34738 10.85 97.0 2.52 7.45 8.880000 11.13 12.150000 14.66 16.07 1.500000 59.8 ## 73754 11.72 89.7 5.01 3.87 6.620000 12.45 15.219999 18.63 19.65 9.900001 29.9 ## 17197 10.34 95.4 2.39 7.15 8.679999 10.74 11.660000 13.56 14.43 3.200000 57.8 ## 37710 13.08 92.6 5.41 4.93 7.700000 14.35 16.299999 22.26 24.59 7.900000 22.9 ## 40823 6.63 92.1 3.63 2.43 3.160000 6.01 8.429999 13.56 15.38 34.200001 17.6 ## 90350 8.83 82.9 4.96 2.61 3.810000 8.34 11.719999 17.45 20.34 19.400000 22.6 ## t_3 t_4 type geometry ## 47284 1.1 85.0 new POINT (434830 5340470) ## 59603 10.8 94.6 new POINT (434290 5339730) ## 10001 0.1 80.1 new POINT (436390 5342650) ## 177100 0.1 68.7 new POINT (434730 5343230) ## 34738 0.0 91.4 new POINT (431190 5341210) ## 73754 0.3 84.5 new POINT (433110 5338750) ## 17197 0.0 91.5 new POINT (438390 5342230) ## 37710 6.1 86.0 new POINT (437170 5341050) ## 40823 0.0 91.1 new POINT (432370 5340850) ## 90350 0.9 78.6 new POINT (436290 5337750) sample_clhs(mraster = mraster, # input nSamp = 300, # desired sample number iter = 100, # number of iterations existing = existing, # existing samples access = access, # define access road network buff_inner = 100, # inner buffer - no samples within this distance from road buff_outer = 300, # outer buffer - no samples further than this distance from road plot = TRUE) # plot ## | | | 0% | |= | 1% | |== | 2% | |== | 3% | |=== | 4% | |==== | 5% | |===== | 6% | |===== | 7% | |====== | 8% | |======= | 9% | |======== | 10% | |========= | 11% | |========= | 12% | |========== | 13% | |=========== | 14% | |============ | 15% | |============ | 16% | |============= | 17% | |============== | 18% | |=============== | 19% | |================ | 20% | |================ | 21% | |================= | 22% | |================== | 23% | |=================== | 24% | |=================== | 25% | |==================== | 26% | |===================== | 27% | |====================== | 28% | |======================= | 29% | |======================= | 30% | |======================== | 31% | |========================= | 32% | |========================== | 33% | |========================== | 34% | |=========================== | 35% | |============================ | 36% | |============================= | 37% | |============================== | 38% | |============================== | 39% | |=============================== | 40% | |================================ | 41% | |================================= | 42% | |================================= | 43% | |================================== | 44% | |=================================== | 45% | |==================================== | 46% | |===================================== | 47% | |===================================== | 48% | |====================================== | 49% | |======================================= | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 54% | |========================================== | 55% | |=========================================== | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 59% | |============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 63% | |================================================= | 64% | |================================================== | 65% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 68% | |===================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 72% | |======================================================== | 73% | |========================================================= | 74% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 78% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 83% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 86% | |=================================================================== | 87% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 91% | |======================================================================= | 92% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 95% | |========================================================================== | 96% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 99% | |=============================================================================| 100% ## Simple feature collection with 300 features and 14 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337730 xmax: 438530 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 ## 4145 9.990000 78.7 3.64 4.690000 6.680000 10.250000 12.500000 15.32 16.23 7.3 ## 24961 7.170000 84.5 3.45 2.550000 3.730000 7.080000 8.950000 12.97 15.23 20.2 ## 32928 8.400000 96.1 2.59 5.560000 6.440000 8.099999 9.179999 13.58 16.75 5.2 ## 13404 9.190000 84.1 3.80 4.110000 6.070000 9.010000 11.080000 15.63 18.88 9.5 ## 7639 16.490000 92.0 5.32 6.000000 14.650000 18.000000 19.639999 21.81 22.51 4.6 ## 38460 10.990000 96.8 3.59 6.170000 8.349999 11.389999 12.719999 16.25 19.05 5.6 ## 26051 4.800000 4.2 4.82 1.380000 1.470000 3.000000 4.340000 15.21 16.20 2.7 ## 38665 9.059999 56.6 3.75 3.480000 5.530000 9.530000 11.520000 14.64 15.85 6.4 ## 7284 10.730000 88.8 3.91 4.620000 7.720000 11.440000 13.259999 15.46 18.65 6.6 ## 24170 12.050000 97.3 2.36 9.639999 10.530000 11.910000 12.990000 16.18 17.93 1.0 ## l_2 t_3 t_4 type geometry ## 4145 32.5 0.0 71.3 new POINT (437950 5342650) ## 24961 17.7 0.0 81.1 new POINT (432570 5339910) ## 32928 15.1 0.0 92.5 new POINT (432690 5338590) ## 13404 26.0 0.5 77.5 new POINT (437850 5341510) ## 7639 6.6 22.8 85.7 new POINT (433770 5342230) ## 38460 50.9 0.5 95.1 new POINT (431790 5337790) ## 26051 0.8 0.0 4.2 new POINT (435130 5339730) ## 38665 22.8 0.0 51.4 new POINT (434310 5337770) ## 7284 48.8 0.4 84.8 new POINT (436390 5342290) ## 24170 71.3 0.0 92.3 new POINT (432090 5340050) cost parameter The cost parameter defines an mraster covariate to be used to constrain the clhs sampling. This could be any number of variables. An example could be the distance a pixel is from road access (see example below), terrain slope, the output from calculate_coobs, or many others. #--- cost constrained examples ---# #--- calculate distance to access layer for each pixel in mr ---# mr.c &lt;- calculate_distance(raster = mraster, # input access = access, plot = TRUE) # define access road network sample_clhs(mraster = mr.c, # input nSamp = 250, # desired sample number iter = 100, # number of iterations cost = &quot;dist2access&quot;, # cost parameter - name defined in calculate_distance() plot = TRUE) # plot ## | | | 0% | |= | 1% | |== | 2% | |== | 3% | |=== | 4% | |==== | 5% | |===== | 6% | |===== | 7% | |====== | 8% | |======= | 9% | |======== | 10% | |========= | 11% | |========= | 12% | |========== | 13% | |=========== | 14% | |============ | 15% | |============ | 16% | |============= | 17% | |============== | 18% | |=============== | 19% | |================ | 20% | |================ | 21% | |================= | 22% | |================== | 23% | |=================== | 24% | |=================== | 25% | |==================== | 26% | |===================== | 27% | |====================== | 28% | |======================= | 29% | |======================= | 30% | |======================== | 31% | |========================= | 32% | |========================== | 33% | |========================== | 34% | |=========================== | 35% | |============================ | 36% | |============================= | 37% | |============================== | 38% | |============================== | 39% | |=============================== | 40% | |================================ | 41% | |================================= | 42% | |================================= | 43% | |================================== | 44% | |=================================== | 45% | |==================================== | 46% | |===================================== | 47% | |===================================== | 48% | |====================================== | 49% | |======================================= | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 54% | |========================================== | 55% | |=========================================== | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 59% | |============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 63% | |================================================= | 64% | |================================================== | 65% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 68% | |===================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 72% | |======================================================== | 73% | |========================================================= | 74% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 78% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 83% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 86% | |=================================================================== | 87% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 91% | |======================================================================= | 92% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 95% | |========================================================================== | 96% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 99% | |=============================================================================| 100% ## Simple feature collection with 250 features and 15 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431150 ymin: 5337710 xmax: 438550 ymax: 5343210 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 l_2 ## 82151 12.710000 88.7 4.60 4.78 9.21 13.98 15.81 18.000000 19.64 5.800000 31.9 ## 6545 12.799999 81.0 6.49 2.36 3.76 15.69 17.52 19.889999 20.99 13.700000 10.3 ## 54019 12.540000 90.3 5.14 3.31 6.88 14.24 15.65 18.680000 19.58 9.900001 30.7 ## 15301 10.440000 81.0 4.16 3.18 6.75 11.35 12.75 16.299999 17.82 8.400001 41.6 ## 74866 18.289999 89.7 6.18 8.75 12.33 20.87 22.28 25.189999 26.52 2.900000 11.2 ## 8501 5.330000 69.4 2.38 2.13 2.93 5.34 6.77 9.130000 10.67 28.000000 1.5 ## 74751 4.710000 25.1 2.77 1.50 1.85 4.33 6.12 9.809999 12.28 11.400001 1.5 ## 38269 5.080000 69.0 3.00 1.79 2.35 4.34 6.20 10.840000 13.45 34.700001 6.0 ## 28719 11.530000 42.4 5.21 3.62 5.08 12.99 15.62 17.940001 18.61 7.500000 12.5 ## 58682 8.139999 83.5 4.22 2.17 3.18 8.71 11.31 14.059999 15.51 19.700001 34.3 ## t_3 t_4 dist2access type geometry ## 82151 0.6 82.4 357.77088 new POINT (431490 5338190) ## 6545 3.5 73.6 180.00000 new POINT (431450 5342830) ## 54019 0.5 84.7 80.00000 new POINT (432530 5340070) ## 15301 0.1 72.8 490.30603 new POINT (436590 5342330) ## 74866 43.2 83.1 80.00000 new POINT (438490 5338670) ## 8501 0.0 68.7 72.11103 new POINT (434430 5342730) ## 74751 0.0 24.7 20.00000 new POINT (434270 5338670) ## 38269 0.0 66.9 89.44272 new POINT (434390 5341010) ## 28719 0.0 41.7 0.00000 new POINT (436570 5341570) ## 58682 0.0 80.5 113.13708 new POINT (432630 5339790) sample_clhs(mraster = mr.c, # input nSamp = 250, # desired sample number existing = existing, # existing samples iter = 100, # number of iterations cost = &quot;dist2access&quot;, # cost parameter - name defined in calculate_distance() plot = TRUE) # plot ## | | | 0% | |= | 1% | |== | 2% | |== | 3% | |=== | 4% | |==== | 5% | |===== | 6% | |===== | 7% | |====== | 8% | |======= | 9% | |======== | 10% | |========= | 11% | |========= | 12% | |========== | 13% | |=========== | 14% | |============ | 15% | |============ | 16% | |============= | 17% | |============== | 18% | |=============== | 19% | |================ | 20% | |================ | 21% | |================= | 22% | |================== | 23% | |=================== | 24% | |=================== | 25% | |==================== | 26% | |===================== | 27% | |====================== | 28% | |======================= | 29% | |======================= | 30% | |======================== | 31% | |========================= | 32% | |========================== | 33% | |========================== | 34% | |=========================== | 35% | |============================ | 36% | |============================= | 37% | |============================== | 38% | |============================== | 39% | |=============================== | 40% | |================================ | 41% | |================================= | 42% | |================================= | 43% | |================================== | 44% | |=================================== | 45% | |==================================== | 46% | |===================================== | 47% | |===================================== | 48% | |====================================== | 49% | |======================================= | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 54% | |========================================== | 55% | |=========================================== | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 59% | |============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 63% | |================================================= | 64% | |================================================== | 65% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 68% | |===================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 72% | |======================================================== | 73% | |========================================================= | 74% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 78% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 83% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 86% | |=================================================================== | 87% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 91% | |======================================================================= | 92% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 95% | |========================================================================== | 96% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 99% | |=============================================================================| 100% ## Simple feature collection with 250 features and 15 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337730 xmax: 438490 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## zmax zmean zsd pzabove2 zq20 zq50 zq70 zq90 zq95 l_1 l_2 t_3 t_4 ## 81614 7.24 79.1 2.94 2.94 4.57 7.360000 8.69 12.33 14.46 15.6 12.8 0.0 78.5 ## 85766 3.58 26.5 2.68 1.47 1.65 2.400000 3.84 9.42 12.42 17.3 1.7 0.0 26.1 ## 86783 7.82 95.6 2.70 4.41 5.47 7.810000 9.21 12.34 13.84 12.4 20.1 0.0 93.5 ## 32255 16.63 90.4 5.31 6.01 15.65 18.539999 19.64 21.37 21.90 4.2 1.1 20.1 82.1 ## 73459 9.36 93.1 3.46 4.40 6.35 9.849999 11.39 14.33 16.78 9.1 41.4 0.2 89.0 ## 20997 14.10 89.1 5.27 2.88 12.41 15.679999 17.02 19.80 20.86 8.0 19.0 3.4 84.7 ## 57712 6.08 67.4 4.09 1.67 2.11 4.840000 8.66 13.37 15.41 26.9 17.6 0.0 66.7 ## 7583 1.62 0.7 0.27 1.33 1.38 1.560000 1.73 2.16 2.40 0.7 0.0 0.0 0.7 ## 7727 11.51 84.3 3.78 5.12 7.93 12.750000 13.94 15.78 16.68 6.2 45.3 0.0 74.4 ## 9591 7.40 82.2 3.14 3.09 4.37 7.460000 9.19 12.58 14.37 18.1 17.5 0.0 79.0 ## dist2access type geometry ## 81614 20.00000 new POINT (435270 5338230) ## 85766 60.00000 new POINT (438110 5338010) ## 86783 20.00000 new POINT (436570 5337950) ## 32255 344.09301 new POINT (437270 5341370) ## 73459 226.27417 new POINT (432070 5338770) ## 20997 300.00000 new POINT (434190 5342010) ## 57712 407.92156 new POINT (432050 5339850) ## 7583 84.85281 new POINT (437770 5342790) ## 7727 44.72136 new POINT (433330 5342770) ## 9591 60.00000 new POINT (434870 5342670) sample_balanced The sample_balanced algorithm performs the balanced sampling methodology from the stratifyR and SamplingBigData packages. These functions can take a bit longer to run so be patient! sample_balanced(mraster = mraster, # input nSamp = 200, # desired sample number plot = TRUE) # plot ## Simple feature collection with 200 features and 0 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337710 xmax: 438550 ymax: 5343170 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## geometry ## 1 POINT (435910 5343170) ## 2 POINT (438550 5343130) ## 3 POINT (435350 5343110) ## 4 POINT (437750 5343110) ## 5 POINT (438070 5343090) ## 6 POINT (437010 5343070) ## 7 POINT (438090 5343070) ## 8 POINT (434870 5343030) ## 9 POINT (436630 5343010) ## 10 POINT (433830 5342990) sample_balanced(mraster = mraster, # input nSamp = 100, # desired sample number algorithm = &quot;lcube&quot;, # algorithm type access = access, # define access road network buff_inner = 50, # inner buffer - no samples within this distance from road buff_outer = 200) # outer buffer - no samples further than this distance from road ## Simple feature collection with 100 features and 0 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431130 ymin: 5337750 xmax: 438470 ymax: 5343190 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## geometry ## 1 POINT (432910 5341990) ## 2 POINT (434370 5337930) ## 3 POINT (432550 5340430) ## 4 POINT (433990 5341170) ## 5 POINT (438390 5338150) ## 6 POINT (438390 5340770) ## 7 POINT (432550 5341010) ## 8 POINT (436910 5341410) ## 9 POINT (437930 5341410) ## 10 POINT (433470 5342470) pre { max-height: 500px; overflow-y: auto; } pre[class] { max-height: 500px; } ## Reading layer `roads&#39; from data source ## `C:\\Users\\tgood.stu\\Documents\\R\\win-library\\4.0\\sgsR\\extdata\\roads.shp&#39; ## using driver `ESRI Shapefile&#39; ## Simple feature collection with 167 features and 36 fields ## Geometry type: MULTILINESTRING ## Dimension: XY ## Bounding box: xmin: 431100 ymin: 5337700 xmax: 438560 ymax: 5343240 ## Projected CRS: UTM_Zone_17_Northern_Hemisphere References "],["calc.html", "calculate_* functions calculate_distance calculate_pcomp calculate_reqSamples Sample evaluation algorithms Latin hypercube sampling evaluation algorithms", " calculate_* functions A total of 7 calculate functions currently exist in the package: calculate_distance - per pixel distance to closest access vector calculate_pcomp- calculate principal components on input mraster calculate_reqSamples - calculate the number of samples needed for representative samples within an sraster calculate_ahels - apply the adapted Hypercube Evaluation of a Legacy Sample (ahels) algorithm to existing samples calculate_coobs - apply count of observations algorithm to existing samples calculate_lhsPop - calculate population covariate statistics for latin hypercube sampling calculate_lhsOpt - calculate optimal latin hypercube sampling paramters including sample number As mentioned in a few locations throughout this sgsR tutorial, the calculate_* functions serve as helper functions. In this section we outline how these functions can be used. calculate_distance The calculate_distance function take input raster and access data and outputs a per pixel distance to the nearest access point. This function has particular value for constraining sampling protocols such the sample_clhs function where the output raster layer can be used as a cost constraint. calculate_distance(raster = sraster, # input access = access, # define access road network plot = TRUE) # plot ## class : SpatRaster ## dimensions : 277, 373, 2 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## sources : memory ## memory ## names : strata, dist2access ## min values : 1, 0 ## max values : 4, 1060 The output raster is the input with the calculated dist2access layer appended. calculate_distance(raster = mraster, # input access = access, # define access road network filename = tempfile(fileext = &quot;.tif&quot;)) # write file to disc ## class : SpatRaster ## dimensions : 277, 373, 14 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## sources : wall_metrics_small.tif (13 layers) ## memory ## names : zmax, zmean, zsd, pzabove2, zq20, zq50, ... ## min values : 0, 0, 0, 0, 0, 0, ... ## max values : 23.82, 100.00, 25.71, 18.08, 21.02, 27.60, ... calculate_pcomp The calculate_pcomp function take a mraster as input and perform principal component analysis. The number of components defined by the nComp parameter specify the number of components that should be rasterized to output. calculate_pcomp(mraster = mraster, # input nComp = 5, # number of components to output plot = TRUE ) # plot ## class : SpatRaster ## dimensions : 277, 373, 5 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## sources : memory ## memory ## memory ## ... and 2 more source(s) ## names : PC1, PC2, PC3, PC4, PC5 ## min values : -6.853635, -4.529725, -4.215024, -10.636345, -4.394728 ## max values : 11.719434, 12.657038, 5.233462, 8.600372, 4.304005 calculate_pcomp(mraster = mraster, # input nComp = 3, # number of components to output plot = TRUE, # plot details = TRUE) # details about the principal component analysis appended ## $pca ## Standard deviations (1, .., p=13): ## [1] 2.93647150 1.26882709 1.15691535 0.86852611 0.53076565 0.42304219 0.35679023 ## [8] 0.21988261 0.14290118 0.09666573 0.07179753 0.05016994 0.02570635 ## ## Rotation (n x k) = (13 x 13): ## PC1 PC2 PC3 PC4 PC5 PC6 ## zmax 0.3359531 0.01817295 -0.085980156 0.04883369 -0.16446975 0.134888577 ## zmean 0.2692352 -0.14320556 0.484261417 0.08715503 0.10021008 0.208524587 ## zsd 0.2525172 0.46307645 0.056280928 -0.35189237 -0.05790180 -0.047159024 ## pzabove2 0.2575694 -0.38512031 -0.153689213 0.33477151 -0.20262484 -0.504470621 ## zq20 0.2957809 -0.25072438 -0.163557453 0.28595035 -0.26718846 -0.008654979 ## zq50 0.3271212 0.02248762 -0.100221327 0.07934796 -0.16569646 0.420247325 ## zq70 0.3296060 0.11882609 -0.062083857 -0.02690735 -0.12986291 0.271021251 ## zq90 0.3192555 0.21122345 0.009465806 -0.18799597 -0.09477864 -0.264930469 ## zq95 0.3091490 0.21445676 0.055153306 -0.23449020 -0.07471056 -0.451270472 ## l_1 -0.1885162 0.18294540 0.614448790 0.27802959 -0.27135857 -0.287232900 ## l_2 0.2327722 -0.43278499 0.060836142 -0.34982009 0.57978716 -0.188355371 ## t_3 0.1690462 0.45853939 -0.166263397 0.60467076 0.59765870 -0.091199035 ## t_4 0.2561467 -0.13145011 0.527861021 0.09849843 0.14573821 0.177036168 ## PC7 PC8 PC9 PC10 PC11 ## zmax -0.15339832 0.0308922302 -1.886049e-02 0.0560186614 -0.1278804649 ## zmean 0.28510651 -0.0021690322 2.826642e-02 0.0270039439 0.0675442390 ## zsd -0.05015151 0.1340537231 3.445926e-01 -0.0513256272 0.6681251318 ## pzabove2 0.11141535 0.5392526124 -2.020873e-02 0.0120286554 0.2179924264 ## zq20 -0.08550919 -0.6885132239 3.627060e-01 -0.1271545992 0.1378591128 ## zq50 -0.29668394 0.0329045573 -5.353496e-01 0.4057583148 0.2063460374 ## zq70 -0.22963234 0.3370366252 1.490613e-01 -0.5945209546 -0.4103363124 ## zq90 0.08153534 -0.0006831206 3.087370e-01 0.5970060214 -0.4980350813 ## zq95 0.21011887 -0.3114508486 -5.847183e-01 -0.3194796103 -0.0758389467 ## l_1 -0.56400277 -0.0188834161 -2.142108e-02 0.0060754571 -0.0313981609 ## l_2 -0.50772612 -0.0466621166 2.094108e-02 0.0009527472 0.0201177308 ## t_3 -0.03067072 -0.0310296725 7.516919e-05 -0.0011560670 0.0009191501 ## t_4 0.32336804 0.0324261270 3.474720e-02 -0.0238296876 -0.0055552525 ## PC12 PC13 ## zmax -0.0052115172 0.8873685582 ## zmean -0.7236917619 -0.0162558333 ## zsd 0.0295065391 0.0098559868 ## pzabove2 -0.0004334086 -0.0531021769 ## zq20 0.0390001016 -0.1416169733 ## zq50 0.0609622299 -0.2923086818 ## zq70 -0.0257022931 -0.2670379822 ## zq90 -0.0047718481 -0.1800345902 ## zq95 -0.0171556239 -0.0045593830 ## l_1 -0.0077753523 0.0029767582 ## l_2 -0.0003045197 -0.0008875782 ## t_3 -0.0216941448 -0.0022824635 ## t_4 0.6845626123 0.0117767342 ## ## $raster ## class : SpatRaster ## dimensions : 277, 373, 3 (nrow, ncol, nlyr) ## resolution : 20, 20 (x, y) ## extent : 431100, 438560, 5337700, 5343240 (xmin, xmax, ymin, ymax) ## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## sources : memory ## memory ## memory ## names : PC1, PC2, PC3 ## min values : -6.853635, -4.529725, -4.215024 ## max values : 11.719434, 12.657038, 5.233462 calculate_reqSamples The calculate_reqSamples function calculates the total number of samples that should be allocated based on a total sample value (nSamp) and an input sraster. Samples are allocated based on the area coverage of strata within sraster. This function is utilized in a number of functions including sample_strat. #--- perform grid sampling ---# calculate_reqSamples(sraster = sraster, nSamp = 200) ## strata total ## 1 1 80 ## 2 2 36 ## 3 3 19 ## 4 4 65 #--- calculate existing samples to include ---# e.sr &lt;- extract_strata(sraster = sraster, existing = existing) calculate_reqSamples(sraster = sraster, nSamp = 200, existing = e.sr) ## strata total ## 1 1 7 ## 2 2 4 ## 3 3 5 ## 4 4 -16 Notice that some of the results above are negative. This indicates that the existing samples over represent those strata and that some sample should likely be removed to avoid over represenation. Sample evaluation algorithms The following algorithms were initially developed by Dr. Brendan Malone from the University of Sydney. In their work they graciously provided an in depth description of the functionality of these algorithms that were originally developed to improve soil sampling strategies. I have taken the initial scripts Dr. Malone provided to the community and implemented functions so they can be used for structurally guided sampling approaches. Many thanks to Dr. Malone for being an excellent collaborator and proponent of open source algorithms. Please consult the original reference for these ideas and scripts as they are extremely valuable and helpful for understanding their sampling rationale. Malone BP, Minansy B, Brungard C. 2019. Some methods to improve the utility of conditioned Latin hypercube sampling. PeerJ 7:e6451 DOI 10.7717/peerj.6451 calculate_ahels The calculate_ahels function performs the adapted Hypercube Evaluation of a Legacy Sample (ahels) algorithm using existing sample data and an mraster. New samples are allocated based on quantile ratios between the existing sample and mraster covariate dataset. This algorithm: Determines the quantile distributions of existing samples and mraster covariates. Determines quantiles where there is a disparity between samples and covariates. Prioritizes sampling within those quantile to improve representation. To use the function, the user will first specify the number of quantiles (nQuant) followed by either the nSamp (total number of desired samples to be added) or threshold (proportional represenation between sample and covariate quantiles - default is 0.9) parameters. Its recommended to use threshold values at or below 0.9 as higher values can currently cause the algorithm to add samples repeatedly. sample_ahels(mraster = mraster[[1:3]], # input mraster - first 3 layers only existing = existing, # existing samples plot = TRUE) # plot ## | | | 0% | | | 1% | |= | 1% | |= | 2% | |== | 2% | |== | 3% | |=== | 3% | |=== | 4% | |=== | 5% | |==== | 5% | |==== | 6% | |===== | 6% | |===== | 7% | |====== | 7% | |====== | 8% | |======= | 8% | |======= | 9% | |======= | 10% | |======== | 10% | |======== | 11% | |========= | 11% | |========= | 12% | |========== | 12% | |========== | 13% | |========== | 14% | |=========== | 14% | |=========== | 15% | |============ | 15% | |============ | 16% | |============= | 16% | |============= | 17% | |============= | 18% | |============== | 18% | |============== | 19% | |=============== | 19% | |=============== | 20% | |================ | 20% | |================ | 21% | |================= | 21% | |================= | 22% | |================= | 23% | |================== | 23% | |================== | 24% | |=================== | 24% | |=================== | 25% | |==================== | 25% | |==================== | 26% | |==================== | 27% | |===================== | 27% | |===================== | 28% | |====================== | 28% | |====================== | 29% | |======================= | 29% | |======================= | 30% | |======================= | 31% | |======================== | 31% | |======================== | 32% | |========================= | 32% | |========================= | 33% | |========================== | 33% | |========================== | 34% | |=========================== | 34% | |=========================== | 35% | |=========================== | 36% | |============================ | 36% | |============================ | 37% | |============================= | 37% | |============================= | 38% | |============================== | 38% | |============================== | 39% | |============================== | 40% | |=============================== | 40% | |=============================== | 41% | |================================ | 41% | |================================ | 42% | |================================= | 42% | |================================= | 43% | |================================= | 44% | |================================== | 44% | |================================== | 45% | |=================================== | 45% | |=================================== | 46% | |==================================== | 46% | |==================================== | 47% | |===================================== | 47% | |===================================== | 48% | |===================================== | 49% | |====================================== | 49% | |====================================== | 50% | |======================================= | 50% | |======================================= | 51% | |======================================== | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 53% | |========================================= | 54% | |========================================== | 54% | |========================================== | 55% | |=========================================== | 55% | |=========================================== | 56% | |============================================ | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 58% | |============================================= | 59% | |============================================== | 59% | |============================================== | 60% | |=============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 62% | |================================================ | 63% | |================================================= | 63% | |================================================= | 64% | |================================================== | 64% | |================================================== | 65% | |================================================== | 66% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 67% | |==================================================== | 68% | |===================================================== | 68% | |===================================================== | 69% | |====================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 71% | |======================================================= | 72% | |======================================================== | 72% | |======================================================== | 73% | |========================================================= | 73% | |========================================================= | 74% | |========================================================= | 75% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 77% | |============================================================ | 78% | |============================================================ | 79% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 80% | |============================================================== | 81% | |=============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 82% | |================================================================ | 83% | |================================================================ | 84% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 85% | |================================================================== | 86% | |=================================================================== | 86% | |=================================================================== | 87% | |=================================================================== | 88% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 90% | |====================================================================== | 91% | |====================================================================== | 92% | |======================================================================= | 92% | |======================================================================= | 93% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 94% | |========================================================================= | 95% | |========================================================================== | 95% | |========================================================================== | 96% | |========================================================================== | 97% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 98% | |============================================================================ | 99% | |=============================================================================| 99% | |=============================================================================| 100% ## [,1] [,2] [,3] ## [1,] 0.9715514 1.0019627 1.0619867 ## [2,] 0.9844219 1.0328951 0.9702556 ## [3,] 1.0636565 1.0939145 0.9423580 ## [4,] 1.0290156 0.9709948 2.1647945 ## [5,] 1.0523167 0.9189131 NA ## [6,] 0.9109323 0.9051541 NA ## [7,] 0.9532797 1.0440303 NA ## [8,] 0.9108752 0.9943927 NA ## [9,] NA 1.0068071 NA ## [10,] NA 0.9858383 NA ## Simple feature collection with 226 features and 4 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431150 ymin: 5337770 xmax: 438510 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## type zmax zmean zsd geometry ## 1 existing 10.92 76.7 4.27 POINT (433310 5342830) ## 2 existing 3.31 86.4 0.77 POINT (432270 5343230) ## 3 existing 5.01 61.6 2.97 POINT (437770 5338670) ## 4 existing 6.04 33.2 3.50 POINT (438050 5338710) ## 5 existing 10.68 97.8 2.73 POINT (432310 5338050) ## 6 existing 11.78 97.1 3.01 POINT (432730 5338590) ## 7 existing 8.03 65.3 4.32 POINT (436230 5342710) ## 8 existing 3.99 65.6 3.08 POINT (435150 5342210) ## 9 existing 12.53 91.8 5.60 POINT (431690 5338230) ## 10 existing 9.48 17.9 6.72 POINT (435410 5340510) Defaults Notice that no threshold, nSamp, or nQuant were defined. Thats because defaults are threshold = 0.9 and nQuant = 10. The first matrix output shows the quantile ratios between sample and covariates. A value of 1.0 means that samples and covariates are equally represented. Values above 1.0 are over represented in the sample, less than 1 under represented in the sample. sample_ahels(mraster = mraster[[1:3]], # input mraster - first 3 layers only existing = existing, # existing samples nQuant = 20, # define 20 quantiles nSamp = 300, # total samples desired filename = tempfile(fileext = &quot;.shp&quot;)) # write samples to disc ## | | | 0% | | | 1% | |= | 1% | |= | 2% | |== | 2% | |== | 3% | |=== | 3% | |=== | 4% | |=== | 5% | |==== | 5% | |==== | 6% | |===== | 6% | |===== | 7% | |====== | 7% | |====== | 8% | |======= | 8% | |======= | 9% | |======= | 10% | |======== | 10% | |======== | 11% | |========= | 11% | |========= | 12% | |========== | 12% | |========== | 13% | |========== | 14% | |=========== | 14% | |=========== | 15% | |============ | 15% | |============ | 16% | |============= | 16% | |============= | 17% | |============= | 18% | |============== | 18% | |============== | 19% | |=============== | 19% | |=============== | 20% | |================ | 20% | |================ | 21% | |================= | 21% | |================= | 22% | |================= | 23% | |================== | 23% | |================== | 24% | |=================== | 24% | |=================== | 25% | |==================== | 25% | |==================== | 26% | |==================== | 27% | |===================== | 27% | |===================== | 28% | |====================== | 28% | |====================== | 29% | |======================= | 29% | |======================= | 30% | |======================= | 31% | |======================== | 31% | |======================== | 32% | |========================= | 32% | |========================= | 33% | |========================== | 33% | |========================== | 34% | |=========================== | 34% | |=========================== | 35% | |=========================== | 36% | |============================ | 36% | |============================ | 37% | |============================= | 37% | |============================= | 38% | |============================== | 38% | |============================== | 39% | |============================== | 40% | |=============================== | 40% | |=============================== | 41% | |================================ | 41% | |================================ | 42% | |================================= | 42% | |================================= | 43% | |================================= | 44% | |================================== | 44% | |================================== | 45% | |=================================== | 45% | |=================================== | 46% | |==================================== | 46% | |==================================== | 47% | |===================================== | 47% | |===================================== | 48% | |===================================== | 49% | |====================================== | 49% | |====================================== | 50% | |======================================= | 50% | |======================================= | 51% | |======================================== | 51% | |======================================== | 52% | |======================================== | 53% | |========================================= | 53% | |========================================= | 54% | |========================================== | 54% | |========================================== | 55% | |=========================================== | 55% | |=========================================== | 56% | |============================================ | 56% | |============================================ | 57% | |============================================ | 58% | |============================================= | 58% | |============================================= | 59% | |============================================== | 59% | |============================================== | 60% | |=============================================== | 60% | |=============================================== | 61% | |=============================================== | 62% | |================================================ | 62% | |================================================ | 63% | |================================================= | 63% | |================================================= | 64% | |================================================== | 64% | |================================================== | 65% | |================================================== | 66% | |=================================================== | 66% | |=================================================== | 67% | |==================================================== | 67% | |==================================================== | 68% | |===================================================== | 68% | |===================================================== | 69% | |====================================================== | 69% | |====================================================== | 70% | |====================================================== | 71% | |======================================================= | 71% | |======================================================= | 72% | |======================================================== | 72% | |======================================================== | 73% | |========================================================= | 73% | |========================================================= | 74% | |========================================================= | 75% | |========================================================== | 75% | |========================================================== | 76% | |=========================================================== | 76% | |=========================================================== | 77% | |============================================================ | 77% | |============================================================ | 78% | |============================================================ | 79% | |============================================================= | 79% | |============================================================= | 80% | |============================================================== | 80% | |============================================================== | 81% | |=============================================================== | 81% | |=============================================================== | 82% | |================================================================ | 82% | |================================================================ | 83% | |================================================================ | 84% | |================================================================= | 84% | |================================================================= | 85% | |================================================================== | 85% | |================================================================== | 86% | |=================================================================== | 86% | |=================================================================== | 87% | |=================================================================== | 88% | |==================================================================== | 88% | |==================================================================== | 89% | |===================================================================== | 89% | |===================================================================== | 90% | |====================================================================== | 90% | |====================================================================== | 91% | |====================================================================== | 92% | |======================================================================= | 92% | |======================================================================= | 93% | |======================================================================== | 93% | |======================================================================== | 94% | |========================================================================= | 94% | |========================================================================= | 95% | |========================================================================== | 95% | |========================================================================== | 96% | |========================================================================== | 97% | |=========================================================================== | 97% | |=========================================================================== | 98% | |============================================================================ | 98% | |============================================================================ | 99% | |=============================================================================| 99% | |=============================================================================| 100% ## [,1] [,2] [,3] ## [1,] NA 1.0987349 1.0502303 ## [2,] 1.0183065 1.0987349 0.9777242 ## [3,] 1.0178013 1.1798814 0.9570117 ## [4,] 0.9636768 1.2958437 0.9835335 ## [5,] 1.0178013 0.9779625 0.9984523 ## [6,] 0.9814031 0.9786184 1.3032512 ## [7,] 1.0185592 1.0363068 NA ## [8,] 1.0151193 1.0728824 NA ## [9,] 1.0216175 0.9627625 NA ## [10,] 0.9846721 0.9874932 NA ## [11,] 1.0038665 1.0432221 NA ## [12,] 0.9843911 0.9891823 NA ## [13,] 0.9739454 1.0256798 NA ## [14,] 1.0973184 0.9577869 NA ## [15,] 1.1224000 0.9705420 NA ## [16,] NA 0.9636102 NA ## [17,] NA 0.9879862 NA ## [18,] NA 1.0008963 NA ## [19,] NA 0.9793525 NA ## [20,] NA 0.9794212 NA ## Writing layer `filedfc52d64256&#39; to data source ## `C:\\Users\\tgood.stu\\AppData\\Local\\Temp\\RtmpSecUsn\\filedfc52d64256.shp&#39; using driver `ESRI Shapefile&#39; ## Writing 500 features with 4 fields and geometry type Point. ## Simple feature collection with 500 features and 4 fields ## Geometry type: POINT ## Dimension: XY ## Bounding box: xmin: 431110 ymin: 5337710 xmax: 438530 ymax: 5343230 ## CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## First 10 features: ## type zmax zmean zsd geometry ## 1 existing 10.92 76.7 4.27 POINT (433310 5342830) ## 2 existing 3.31 86.4 0.77 POINT (432270 5343230) ## 3 existing 5.01 61.6 2.97 POINT (437770 5338670) ## 4 existing 6.04 33.2 3.50 POINT (438050 5338710) ## 5 existing 10.68 97.8 2.73 POINT (432310 5338050) ## 6 existing 11.78 97.1 3.01 POINT (432730 5338590) ## 7 existing 8.03 65.3 4.32 POINT (436230 5342710) ## 8 existing 3.99 65.6 3.08 POINT (435150 5342210) ## 9 existing 12.53 91.8 5.60 POINT (431690 5338230) ## 10 existing 9.48 17.9 6.72 POINT (435410 5340510) calculate_coobs The calculate_coobs function perform the COunt of OBServations (coobs) algorithm using existing sample data and mraster covariates. This algorithm aids the user in determining where additional samples could be located by comparing existing samples to each pixel and associated mraster covariates. The output coobs raster could be used to constrain clhs sampling using the sample_clhs to areas that are underreprented. The coobs raster determines how many observations are similar in terms of the covariate space at every pixel. Given that this is fairly computationally intensive, I have implemented parallel processing for this function, but users should be patient to allow processing to complete. calculate_coobs(mraster = mraster, # input existing = existing, # existing samples cores = 4, # parallel cores to use details = TRUE, # provide details from algorithm output plot = TRUE, # plot filename = tempfile(fileext = &quot;.tif&quot;)) # write output raster to tif Latin hypercube sampling evaluation algorithms The following 2 algorithms provide a means to maximize the effectiveness of latin hypercube sampling protocols. calculate_lhsPop The calculate_lhsPop function calculates population level statistics about the mraster covariates being used including calculating principal components, quantile distributions, and KullbackLeibler divergence testing. The outputs from this function are mandatory for use of the calculate_lhsOpt function described in the next section. #--- by default all statistical data are calculated ---# calculate_lhsPop(mraster = mraster) # input The output details the following: $values - Pixel values from mraster $pcaLoad - PCA loadings $matQ - Quantile matrix $matCov - Covariate matrix #--- statistical analyses can be chose by setting their parameter to `FALSE` ---# calculate_lhsPop(mraster = mraster, # input nQuant = 10, # desired number of quantiles PCA = FALSE) # choose not to calculate PCA&#39;s calculate_lhsOpt The calculate_lhsOpt function performs an bootsrapped latin hypercube sampling approach where a population level analysis of mraster data is performed to determine the optimal Latin hypercube sample size. Using statistical data calculated using the calculate_lhsPop and varying sample sizes defined by minSamp, maxSamp, step and rep. Sampling protocols are conducted and statistical effectiveness of those sampling outcomes are evaluated to determine where sample size is minimized and statistical representation is maximized. This function is currently fairly slow to run as parallel is still being implemented. #--- calculate lhsPop details ---# poplhs &lt;- calculate_lhsPop(mraster = mr) calculate_lhsOpt(popLHS = poplhs) calculate_lhsOpt(popLHS = poplhs, PCA = FALSE, iter = 200) "],["references.html", "References", " References "]]
