<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>calculate_* functions | Structurally Guided Sampling</title>
  <meta name="description" content="calculate_* functions | Structurally Guided Sampling" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="calculate_* functions | Structurally Guided Sampling" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="calculate_* functions | Structurally Guided Sampling" />
  
  
  

<meta name="author" content="Tristan Goodbody" />


<meta name="date" content="2021-08-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sample.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Approaches to Structurally Guided Sampling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="SGS.html"><a href="SGS.html"><i class="fa fa-check"></i>Structurally Guided Sampling Review</a>
<ul>
<li class="chapter" data-level="" data-path="SGS.html"><a href="SGS.html#stratapp"><i class="fa fa-check"></i>Stratification approaches</a>
<ul>
<li><a href="SGS.html#hawbaker2009"><span class="citation">(<span>Hawbaker et al. 2009</span>)</span></a></li>
<li><a href="SGS.html#dalponte2011"><span class="citation">(<span>Dalponte et al. 2011</span>)</span></a></li>
<li><a href="SGS.html#maltamo2011"><span class="citation">(<span>Maltamo et al. 2011</span>)</span></a></li>
<li><a href="SGS.html#junttila2013"><span class="citation">(<span>Junttila et al. 2013</span>)</span></a></li>
<li><a href="SGS.html#valbuena2013"><span class="citation">(<span>Valbuena et al. 2013</span>)</span></a></li>
<li><a href="SGS.html#grafstrom2013"><span class="citation">(<span>Grafström and Ringvall 2013</span>)</span></a></li>
<li><a href="SGS.html#grafstrom2014"><span class="citation">(<span>Grafström, Saarela, and Ene 2014</span>)</span></a></li>
<li><a href="SGS.html#niemi2016"><span class="citation">(<span>Niemi and Vauhkonen 2016</span>)</span></a></li>
<li><a href="SGS.html#valbuena2017"><span class="citation">(<span>Valbuena et al. 2017</span>)</span></a></li>
<li><a href="SGS.html#mcroberts2017"><span class="citation">(<span>McRoberts, Chen, and Walters 2017</span>)</span></a></li>
<li><a href="SGS.html#malone2019"><span class="citation">(<span>Malone, Minansy, and Brungard 2019</span>)</span></a></li>
<li><a href="SGS.html#papa2020"><span class="citation">(<span>Papa et al. 2020</span>)</span></a></li>
<li><a href="SGS.html#ma2020"><span class="citation">(<span>Ma et al. 2020</span>)</span></a></li>
</ul></li>
</ul></li>
<li><a href="fund.html#fund"><code>sgsR</code> fundamentals</a>
<ul>
<li class="chapter" data-level="" data-path="fund.html"><a href="fund.html"><i class="fa fa-check"></i>Algorithm structure</a></li>
<li class="chapter" data-level="" data-path="fund.html"><a href="fund.html#example-data"><i class="fa fa-check"></i>Example data</a>
<ul>
<li><a href="fund.html#mrast">Metrics rasters - <code>mraster</code></a></li>
<li><a href="fund.html#vect">Road <code>access</code> data</a></li>
</ul></li>
<li><a href="fund.html#srast">Stratified rasters - <code>sraster</code></a></li>
</ul></li>
<li><a href="strat.html#strat"><code>strat_*</code> functions</a>
<ul>
<li><a href="strat.html#kmeans"><code>strat_kmeans</code></a></li>
<li><a href="strat.html#strat_pcomp"><code>strat_pcomp</code></a></li>
<li><a href="strat.html#strat_breaks"><code>strat_breaks</code></a></li>
<li><a href="strat.html#strat_quantiles"><code>strat_quantiles</code></a></li>
<li><a href="strat.html#strat_osb"><code>strat_osb</code></a></li>
</ul></li>
<li><a href="sample.html#sample"><code>sample_*</code> functions</a>
<ul>
<li class="chapter" data-level="" data-path="sample.html"><a href="sample.html"><i class="fa fa-check"></i>Access</a></li>
<li><a href="sample.html#srs"><code>sample_srs</code></a></li>
<li><a href="sample.html#systematic"><code>sample_systematic</code></a></li>
<li><a href="sample.html#sstrat"><code>sample_strat</code></a></li>
<li><a href="sample.html#clhs"><code>sample_clhs</code></a></li>
<li><a href="sample.html#balanced"><code>sample_balanced</code></a></li>
</ul></li>
<li><a href="calc.html#calc"><code>calculate_*</code> functions</a>
<ul>
<li><a href="calc.html#dist"><code>calculate_distance</code></a></li>
<li><a href="calc.html#calculate_pcomp"><code>calculate_pcomp</code></a></li>
<li><a href="calc.html#calculate_allocation"><code>calculate_allocation</code></a>
<ul>
<li class="chapter" data-level="" data-path="calc.html"><a href="calc.html"><i class="fa fa-check"></i>Proportional Allocation</a></li>
<li class="chapter" data-level="" data-path="calc.html"><a href="calc.html#Optimal"><i class="fa fa-check"></i>Optimal Allocation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="calc.html"><a href="calc.html#sampeval"><i class="fa fa-check"></i>Sample evaluation algorithms</a>
<ul>
<li><a href="calc.html#ahels"><code>calculate_ahels</code></a></li>
<li><a href="calc.html#coobs"><code>calculate_coobs</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="calc.html"><a href="calc.html#lhseval"><i class="fa fa-check"></i>Latin hypercube sampling evaluation algorithms</a>
<ul>
<li><a href="calc.html#lhspop"><code>calculate_lhsPop</code></a></li>
<li><a href="calc.html#lhsopt"><code>calculate_lhsOpt</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structurally Guided Sampling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="calc" class="section level1 unnumbered">
<h1><code>calculate_*</code> functions</h1>
<p>A total of 7 <code>calculate</code> functions currently exist in the package:</p>
<ul>
<li><p><code>calculate_distance</code> - per pixel distance to closest access vector</p></li>
<li><p><code>calculate_pcomp</code>- calculate principal components on input <code>mraster</code></p></li>
<li><p><code>calculate_allocation</code> - calculate the number of samples needed for samples within an <code>sraster</code> - proportional / optimal sampling</p></li>
<li><p><code>calculate_ahels</code> - apply the adapted Hypercube Evaluation of a Legacy Sample (ahels) algorithm to existing samples</p></li>
<li><p><code>calculate_coobs</code> - apply count of observations algorithm to existing samples</p></li>
<li><p><code>calculate_lhsPop</code> - calculate population covariate statistics for latin hypercube sampling</p></li>
<li><p><code>calculate_lhsOpt</code> - calculate optimal latin hypercube sampling paramters including sample number</p></li>
</ul>
<p>As mentioned in a few locations throughout this <code>sgsR</code> tutorial, the <code>calculate_*</code> functions serve as helper functions. In this section we outline how these functions can be used.</p>
<div id="dist" class="section level2 unnumbered">
<h2><code>calculate_distance</code></h2>
<p>The <code>calculate_distance</code> function take input <code>raster</code> and <code>access</code> data and outputs a per pixel distance to the nearest access point. This function has particular value for constraining sampling protocols such the <a href="sample.html#clhs"><code>sample_clhs</code></a> function where the output raster layer can be used as a <code>cost</code> constraint.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="calc.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_distance</span>(<span class="at">raster =</span> sraster, <span class="co"># input</span></span>
<span id="cb84-2"><a href="calc.html#cb84-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">access =</span> access, <span class="co"># define access road network</span></span>
<span id="cb84-3"><a href="calc.html#cb84-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot =</span> <span class="cn">TRUE</span>) <span class="co"># plot</span></span></code></pre></div>
<p><img src="SGS_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<pre><code>## class       : SpatRaster 
## dimensions  : 277, 373, 2  (nrow, ncol, nlyr)
## resolution  : 20, 20  (x, y)
## extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
## sources     : memory  
##               memory  
## names       : strata, dist2access 
## min values  :      1,           0 
## max values  :      4,        1060</code></pre>
<p>The output raster is the input with the calculated <code>dist2access</code> layer appended.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="calc.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_distance</span>(<span class="at">raster =</span> mraster, <span class="co"># input</span></span>
<span id="cb86-2"><a href="calc.html#cb86-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">access =</span> access, <span class="co"># define access road network</span></span>
<span id="cb86-3"><a href="calc.html#cb86-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">filename =</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.tif&quot;</span>)) <span class="co"># write file to disc</span></span></code></pre></div>
<pre><code>## class       : SpatRaster 
## dimensions  : 277, 373, 14  (nrow, ncol, nlyr)
## resolution  : 20, 20  (x, y)
## extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
## sources     : wall_metrics_small.tif  (13 layers) 
##               memory  
## names       :    zmax,   zmean,     zsd, pzabove2,    zq20,    zq50, ... 
## min values  :       0,       0,       0,        0,       0,       0, ... 
## max values  :   23.82,  100.00,   25.71,    18.08,   21.02,   27.60, ...</code></pre>
</div>
<div id="calculate_pcomp" class="section level2 unnumbered">
<h2><code>calculate_pcomp</code></h2>
<p>The <code>calculate_pcomp</code> function take a <code>mraster</code> as input and perform principal component analysis. The number of components defined by the <code>nComp</code> parameter specify the number of components that should be rasterized to output.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="calc.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_pcomp</span>(<span class="at">mraster =</span> mraster, <span class="co"># input</span></span>
<span id="cb88-2"><a href="calc.html#cb88-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">nComp =</span> <span class="dv">5</span>, <span class="co"># number of components to output</span></span>
<span id="cb88-3"><a href="calc.html#cb88-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot =</span> <span class="cn">TRUE</span> ) <span class="co"># plot</span></span></code></pre></div>
<p><img src="SGS_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<pre><code>## class       : SpatRaster 
## dimensions  : 277, 373, 5  (nrow, ncol, nlyr)
## resolution  : 20, 20  (x, y)
## extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
## sources     : memory  
##               memory  
##               memory  
##               ... and 2 more source(s)
## names       :        PC1,        PC2,        PC3,        PC4,        PC5 
## min values  :  -6.853635,  -4.529725,  -4.215024, -10.636345,  -4.394728 
## max values  :  11.719434,  12.657038,   5.233462,   8.600372,   4.304005</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="calc.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_pcomp</span>(<span class="at">mraster =</span> mraster, <span class="co"># input</span></span>
<span id="cb90-2"><a href="calc.html#cb90-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">nComp =</span> <span class="dv">3</span>, <span class="co"># number of components to output</span></span>
<span id="cb90-3"><a href="calc.html#cb90-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="co"># plot</span></span>
<span id="cb90-4"><a href="calc.html#cb90-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">details =</span> <span class="cn">TRUE</span>) <span class="co"># details about the principal component analysis appended</span></span></code></pre></div>
<p><img src="SGS_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<pre><code>## $pca
## Standard deviations (1, .., p=13):
##  [1] 2.93647150 1.26882709 1.15691535 0.86852611 0.53076565 0.42304219 0.35679023 0.21988261
##  [9] 0.14290118 0.09666573 0.07179753 0.05016994 0.02570635
## 
## Rotation (n x k) = (13 x 13):
##                 PC1         PC2          PC3         PC4         PC5          PC6         PC7
## zmax      0.3359531  0.01817295 -0.085980156  0.04883369 -0.16446975  0.134888577 -0.15339832
## zmean     0.2692352 -0.14320556  0.484261417  0.08715503  0.10021008  0.208524587  0.28510651
## zsd       0.2525172  0.46307645  0.056280928 -0.35189237 -0.05790180 -0.047159024 -0.05015151
## pzabove2  0.2575694 -0.38512031 -0.153689213  0.33477151 -0.20262484 -0.504470621  0.11141535
## zq20      0.2957809 -0.25072438 -0.163557453  0.28595035 -0.26718846 -0.008654979 -0.08550919
## zq50      0.3271212  0.02248762 -0.100221327  0.07934796 -0.16569646  0.420247325 -0.29668394
## zq70      0.3296060  0.11882609 -0.062083857 -0.02690735 -0.12986291  0.271021251 -0.22963234
## zq90      0.3192555  0.21122345  0.009465806 -0.18799597 -0.09477864 -0.264930469  0.08153534
## zq95      0.3091490  0.21445676  0.055153306 -0.23449020 -0.07471056 -0.451270472  0.21011887
## l_1      -0.1885162  0.18294540  0.614448790  0.27802959 -0.27135857 -0.287232900 -0.56400277
## l_2       0.2327722 -0.43278499  0.060836142 -0.34982009  0.57978716 -0.188355371 -0.50772612
## t_3       0.1690462  0.45853939 -0.166263397  0.60467076  0.59765870 -0.091199035 -0.03067072
## t_4       0.2561467 -0.13145011  0.527861021  0.09849843  0.14573821  0.177036168  0.32336804
##                    PC8           PC9          PC10          PC11          PC12          PC13
## zmax      0.0308922302 -1.886049e-02  0.0560186614 -0.1278804649 -0.0052115172  0.8873685582
## zmean    -0.0021690322  2.826642e-02  0.0270039439  0.0675442390 -0.7236917619 -0.0162558333
## zsd       0.1340537231  3.445926e-01 -0.0513256272  0.6681251318  0.0295065391  0.0098559868
## pzabove2  0.5392526124 -2.020873e-02  0.0120286554  0.2179924264 -0.0004334086 -0.0531021769
## zq20     -0.6885132239  3.627060e-01 -0.1271545992  0.1378591128  0.0390001016 -0.1416169733
## zq50      0.0329045573 -5.353496e-01  0.4057583148  0.2063460374  0.0609622299 -0.2923086818
## zq70      0.3370366252  1.490613e-01 -0.5945209546 -0.4103363124 -0.0257022931 -0.2670379822
## zq90     -0.0006831206  3.087370e-01  0.5970060214 -0.4980350813 -0.0047718481 -0.1800345902
## zq95     -0.3114508486 -5.847183e-01 -0.3194796103 -0.0758389467 -0.0171556239 -0.0045593830
## l_1      -0.0188834161 -2.142108e-02  0.0060754571 -0.0313981609 -0.0077753523  0.0029767582
## l_2      -0.0466621166  2.094108e-02  0.0009527472  0.0201177308 -0.0003045197 -0.0008875782
## t_3      -0.0310296725  7.516919e-05 -0.0011560670  0.0009191501 -0.0216941448 -0.0022824635
## t_4       0.0324261270  3.474720e-02 -0.0238296876 -0.0055552525  0.6845626123  0.0117767342
## 
## $raster
## class       : SpatRaster 
## dimensions  : 277, 373, 3  (nrow, ncol, nlyr)
## resolution  : 20, 20  (x, y)
## extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
## sources     : memory  
##               memory  
##               memory  
## names       :       PC1,       PC2,       PC3 
## min values  : -6.853635, -4.529725, -4.215024 
## max values  : 11.719434, 12.657038,  5.233462</code></pre>
</div>
<div id="calculate_allocation" class="section level2 unnumbered">
<h2><code>calculate_allocation</code></h2>
<p>The <code>calculate_allocation</code> function calculates the total number of samples that should be allocated based on a total sample value (<code>nSamp</code>) and an input <code>sraster</code>. This function is utilized in a number of functions including <a href="strat.html#strat"><code>sample_strat</code></a>. Two methods for allocation are currently included: proportional (<code>prop</code>), and optimal (<code>optim</code>) allocation.</p>
<ul>
<li>Proportional - Samples are allocated based on the area coverage of strata. This is the default method.</li>
<li>Optimal - Samples are allocated based on the within strata variation.</li>
</ul>
<div id="proportional" class="section level3 unnumbered">
<h3>Proportional Allocation</h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="calc.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- perform grid sampling ---#</span></span>
<span id="cb92-2"><a href="calc.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_allocation</span>(<span class="at">sraster =</span> sraster, </span>
<span id="cb92-3"><a href="calc.html#cb92-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nSamp =</span> <span class="dv">200</span>)</span></code></pre></div>
<pre><code>##   strata total
## 1      1    65
## 2      2    80
## 3      3    18
## 4      4    36</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="calc.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- calculate existing samples to include ---#</span></span>
<span id="cb94-2"><a href="calc.html#cb94-2" aria-hidden="true" tabindex="-1"></a>e.sr <span class="ot">&lt;-</span> <span class="fu">extract_strata</span>(<span class="at">sraster =</span> sraster, </span>
<span id="cb94-3"><a href="calc.html#cb94-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">existing =</span> existing)</span>
<span id="cb94-4"><a href="calc.html#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="calc.html#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_allocation</span>(<span class="at">sraster =</span> sraster, </span>
<span id="cb94-6"><a href="calc.html#cb94-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nSamp =</span> <span class="dv">200</span>, </span>
<span id="cb94-7"><a href="calc.html#cb94-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">existing =</span> e.sr)</span></code></pre></div>
<pre><code>##   strata total need
## 1      1     7   65
## 2      2    -6   80
## 3      3     3   18
## 4      4    -5   36</code></pre>
<p>Notice that some of the results above are negative. This indicates that the <code>existing</code> samples over represent those strata and that some sample should likely be removed to avoid over representation.</p>
</div>
<div id="Optimal" class="section level3 unnumbered">
<h3>Optimal Allocation</h3>
<p>Proportional allocation determine the number of samples based on the weights of strata. Optimal allocation utilizes within strata variation to allocate samples. This means that in addition to providing and <code>sraster</code>, that an <code>mraster</code> and a specific metric must be provided to calculate variation and appropriately allocate samples.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="calc.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_allocation</span>(<span class="at">sraster =</span> sraster, <span class="co"># stratified raster</span></span>
<span id="cb96-2"><a href="calc.html#cb96-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nSamp =</span> <span class="dv">200</span>, <span class="co"># desired sample number</span></span>
<span id="cb96-3"><a href="calc.html#cb96-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">existing =</span> e.sr, <span class="co">#existing samples</span></span>
<span id="cb96-4"><a href="calc.html#cb96-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">allocation =</span> <span class="st">&quot;optim&quot;</span>, <span class="co"># optimal allocation</span></span>
<span id="cb96-5"><a href="calc.html#cb96-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mraster =</span> mraster, <span class="co"># metrics raster</span></span>
<span id="cb96-6"><a href="calc.html#cb96-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">metric =</span> <span class="dv">1</span>, <span class="co"># metric to describe strata variance</span></span>
<span id="cb96-7"><a href="calc.html#cb96-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">force =</span> <span class="cn">TRUE</span>) <span class="co"># force nSamp number</span></span></code></pre></div>
<pre><code>##   strata total need
## 1      1     5   63
## 2      2     1   87
## 3      3     7   22
## 4      4   -13   28</code></pre>
</div>
</div>
<div id="sampeval" class="section level2 unnumbered">
<h2>Sample evaluation algorithms</h2>
<p>The following algorithms were initially developed by Dr. Brendan Malone from the University of Sydney. In their work they graciously provided an in depth description of the functionality of these algorithms that were originally developed to improve soil sampling strategies. I have taken the initial scripts Dr. Malone provided to the community and implemented functions so they can be used for structurally guided sampling approaches. Many thanks to Dr. Malone for being an excellent collaborator and proponent of open source algorithms.</p>
<p>Please consult the original reference for these ideas and scripts as they are extremely valuable and helpful for understanding their sampling rationale.</p>
<p><em>Malone BP, Minansy B, Brungard C. 2019. Some methods to improve the utility of conditioned Latin hypercube sampling. PeerJ 7:e6451 DOI 10.7717/peerj.6451</em></p>
<div id="ahels" class="section level3 unnumbered">
<h3><code>calculate_ahels</code></h3>
<p>The <code>calculate_ahels</code> function performs the adapted Hypercube Evaluation of a Legacy Sample (ahels) algorithm using
<code>existing</code> sample data and an <code>mraster</code>. New samples are allocated based on quantile ratios between the <code>existing</code> sample and <code>mraster</code> covariate dataset.</p>
<p>This algorithm:</p>
<ol style="list-style-type: decimal">
<li><p>Determines the quantile distributions of <code>existing</code> samples and <code>mraster</code> covariates.</p></li>
<li><p>Determines quantiles where there is a disparity between samples and covariates.</p></li>
<li><p>Prioritizes sampling within those quantile to improve representation.</p></li>
</ol>
<p>To use the function, the user will first specify the number of quantiles (<code>nQuant</code>) followed by either the <code>nSamp</code> (total number of desired samples to be added) or <code>threshold</code> (proportional represenation between sample and covariate quantiles - default is 0.9) parameters. Its recommended to use <code>threshold</code> values at or below 0.9 as higher values can currently cause the algorithm to add samples repeatedly.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="calc.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_ahels</span>(<span class="at">mraster =</span> mraster[[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]], <span class="co"># input mraster - first 3 layers only</span></span>
<span id="cb98-2"><a href="calc.html#cb98-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">existing =</span> existing, <span class="co"># existing samples</span></span>
<span id="cb98-3"><a href="calc.html#cb98-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot =</span> <span class="cn">TRUE</span>) <span class="co"># plot</span></span></code></pre></div>
<pre><code>## 
  |                                                                                               
  |                                                                                         |   0%
  |                                                                                               
  |                                                                                         |   1%
  |                                                                                               
  |=                                                                                        |   1%
  |                                                                                               
  |=                                                                                        |   2%
  |                                                                                               
  |==                                                                                       |   2%
  |                                                                                               
  |==                                                                                       |   3%
  |                                                                                               
  |===                                                                                      |   3%
  |                                                                                               
  |===                                                                                      |   4%
  |                                                                                               
  |====                                                                                     |   4%
  |                                                                                               
  |====                                                                                     |   5%
  |                                                                                               
  |=====                                                                                    |   5%
  |                                                                                               
  |=====                                                                                    |   6%
  |                                                                                               
  |======                                                                                   |   6%
  |                                                                                               
  |======                                                                                   |   7%
  |                                                                                               
  |=======                                                                                  |   7%
  |                                                                                               
  |=======                                                                                  |   8%
  |                                                                                               
  |========                                                                                 |   8%
  |                                                                                               
  |========                                                                                 |   9%
  |                                                                                               
  |========                                                                                 |  10%
  |                                                                                               
  |=========                                                                                |  10%
  |                                                                                               
  |=========                                                                                |  11%
  |                                                                                               
  |==========                                                                               |  11%
  |                                                                                               
  |==========                                                                               |  12%
  |                                                                                               
  |===========                                                                              |  12%
  |                                                                                               
  |===========                                                                              |  13%
  |                                                                                               
  |============                                                                             |  13%
  |                                                                                               
  |============                                                                             |  14%
  |                                                                                               
  |=============                                                                            |  14%
  |                                                                                               
  |=============                                                                            |  15%
  |                                                                                               
  |==============                                                                           |  15%
  |                                                                                               
  |==============                                                                           |  16%
  |                                                                                               
  |===============                                                                          |  16%
  |                                                                                               
  |===============                                                                          |  17%
  |                                                                                               
  |================                                                                         |  17%
  |                                                                                               
  |================                                                                         |  18%
  |                                                                                               
  |================                                                                         |  19%
  |                                                                                               
  |=================                                                                        |  19%
  |                                                                                               
  |=================                                                                        |  20%
  |                                                                                               
  |==================                                                                       |  20%
  |                                                                                               
  |==================                                                                       |  21%
  |                                                                                               
  |===================                                                                      |  21%
  |                                                                                               
  |===================                                                                      |  22%
  |                                                                                               
  |====================                                                                     |  22%
  |                                                                                               
  |====================                                                                     |  23%
  |                                                                                               
  |=====================                                                                    |  23%
  |                                                                                               
  |=====================                                                                    |  24%
  |                                                                                               
  |======================                                                                   |  24%
  |                                                                                               
  |======================                                                                   |  25%
  |                                                                                               
  |=======================                                                                  |  25%
  |                                                                                               
  |=======================                                                                  |  26%
  |                                                                                               
  |========================                                                                 |  26%
  |                                                                                               
  |========================                                                                 |  27%
  |                                                                                               
  |========================                                                                 |  28%
  |                                                                                               
  |=========================                                                                |  28%
  |                                                                                               
  |=========================                                                                |  29%
  |                                                                                               
  |==========================                                                               |  29%
  |                                                                                               
  |==========================                                                               |  30%
  |                                                                                               
  |===========================                                                              |  30%
  |                                                                                               
  |===========================                                                              |  31%
  |                                                                                               
  |============================                                                             |  31%
  |                                                                                               
  |============================                                                             |  32%
  |                                                                                               
  |=============================                                                            |  32%
  |                                                                                               
  |=============================                                                            |  33%
  |                                                                                               
  |==============================                                                           |  33%
  |                                                                                               
  |==============================                                                           |  34%
  |                                                                                               
  |===============================                                                          |  34%
  |                                                                                               
  |===============================                                                          |  35%
  |                                                                                               
  |================================                                                         |  35%
  |                                                                                               
  |================================                                                         |  36%
  |                                                                                               
  |================================                                                         |  37%
  |                                                                                               
  |=================================                                                        |  37%
  |                                                                                               
  |=================================                                                        |  38%
  |                                                                                               
  |==================================                                                       |  38%
  |                                                                                               
  |==================================                                                       |  39%
  |                                                                                               
  |===================================                                                      |  39%
  |                                                                                               
  |===================================                                                      |  40%
  |                                                                                               
  |====================================                                                     |  40%
  |                                                                                               
  |====================================                                                     |  41%
  |                                                                                               
  |=====================================                                                    |  41%
  |                                                                                               
  |=====================================                                                    |  42%
  |                                                                                               
  |======================================                                                   |  42%
  |                                                                                               
  |======================================                                                   |  43%
  |                                                                                               
  |=======================================                                                  |  43%
  |                                                                                               
  |=======================================                                                  |  44%
  |                                                                                               
  |========================================                                                 |  44%
  |                                                                                               
  |========================================                                                 |  45%
  |                                                                                               
  |========================================                                                 |  46%
  |                                                                                               
  |=========================================                                                |  46%
  |                                                                                               
  |=========================================                                                |  47%
  |                                                                                               
  |==========================================                                               |  47%
  |                                                                                               
  |==========================================                                               |  48%
  |                                                                                               
  |===========================================                                              |  48%
  |                                                                                               
  |===========================================                                              |  49%
  |                                                                                               
  |============================================                                             |  49%
  |                                                                                               
  |============================================                                             |  50%
  |                                                                                               
  |=============================================                                            |  50%
  |                                                                                               
  |=============================================                                            |  51%
  |                                                                                               
  |==============================================                                           |  51%
  |                                                                                               
  |==============================================                                           |  52%
  |                                                                                               
  |===============================================                                          |  52%
  |                                                                                               
  |===============================================                                          |  53%
  |                                                                                               
  |================================================                                         |  53%
  |                                                                                               
  |================================================                                         |  54%
  |                                                                                               
  |=================================================                                        |  54%
  |                                                                                               
  |=================================================                                        |  55%
  |                                                                                               
  |=================================================                                        |  56%
  |                                                                                               
  |==================================================                                       |  56%
  |                                                                                               
  |==================================================                                       |  57%
  |                                                                                               
  |===================================================                                      |  57%
  |                                                                                               
  |===================================================                                      |  58%
  |                                                                                               
  |====================================================                                     |  58%
  |                                                                                               
  |====================================================                                     |  59%
  |                                                                                               
  |=====================================================                                    |  59%
  |                                                                                               
  |=====================================================                                    |  60%
  |                                                                                               
  |======================================================                                   |  60%
  |                                                                                               
  |======================================================                                   |  61%
  |                                                                                               
  |=======================================================                                  |  61%
  |                                                                                               
  |=======================================================                                  |  62%
  |                                                                                               
  |========================================================                                 |  62%
  |                                                                                               
  |========================================================                                 |  63%
  |                                                                                               
  |=========================================================                                |  63%
  |                                                                                               
  |=========================================================                                |  64%
  |                                                                                               
  |=========================================================                                |  65%
  |                                                                                               
  |==========================================================                               |  65%
  |                                                                                               
  |==========================================================                               |  66%
  |                                                                                               
  |===========================================================                              |  66%
  |                                                                                               
  |===========================================================                              |  67%
  |                                                                                               
  |============================================================                             |  67%
  |                                                                                               
  |============================================================                             |  68%
  |                                                                                               
  |=============================================================                            |  68%
  |                                                                                               
  |=============================================================                            |  69%
  |                                                                                               
  |==============================================================                           |  69%
  |                                                                                               
  |==============================================================                           |  70%
  |                                                                                               
  |===============================================================                          |  70%
  |                                                                                               
  |===============================================================                          |  71%
  |                                                                                               
  |================================================================                         |  71%
  |                                                                                               
  |================================================================                         |  72%
  |                                                                                               
  |=================================================================                        |  72%
  |                                                                                               
  |=================================================================                        |  73%
  |                                                                                               
  |=================================================================                        |  74%
  |                                                                                               
  |==================================================================                       |  74%
  |                                                                                               
  |==================================================================                       |  75%
  |                                                                                               
  |===================================================================                      |  75%
  |                                                                                               
  |===================================================================                      |  76%
  |                                                                                               
  |====================================================================                     |  76%
  |                                                                                               
  |====================================================================                     |  77%
  |                                                                                               
  |=====================================================================                    |  77%
  |                                                                                               
  |=====================================================================                    |  78%
  |                                                                                               
  |======================================================================                   |  78%
  |                                                                                               
  |======================================================================                   |  79%
  |                                                                                               
  |=======================================================================                  |  79%
  |                                                                                               
  |=======================================================================                  |  80%
  |                                                                                               
  |========================================================================                 |  80%
  |                                                                                               
  |========================================================================                 |  81%
  |                                                                                               
  |=========================================================================                |  81%
  |                                                                                               
  |=========================================================================                |  82%
  |                                                                                               
  |=========================================================================                |  83%
  |                                                                                               
  |==========================================================================               |  83%
  |                                                                                               
  |==========================================================================               |  84%
  |                                                                                               
  |===========================================================================              |  84%
  |                                                                                               
  |===========================================================================              |  85%
  |                                                                                               
  |============================================================================             |  85%
  |                                                                                               
  |============================================================================             |  86%
  |                                                                                               
  |=============================================================================            |  86%
  |                                                                                               
  |=============================================================================            |  87%
  |                                                                                               
  |==============================================================================           |  87%
  |                                                                                               
  |==============================================================================           |  88%
  |                                                                                               
  |===============================================================================          |  88%
  |                                                                                               
  |===============================================================================          |  89%
  |                                                                                               
  |================================================================================         |  89%
  |                                                                                               
  |================================================================================         |  90%
  |                                                                                               
  |=================================================================================        |  90%
  |                                                                                               
  |=================================================================================        |  91%
  |                                                                                               
  |=================================================================================        |  92%
  |                                                                                               
  |==================================================================================       |  92%
  |                                                                                               
  |==================================================================================       |  93%
  |                                                                                               
  |===================================================================================      |  93%
  |                                                                                               
  |===================================================================================      |  94%
  |                                                                                               
  |====================================================================================     |  94%
  |                                                                                               
  |====================================================================================     |  95%
  |                                                                                               
  |=====================================================================================    |  95%
  |                                                                                               
  |=====================================================================================    |  96%
  |                                                                                               
  |======================================================================================   |  96%
  |                                                                                               
  |======================================================================================   |  97%
  |                                                                                               
  |=======================================================================================  |  97%
  |                                                                                               
  |=======================================================================================  |  98%
  |                                                                                               
  |======================================================================================== |  98%
  |                                                                                               
  |======================================================================================== |  99%
  |                                                                                               
  |=========================================================================================|  99%
  |                                                                                               
  |=========================================================================================| 100%
##            [,1]      [,2]      [,3]
##  [1,] 0.9630291 1.0001188 1.0569329
##  [2,] 0.9878931 1.0500868 0.9805157
##  [3,] 1.0244465 1.0009096 0.9484624
##  [4,] 0.9196324 1.1422808 1.5845945
##  [5,] 0.9837800 1.2611803        NA
##  [6,] 1.0418558 1.3251163        NA
##  [7,] 1.0261549 1.0083369        NA
##  [8,] 1.6668647 1.0039715        NA
##  [9,]        NA 0.9212081        NA
## [10,]        NA 0.9406802        NA</code></pre>
<p><img src="SGS_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<pre><code>## Simple feature collection with 247 features and 4 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438550 ymax: 5343230
## CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
## First 10 features:
##        type  zmax zmean  zsd               geometry
## 1  existing 13.55  91.5 4.04 POINT (434170 5337990)
## 2  existing  5.65  54.5 2.18 POINT (436130 5339130)
## 3  existing 12.25  93.2 5.35 POINT (432630 5340190)
## 4  existing  8.55  78.2 5.47 POINT (433150 5340990)
## 5  existing 10.87  79.2 4.18 POINT (433050 5340390)
## 6  existing 15.41  91.3 4.42 POINT (435790 5339890)
## 7  existing 11.17  95.8 2.30 POINT (432530 5337950)
## 8  existing 14.33  89.4 3.90 POINT (438470 5339910)
## 9  existing 16.34  78.2 5.80 POINT (436110 5341350)
## 10 existing  6.29  91.0 2.57 POINT (432010 5340310)</code></pre>
</div>
<div class="box-content vig-content">
<div id="defaults" class="section level3 unnumbered box-title vig-content-top">
<h3>Defaults</h3>
</div>
<p>Notice that no <code>threshold</code>, <code>nSamp</code>, or <code>nQuant</code> were defined. Thats because defaults are <code>threshold = 0.9</code> and <code>nQuant = 10</code>.</p>
</div>
<p>The first matrix output shows the quantile ratios between sample and covariates. A value of 1.0 means that samples and covariates are equally represented. Values above 1.0 are over represented in the sample, less than 1 under represented in the sample.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="calc.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_ahels</span>(<span class="at">mraster =</span> mraster[[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]], <span class="co"># input mraster - first 3 layers only</span></span>
<span id="cb101-2"><a href="calc.html#cb101-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">existing =</span> existing, <span class="co"># existing samples</span></span>
<span id="cb101-3"><a href="calc.html#cb101-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">nQuant =</span> <span class="dv">20</span>, <span class="co"># define 20 quantiles</span></span>
<span id="cb101-4"><a href="calc.html#cb101-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">nSamp =</span> <span class="dv">300</span>, <span class="co"># total samples desired</span></span>
<span id="cb101-5"><a href="calc.html#cb101-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">filename =</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.shp&quot;</span>)) <span class="co"># write samples to disc</span></span></code></pre></div>
<pre><code>## 
  |                                                                                               
  |                                                                                         |   0%
  |                                                                                               
  |                                                                                         |   1%
  |                                                                                               
  |=                                                                                        |   1%
  |                                                                                               
  |=                                                                                        |   2%
  |                                                                                               
  |==                                                                                       |   2%
  |                                                                                               
  |==                                                                                       |   3%
  |                                                                                               
  |===                                                                                      |   3%
  |                                                                                               
  |===                                                                                      |   4%
  |                                                                                               
  |====                                                                                     |   4%
  |                                                                                               
  |====                                                                                     |   5%
  |                                                                                               
  |=====                                                                                    |   5%
  |                                                                                               
  |=====                                                                                    |   6%
  |                                                                                               
  |======                                                                                   |   6%
  |                                                                                               
  |======                                                                                   |   7%
  |                                                                                               
  |=======                                                                                  |   7%
  |                                                                                               
  |=======                                                                                  |   8%
  |                                                                                               
  |========                                                                                 |   8%
  |                                                                                               
  |========                                                                                 |   9%
  |                                                                                               
  |========                                                                                 |  10%
  |                                                                                               
  |=========                                                                                |  10%
  |                                                                                               
  |=========                                                                                |  11%
  |                                                                                               
  |==========                                                                               |  11%
  |                                                                                               
  |==========                                                                               |  12%
  |                                                                                               
  |===========                                                                              |  12%
  |                                                                                               
  |===========                                                                              |  13%
  |                                                                                               
  |============                                                                             |  13%
  |                                                                                               
  |============                                                                             |  14%
  |                                                                                               
  |=============                                                                            |  14%
  |                                                                                               
  |=============                                                                            |  15%
  |                                                                                               
  |==============                                                                           |  15%
  |                                                                                               
  |==============                                                                           |  16%
  |                                                                                               
  |===============                                                                          |  16%
  |                                                                                               
  |===============                                                                          |  17%
  |                                                                                               
  |================                                                                         |  17%
  |                                                                                               
  |================                                                                         |  18%
  |                                                                                               
  |================                                                                         |  19%
  |                                                                                               
  |=================                                                                        |  19%
  |                                                                                               
  |=================                                                                        |  20%
  |                                                                                               
  |==================                                                                       |  20%
  |                                                                                               
  |==================                                                                       |  21%
  |                                                                                               
  |===================                                                                      |  21%
  |                                                                                               
  |===================                                                                      |  22%
  |                                                                                               
  |====================                                                                     |  22%
  |                                                                                               
  |====================                                                                     |  23%
  |                                                                                               
  |=====================                                                                    |  23%
  |                                                                                               
  |=====================                                                                    |  24%
  |                                                                                               
  |======================                                                                   |  24%
  |                                                                                               
  |======================                                                                   |  25%
  |                                                                                               
  |=======================                                                                  |  25%
  |                                                                                               
  |=======================                                                                  |  26%
  |                                                                                               
  |========================                                                                 |  26%
  |                                                                                               
  |========================                                                                 |  27%
  |                                                                                               
  |========================                                                                 |  28%
  |                                                                                               
  |=========================                                                                |  28%
  |                                                                                               
  |=========================                                                                |  29%
  |                                                                                               
  |==========================                                                               |  29%
  |                                                                                               
  |==========================                                                               |  30%
  |                                                                                               
  |===========================                                                              |  30%
  |                                                                                               
  |===========================                                                              |  31%
  |                                                                                               
  |============================                                                             |  31%
  |                                                                                               
  |============================                                                             |  32%
  |                                                                                               
  |=============================                                                            |  32%
  |                                                                                               
  |=============================                                                            |  33%
  |                                                                                               
  |==============================                                                           |  33%
  |                                                                                               
  |==============================                                                           |  34%
  |                                                                                               
  |===============================                                                          |  34%
  |                                                                                               
  |===============================                                                          |  35%
  |                                                                                               
  |================================                                                         |  35%
  |                                                                                               
  |================================                                                         |  36%
  |                                                                                               
  |================================                                                         |  37%
  |                                                                                               
  |=================================                                                        |  37%
  |                                                                                               
  |=================================                                                        |  38%
  |                                                                                               
  |==================================                                                       |  38%
  |                                                                                               
  |==================================                                                       |  39%
  |                                                                                               
  |===================================                                                      |  39%
  |                                                                                               
  |===================================                                                      |  40%
  |                                                                                               
  |====================================                                                     |  40%
  |                                                                                               
  |====================================                                                     |  41%
  |                                                                                               
  |=====================================                                                    |  41%
  |                                                                                               
  |=====================================                                                    |  42%
  |                                                                                               
  |======================================                                                   |  42%
  |                                                                                               
  |======================================                                                   |  43%
  |                                                                                               
  |=======================================                                                  |  43%
  |                                                                                               
  |=======================================                                                  |  44%
  |                                                                                               
  |========================================                                                 |  44%
  |                                                                                               
  |========================================                                                 |  45%
  |                                                                                               
  |========================================                                                 |  46%
  |                                                                                               
  |=========================================                                                |  46%
  |                                                                                               
  |=========================================                                                |  47%
  |                                                                                               
  |==========================================                                               |  47%
  |                                                                                               
  |==========================================                                               |  48%
  |                                                                                               
  |===========================================                                              |  48%
  |                                                                                               
  |===========================================                                              |  49%
  |                                                                                               
  |============================================                                             |  49%
  |                                                                                               
  |============================================                                             |  50%
  |                                                                                               
  |=============================================                                            |  50%
  |                                                                                               
  |=============================================                                            |  51%
  |                                                                                               
  |==============================================                                           |  51%
  |                                                                                               
  |==============================================                                           |  52%
  |                                                                                               
  |===============================================                                          |  52%
  |                                                                                               
  |===============================================                                          |  53%
  |                                                                                               
  |================================================                                         |  53%
  |                                                                                               
  |================================================                                         |  54%
  |                                                                                               
  |=================================================                                        |  54%
  |                                                                                               
  |=================================================                                        |  55%
  |                                                                                               
  |=================================================                                        |  56%
  |                                                                                               
  |==================================================                                       |  56%
  |                                                                                               
  |==================================================                                       |  57%
  |                                                                                               
  |===================================================                                      |  57%
  |                                                                                               
  |===================================================                                      |  58%
  |                                                                                               
  |====================================================                                     |  58%
  |                                                                                               
  |====================================================                                     |  59%
  |                                                                                               
  |=====================================================                                    |  59%
  |                                                                                               
  |=====================================================                                    |  60%
  |                                                                                               
  |======================================================                                   |  60%
  |                                                                                               
  |======================================================                                   |  61%
  |                                                                                               
  |=======================================================                                  |  61%
  |                                                                                               
  |=======================================================                                  |  62%
  |                                                                                               
  |========================================================                                 |  62%
  |                                                                                               
  |========================================================                                 |  63%
  |                                                                                               
  |=========================================================                                |  63%
  |                                                                                               
  |=========================================================                                |  64%
  |                                                                                               
  |=========================================================                                |  65%
  |                                                                                               
  |==========================================================                               |  65%
  |                                                                                               
  |==========================================================                               |  66%
  |                                                                                               
  |===========================================================                              |  66%
  |                                                                                               
  |===========================================================                              |  67%
  |                                                                                               
  |============================================================                             |  67%
  |                                                                                               
  |============================================================                             |  68%
  |                                                                                               
  |=============================================================                            |  68%
  |                                                                                               
  |=============================================================                            |  69%
  |                                                                                               
  |==============================================================                           |  69%
  |                                                                                               
  |==============================================================                           |  70%
  |                                                                                               
  |===============================================================                          |  70%
  |                                                                                               
  |===============================================================                          |  71%
  |                                                                                               
  |================================================================                         |  71%
  |                                                                                               
  |================================================================                         |  72%
  |                                                                                               
  |=================================================================                        |  72%
  |                                                                                               
  |=================================================================                        |  73%
  |                                                                                               
  |=================================================================                        |  74%
  |                                                                                               
  |==================================================================                       |  74%
  |                                                                                               
  |==================================================================                       |  75%
  |                                                                                               
  |===================================================================                      |  75%
  |                                                                                               
  |===================================================================                      |  76%
  |                                                                                               
  |====================================================================                     |  76%
  |                                                                                               
  |====================================================================                     |  77%
  |                                                                                               
  |=====================================================================                    |  77%
  |                                                                                               
  |=====================================================================                    |  78%
  |                                                                                               
  |======================================================================                   |  78%
  |                                                                                               
  |======================================================================                   |  79%
  |                                                                                               
  |=======================================================================                  |  79%
  |                                                                                               
  |=======================================================================                  |  80%
  |                                                                                               
  |========================================================================                 |  80%
  |                                                                                               
  |========================================================================                 |  81%
  |                                                                                               
  |=========================================================================                |  81%
  |                                                                                               
  |=========================================================================                |  82%
  |                                                                                               
  |=========================================================================                |  83%
  |                                                                                               
  |==========================================================================               |  83%
  |                                                                                               
  |==========================================================================               |  84%
  |                                                                                               
  |===========================================================================              |  84%
  |                                                                                               
  |===========================================================================              |  85%
  |                                                                                               
  |============================================================================             |  85%
  |                                                                                               
  |============================================================================             |  86%
  |                                                                                               
  |=============================================================================            |  86%
  |                                                                                               
  |=============================================================================            |  87%
  |                                                                                               
  |==============================================================================           |  87%
  |                                                                                               
  |==============================================================================           |  88%
  |                                                                                               
  |===============================================================================          |  88%
  |                                                                                               
  |===============================================================================          |  89%
  |                                                                                               
  |================================================================================         |  89%
  |                                                                                               
  |================================================================================         |  90%
  |                                                                                               
  |=================================================================================        |  90%
  |                                                                                               
  |=================================================================================        |  91%
  |                                                                                               
  |=================================================================================        |  92%
  |                                                                                               
  |==================================================================================       |  92%
  |                                                                                               
  |==================================================================================       |  93%
  |                                                                                               
  |===================================================================================      |  93%
  |                                                                                               
  |===================================================================================      |  94%
  |                                                                                               
  |====================================================================================     |  94%
  |                                                                                               
  |====================================================================================     |  95%
  |                                                                                               
  |=====================================================================================    |  95%
  |                                                                                               
  |=====================================================================================    |  96%
  |                                                                                               
  |======================================================================================   |  96%
  |                                                                                               
  |======================================================================================   |  97%
  |                                                                                               
  |=======================================================================================  |  97%
  |                                                                                               
  |=======================================================================================  |  98%
  |                                                                                               
  |======================================================================================== |  98%
  |                                                                                               
  |======================================================================================== |  99%
  |                                                                                               
  |=========================================================================================|  99%
  |                                                                                               
  |=========================================================================================| 100%
##            [,1]      [,2]      [,3]
##  [1,]        NA 1.0987349 1.1502523
##  [2,] 0.9805914 1.0071737 1.0158173
##  [3,] 0.9887213 1.1798814 0.9863679
##  [4,] 1.0203636 0.9718828 0.9687435
##  [5,] 0.9923563 0.9779625 1.0347596
##  [6,] 1.0065673 1.2232730 1.0426009
##  [7,] 0.9959245 1.0363068        NA
##  [8,] 0.9736858 1.1920915        NA
##  [9,] 0.9590695 1.0697361        NA
## [10,] 0.9641581 0.9874932        NA
## [11,] 1.0456943 1.0432221        NA
## [12,] 0.9591503 1.0652733        NA
## [13,] 1.1237831 0.9653457        NA
## [14,] 1.0973184 1.0033958        NA
## [15,] 1.3094667 0.9705420        NA
## [16,]        NA 0.9903772        NA
## [17,]        NA 1.0073585        NA
## [18,]        NA 0.9742058        NA
## [19,]        NA 0.9793525        NA
## [20,]        NA 0.9612838        NA
## Writing layer `file25342ca51e1&#39; to data source 
##   `C:\Users\tgood.stu\AppData\Local\Temp\RtmpSOoCgd\file25342ca51e1.shp&#39; using driver `ESRI Shapefile&#39;
## Writing 500 features with 4 fields and geometry type Point.</code></pre>
<pre><code>## Simple feature collection with 500 features and 4 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438550 ymax: 5343230
## CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
## First 10 features:
##        type  zmax zmean  zsd               geometry
## 1  existing 13.55  91.5 4.04 POINT (434170 5337990)
## 2  existing  5.65  54.5 2.18 POINT (436130 5339130)
## 3  existing 12.25  93.2 5.35 POINT (432630 5340190)
## 4  existing  8.55  78.2 5.47 POINT (433150 5340990)
## 5  existing 10.87  79.2 4.18 POINT (433050 5340390)
## 6  existing 15.41  91.3 4.42 POINT (435790 5339890)
## 7  existing 11.17  95.8 2.30 POINT (432530 5337950)
## 8  existing 14.33  89.4 3.90 POINT (438470 5339910)
## 9  existing 16.34  78.2 5.80 POINT (436110 5341350)
## 10 existing  6.29  91.0 2.57 POINT (432010 5340310)</code></pre>
<div id="coobs" class="section level3 unnumbered">
<h3><code>calculate_coobs</code></h3>
<p>The <code>calculate_coobs</code> function perform the COunt of OBServations (coobs) algorithm using <code>existing</code> sample data and <code>mraster</code> covariates. This algorithm aids the user in determining where additional samples could be located by comparing <code>existing</code> samples to each pixel and associated <code>mraster</code> covariates. The output coobs raster could be used to constrain clhs sampling using the <a href="sample.html#clhs"><code>sample_clhs</code></a> to areas that are underreprented.</p>
<p>The coobs raster determines how many observations are similar in terms of the covariate space at every pixel. Given that this is fairly computationally intensive, I have implemented parallel processing for this function, but users should be patient to allow processing to complete.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="calc.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_coobs</span>(<span class="at">mraster =</span> mraster, <span class="co"># input</span></span>
<span id="cb104-2"><a href="calc.html#cb104-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">existing =</span> existing, <span class="co"># existing samples</span></span>
<span id="cb104-3"><a href="calc.html#cb104-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>, <span class="co"># parallel cores to use</span></span>
<span id="cb104-4"><a href="calc.html#cb104-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">details =</span> <span class="cn">TRUE</span>, <span class="co"># provide details from algorithm output</span></span>
<span id="cb104-5"><a href="calc.html#cb104-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="co"># plot</span></span>
<span id="cb104-6"><a href="calc.html#cb104-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">filename =</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.tif&quot;</span>)) <span class="co"># write output raster to tif</span></span></code></pre></div>
</div>
</div>
<div id="lhseval" class="section level2 unnumbered">
<h2>Latin hypercube sampling evaluation algorithms</h2>
<p>The following 2 algorithms provide a means to maximize the effectiveness of <a href="sample.html#clhs">latin hypercube sampling</a> protocols.</p>
<div id="lhspop" class="section level3 unnumbered">
<h3><code>calculate_lhsPop</code></h3>
<p>The <code>calculate_lhsPop</code> function calculates population level statistics about the <code>mraster</code> covariates being used including calculating principal components, quantile distributions, and Kullback–Leibler divergence testing. The outputs from this function are mandatory for use of the <a href="calc.html#lhsopt"><code>calculate_lhsOpt</code></a> function described in the next section.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="calc.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- by default all statistical data are calculated ---#</span></span>
<span id="cb105-2"><a href="calc.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_lhsPop</span>(<span class="at">mraster =</span> mraster) <span class="co"># input </span></span></code></pre></div>
<p>The output details the following:</p>
<ul>
<li><p><code>$values</code> - Pixel values from <code>mraster</code></p></li>
<li><p><code>$pcaLoad</code> - PCA loadings</p></li>
<li><p><code>$matQ</code> - Quantile matrix</p></li>
<li><p><code>$matCov</code> - Covariate matrix</p></li>
</ul>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="calc.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- statistical analyses can be chose by setting their parameter to `FALSE` ---#</span></span>
<span id="cb106-2"><a href="calc.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_lhsPop</span>(<span class="at">mraster =</span> mraster, <span class="co"># input </span></span>
<span id="cb106-3"><a href="calc.html#cb106-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nQuant =</span> <span class="dv">10</span>, <span class="co"># desired number of quantiles</span></span>
<span id="cb106-4"><a href="calc.html#cb106-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">PCA =</span> <span class="cn">FALSE</span>) <span class="co"># choose not to calculate PCA&#39;s</span></span></code></pre></div>
</div>
<div id="lhsopt" class="section level3 unnumbered">
<h3><code>calculate_lhsOpt</code></h3>
<p>The <code>calculate_lhsOpt</code> function performs an bootsrapped latin hypercube sampling approach where a population level analysis of <code>mraster</code> data is performed to determine the optimal Latin hypercube sample size.</p>
<p>Using statistical data calculated using the <code>calculate_lhsPop</code> and varying sample sizes defined by <code>minSamp</code>, <code>maxSamp</code>, <code>step</code> and <code>rep</code>. Sampling protocols are conducted and statistical effectiveness of those sampling outcomes are evaluated to determine where sample size is minimized and statistical representation is maximized.</p>
<p>This function is currently fairly slow to run as parallel is still being implemented.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="calc.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- calculate lhsPop details ---#</span></span>
<span id="cb107-2"><a href="calc.html#cb107-2" aria-hidden="true" tabindex="-1"></a>poplhs <span class="ot">&lt;-</span> <span class="fu">calculate_lhsPop</span>(<span class="at">mraster =</span> mr)</span>
<span id="cb107-3"><a href="calc.html#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="calc.html#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_lhsOpt</span>(<span class="at">popLHS =</span> poplhs)</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="calc.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_lhsOpt</span>(<span class="at">popLHS =</span> poplhs, </span>
<span id="cb108-2"><a href="calc.html#cb108-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">PCA =</span> <span class="cn">FALSE</span>, </span>
<span id="cb108-3"><a href="calc.html#cb108-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">200</span>)</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sample.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SGS.pdf", "SGS.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
